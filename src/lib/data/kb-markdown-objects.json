[
    {
        "dirent": {
            "name": "a-better-way-to-dispose-objects.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "A better way to dispose objects",
                "description": "This article explains to use ASNA Visual RPG's BegUsing operation to implicitly dispose objects.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2025-11-22T00:00:00.000Z",
                "date_updated": "2025-11-22T00:00:00.000Z",
                "date_created": "2025-11-22T00:00:00.000Z",
                "pinned": false
            },
            "content": "\nAn often-overlooked feature of ASNA Visual RPG (AVR) is its `BegUsing` operation. This operation allows for a more streamlined use of objects that provide a `Dispose` method that must be called before the object instance goes out of scope.\n\nAn object needs a `Dispose` method when it needs to release resources (generally COM or other external resources). While you may need to provide a `Dispose` method in objects you create, it's not likely. `Dispose` is necessary only when the object acquires and needs to release unmanaged resources. \n\nWhile custom objects needing `Dispose` are rare, many .NET Framework intrinsic objects provide a `Dispose` method. For example, .NET Frameworks's `StreamWriter` and its new `ZipArchive` object (that lets you programmatically zip and unzip files with .NET Framework), both provide a `Dispose` method that must be called before the object instance goes out of scope. Not calling `Dispose` on objects that need it can lead to out-of-memory  and other unpredictable errors.\n\n## AVR's BegUsing operation\n\nBefore AVR got `BegUsing`, this is how you would have used the `StreamWriter` object to effectively dispose it:\n\n<pre>\nDclFld writer Type(System.IO.StreamWriter)         \n\nTry\n    writer =  File.CreateText(\"c:\\users\\roger\\newfile1.txt\")\n    writer.WriteLine('Neil')\n    writer.WriteLine('Young')\nFinally \n    If writer &lt;&gt; *Nothing\n        writer.Dispose() \n    EndIf \nEndTry \n</pre>\n\n`BegUsing` streamlines the code needed to perform the Dispose. Note how `BegUsing` dispatches the need for manually calling `Dispose`.\n\n<pre> \nTry\n    BegUsing writer Type(StreamWriter) +\n                    Value(File.CreateText('c:\\users\\roger\\newfile2.txt')) \n        writer.WriteLine('Neil')\n        writer.WriteLine('Young')          \n    EndUsing\nCatch ex Type(System.Exception)\n    // do something with the exception here.\nEndTry \n</pre>\n\nYou won't need `BegUsing` often, but when you do it's quite handy. Also, its presence makes it easier to translate C# examples to AVR.\n\n> `BegUsing` is intended only for objects that provide a `Dispose` method (and therefore implement the iDisposable interface). Don't try to use it with AVR objects like disk files or DataGate DB connections that need a `Close` or `Disconnect` method. Continue to close those objects with their `Close` or `Disconnect` methods as you have been."
        }
    },
    {
        "dirent": {
            "name": "asp-net-routing.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using ASP.NET custom routing in your AVR Web apps",
                "description": "ASP.NET's WebForms model acquired a semantic, or 'friendly', routing feature several years ago. This routing feature lets you use semantic URLs instead of page-based URLs.",
                "tags": [
                    "printing",
                    "visual-rpg"
                ],
                "date_updated": "2025-02-04T23:44:26.000Z",
                "date_published": "2025-02-04T23:47:00.000Z",
                "date_created": "2025-02-04T23:44:26.000Z",
                "pinned": false
            },
            "content": "\n[Download](https://github.com/ASNA/avr-asp-net-routing/archive/master.zip)\n\n[View Source](https://github.com/ASNA/avr-asp-net-routing)\n\nASP.NET's WebForms model acquired a semantic, or \"friendly\", routing feature several years ago. This routing feature lets you use semantic URLs instead of page-based URLs. For example, consider a page named `CustDtls.aspx`. Using the default page-based routing, that page is accessed with this URL:\n\n```\nmywebsite.com/CustDtls.aspx\n```   \n\nIn this case, the URL given is mapped directly against the file `CustDtls.aspx` in the application root.\n\nThe ASP.NET semantic routing feature lets you get to that page with this URL:\n\n```\nmywebsite.com/CustomerDetails \n```   \n\nIn this case, the \"virtual\" url (there isn't a file named `CustomerDetails` in the application root) is checked against a map you provide to determine the underlying physical path to the page to be shown. ASP.NET routing is case-insensitive; you can use any case in the URL.\n\nASP.NET routing also lets you virtually group pages so you could also configure a route to the CustDtls.aspx page with:\n\n```\nmywebsite.com/customer/details\n```    \n\n![ASP.NET Routing in action](https://nyc3.digitaloceanspaces.com/asna-assets/assets/articles/routing-ezgif.com-resize.gif)\n\nThe image above shows ASP.NET routing in action. The Microsoft example didn't map the `Links.aspx` page to a route, so you see the `Links.aspx` page name in the URL. (This omission nicely proves that semantic and page-based routing work well together.)\n\nRouting is built into .NET (via the [System.Web.Routing namespace](https://msdn.microsoft.com/en-us/library/system.web.routing(v=vs.110).aspx)) and works great with AVR Support as it is also built into IIS (with no special configuration needed) from version 7 and up. I tested the example that accompanies this article on IIS 10 and it ran just fine. (In very early versions of ASP.NET routing, IIS did require a special URL rewriting module and clumsy configuration.)\n\nThis routing feature may not be something you want to retrofit into existing applications, but it's a nice feature for new apps. Semantic routing does coexist nicely with page-based routing so you could easily add it to existing apps for a new group of pages.\n\n> Semantic routing is frequently used with RESTful services. An upcoming article introduces how to create RESTful services for an AVR ASP.NET application. That article uses semantic routing exclusively. This article is an introduction to semantic routing with AVR and we'll build on its concepts in that upcoming RESTful services article. Generally, semantic routing adds the most value to custom sites that you'd build with ASNA Visual RPG. However, semantic routing also works with ASNA Mobile RPG, Monarch, and Wings.\n\n### Implementing semantic routing with AVR for .NET\n\nMicrosoft has [a great explanation Webforms routing](https://www.asp.net/web-forms/overview/routing) and it also has [a thorough walkthrough](https://msdn.microsoft.com/en-us/library/dd329551.aspx). Every concept discussed in these articles works with AVR. However, the code-behind examples are provided in VB and C# exclusively and the examples use a .NET language feature that AVR doesn't support. Rather than reinvent the wheel, this article explains where AVR differs from the C# presented in the [walkthrough article](https://msdn.microsoft.com/en-us/library/dd329551.aspx). Be sure to read the two MS articles referenced here. They provide important details not included here.\n\n> There aren't any differences between AVR and C# in the `ASPX` markup. The `ASPX` markup presented in the MS article is _exactly_ the same markup AVR uses.\n\n#### Configuring routing\n\nRouting is configured in `global.asax`. Here is the AVR version of the MS article's `global.asax`.\n\n```\n<%@ Application Language=\"AVR\" %>\n\n<%@ Import Namespace=\"System.Web.Routing\" %> \n<%@ Import Namespace=\"ASNA.JsonRestRouting\" %> \n\n<script runat=\"server\">\n\n    BegSr Application_Start\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(EventArgs)\n\n        RegisterRoutes(RouteTable.Routes)   \n    EndSr\n\n    BegSr RegisterRoutes\n        DclSrParm routes Type(RouteCollection)\n\n        DclFld map1 Type(RouteValueDictionary) \n        DclFld map2 Type(RouteValueDictionary) \n\n        routes.MapPageRoute(\"\", + \n                           \"SalesReportSummary/{year}\", + \n                           \"~/sales.aspx\")\n\n        routes.MapPageRoute(\"SalesRoute\", +\n                            \"SalesReport/{locale}/{year}\", +\n                            \"~/sales.aspx\")\n\n        map1 = *New RouteValueDictionary() \n        map1.Add('locale', 'US')\n        map1.add( \"year\", DateTime.Now.Year.ToString())\n\n        map2 = *New RouteValueDictionary() \n        map2.Add('locale', '[a-z]{2}')\n        map2.add( \"year\", '\\d{4}')\n\n        routes.MapPageRoute(\"ExpensesRoute\", +\n                    \"ExpenseReport/{locale}/{year}/*{extrainfo}, +\n                    \"~/expenses.aspx\", +\n                    *True, +\n                     map1, map2) \n    EndSr\n      \n</script>\n```\n   \nFigure 1. The full AVR version of the `global.asax` for the walkthrough.\n\nLines 21, 25, and 37 in Figure 1 above configure routes to ASPX pages. Read the MS article for more details on these route declarations. With ASP.NET routing, values that are passed as arguments are shown \ninside braces (such as `{locale}` and `{year}`). These values are distinct from query strings. You can still also use query strings with routing, but especially in RESTful work, it's common to put data in the URL as though its part of the path to the underlying page (or resource, as REST would have you call it).\n\nThe biggest difference between the C# and AVR versions is in passing the last two arguments to the `MapPageRoute` method in line 41 above. C# supports an object literal notion to instance new classes that AVR does not support. Consider a class named `Point` that has two public properties, `X` and `Y`. C# can instance that `Point` class, and populate `X` and `Y` with a single line, like this (using what's called an [`object literal` or `object initializer`](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/object-and-collection-initializers)):\n\n\n```\nvar x = new Point { X = 0, Y = 1 };\n```\n   \nAVR requires this more verbose approach:\n\n```\nDclFld x Type(Point)  \n\nx = *New Point()\nx.x = 0\nx.y = 1\n```      \n\n> Whenever VB or C# using `object initializer` notation, you'll need to translate that notation to AVR's more explicit, verbose notation.\n\nC# is able to pass two instances of `RouteValueDictionary` to `MapPageRoute` as inline arguments like this:\n\n```\nroutes.MapPageRoute(\"ExpensesRoute\",\n    \"ExpenseReport/{locale}/{year}/{*extrainfo}\",\n    \"~/expenses.aspx\", true,\n    new RouteValueDictionary { \n        { \"locale\", \"US\" }, \n        { \"year\", DateTime.Now.Year.ToString() } },\n    new RouteValueDictionary { \n        { \"locale\", \"[a-z]{2}\" }, \n        { \"year\", @\"\\d{4}\" } });    \n```    \n\nWhile AVR has to explicitly create two instances of `RouteValueDictionary` first and then pass those two values to `MapPageRoute.`\n\n```\nDclFld map1 Type(RouteValueDictionary) \nDclFld map2 Type(RouteValueDictionary) \n\nmap1 = *New RouteValueDictionary() \nmap1.Add('locale', 'US')\nmap1.add( \"year\", DateTime.Now.Year.ToString())\n\nmap2 = *New RouteValueDictionary() \nmap2.Add('locale', '[a-z]{2}')\nmap2.add( \"year\", '\\d{4}')\n\nroutes.MapPageRoute(\"ExpensesRoute\", +\n                    \"ExpenseReport/{locale}/{year}/{*extrainfo}\", +\n                    \"~/expenses.aspx\", +\n                    *True, +\n                    map1, map2) \n```    \n\nWatch for the `object initializer` pattern while reading MS's C# and VB ASP.NET routing examples. It is used frequently. While it takes a little more code with AVR, ultimately you end up with the same result.\n\n#### Generating links at runtime\n\nRoutes can optionally be assigned names when they are defined. In Figure 1, you'll notice that on line 37 the route declared there is named `ExpenseRoute`. This route name can later be used to generate a link to that route, as shown below.\n\nIn the MS article, this C# is provided as the way to generate a URL from a named route.\n\n```\nRouteValueDictionary parameters = \n    new RouteValueDictionary  \n        { \n            {\"locale\", \"CA\" }, \n            { \"year\", \"2008\" } , \n            { \"category\", \"recreation\" }\n        };\n\nVirtualPathData vpd = \n    RouteTable.Routes.GetVirtualPath(null, \"ExpensesRoute\", parameters);\n```    \n\nAs we saw before, AVR needs to use its more verbose method of instancing the `RouteValuesDictionary` class and separating `vpd`'s declaration from its assignment:\n\n```\nDclFld parameters Type(RouteValueDictionary) \nDclFld vpd Type(VirtualPathData) \n\nparameters = *New RouteValueDictionary()\nparameters.Add('locale', 'CA')\nparameters.Add('year', '2008')\nparameters.Add('category', 'recreation')\n\nvpd = RouteTable.Routes.GetVirtualPath(*Nothing, +\n                                       \"ExpensesRoute\", +\n                                       parameters)\nHyperLink6.NavigateUrl = vpd.VirtualPath\n```    \n\nDownload the full AVR routing example (from the links at the top of this article) and play around with it. You'll see it used frequently in upcoming AVR for .NET ASP.NET examples.\n\n"
        }
    },
    {
        "dirent": {
            "name": "application-state-asp-net.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Preserving application state in ASP.NET",
                "description": "This article shows three ways to preserve application state in your Visual RPG ASP.NET web apps",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-08T23:31:20.000Z",
                "date_updated": "2024-01-09T05:32:37.000Z",
                "date_created": "2024-01-09T05:32:37.000Z",
                "pinned": false
            },
            "content": "\nApplication state is the data that links the various parts of an application together. This data may be scalar values, binary values, or even open files that provide information to the application’s various Windows forms or display file record formats. One substantial difference between Web applications and desktop-bound fat Windows programs or green-screen RPG programs is how application state is managed.\n\nWith traditional desktop-bound Windows apps and RPG applications, application state is easy to manage–so easy that it’s usually taken for granted. Through a (usually very large) set of global variables, the program moves the user easily to other forms or record formats. ASP.NET Web applications impose a substantial constraint on this model. Application state isn’t implicitly persisted in an ASP.NET Web app. Open files don’t persist across pages, nor do application variables. You need to manage ASP.NET Web application manually.\n\nIBM i RPG programmers are probably familiar with a job’s local data area. This is a free-format state persistence mechanism that, for all intents and purposes, stores key/values for use later. ASP.NET’s state persistence mechanisms are a little like the LDA. They each offer value pair storage of data that is loosely defined–that is, you can create and store key values on the fly. You don’t have to create a predefined formal container (like you do a physical file) to persist ASP.NET app state.\n\nASP.NET offers three primary state-saving mechanisms, each of which have a different scope:\n\n*   **View state** (purple)- persists data state for a single page. Once the user moves off of that page, view state data for that page is discarded and started afresh for the new page. View state data is implemented as a hidden HTML element on the page. It \"rides\" with the page as is it posted back.\n*   **Session state** (green) – persists data for a user’s session. By default, a session lasts 20 minutes. Anything put in the session state persists as long as the session is alive and is available to all pages of the Web app. This is per session so if a user starts two sessions on a single desktop (for example, opening a second one with an incognito browser instance), each of those sessions have their own distinct session data.\n*   **Application state** (orange) – persists data for the entire application. Anything in application state is available to all users of the application.\n\n![ASP.NET application state](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/asp-net-app-state.png)\n\nFigure 1. View state, session state, and application state scope\n\n[Read more these and other ASP.NET state management techniques.](https://learn.microsoft.com/en-us/previous-versions/aspnet/75x4ha6s(v=vs.100))\n\n### View state\n\nView state is enabled by default for all UI elements in ASP.NET–because their `EnableViewState`property defaults to `true`. When that property is `true`, the control’s state persists across page postbacks (the page posting back to itself) implicitly. For example, consider a page with a GridView. View state ensures that the grid data persists across postbacks. View state values are page-specific; values saved from one page are not available on other pages.\n\nASP.NET’s view state container is a key/value pair collection. In addition to controls using View state implicitly, you can also explicitly save page values to view state. For example:\n\n```\n    DclFld Customer Type(*Integer4) \n    \n    CustomerNumber = 9800\n    // Set the customer number to view state:\n    ViewState['customerNumber'] = CustomerNumber\n    ...\n    // Get the customer out of view state:\n    CustomerNumber = Convert.ToInt32(ViewState['customerNumber'])\n    \n    // AVR implicitly converts strings to numeric values, so you could also do this:\n    CustomerNumber = ViewState['customerNumber'].ToString()\n```    \n\nView state values (like session and application state values) are stored as `System.Object` values and must be explicitly converted when you fetch values from view state. This code would fail\n\n```\n    CustomerNumber = ViewState['customernumber']\n```    \n\nwith the error:\n\n```\n    Cannot convert System.Object to *Integer4\n```    \n\n> **Watch your case**. Keys are case-sensitive for view state, but not so for session and application state. Try to make it a point to keep all of your keys short and lower-case to avoid any case-incurred errors (and to avoid needing to remember the special case of which one is case-sensitive).\n\nView state can store scalars and object values. ASP.NET implicitly serializes/deserializes these values for the get and set operations. For example:\n\nSet and get an array in view state:\n\n```\n    DclArray rates Type(*Integer4) Rank(1) \n    \n    rates = *New *Integer4[] {55, 56, 57}\n    \n    // Set the view state value\n    ViewState['rates'] = rates\n    \n    // Get the view state value     \n    rates = ViewState['rates'] *As *Integer4[]\n```    \n\nSet and get an object instance in view state:\n\n```\n    DclFld li Type(ListItem)\n    \n    li = *New ListItem('neil', 77)\n    \n    // Set the view state value\n    ViewState['artist'] = li \n    \n    // Get the view state value\n    li = ViewState['artist'] *As ListItem \n```    \n\nJust before a page is rendered, ASP.NET collects all of the current view state values and encodes them in a single string stored in a hidden HTML `input` tag with its `name` and `id` attributes both being `__VIEWSTATE`.\n  \nView state is a good thing but it’s also, at least potentially, a bad thing. It’s good in that it is an easy way to persist state and therefore it makes Web app creation easier. On the other hand, because view state is enabled by default _for every control_ if you aren’t careful view state can dramatically increase the size of the page you’re sending across the network. As you’re placing controls on your forms, carefully consider if you really need view state enabled for that control. If you think preserving view state isn’t necessary for a control, set the control’s `EnableViewState` property to `false` and test the app. If the app breaks, set the value back to `true`. In most cases your controls probably do need view state enabled.\n\n![Disable view state](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/disable-view-state.png)\n\nFigure 2. An ASP.NET control’s EnableViewState property\n\nBy default view state is encoded ([via a page’s EnableViewStateMac property](https://learn.microsoft.com/en-us/dotnet/api/system.web.ui.page.enableviewstatemac?view=netframework-4.8.1)) to ensure its value hasn’t been tampered with on the client. Despite this protection, it’s probably best to avoid using view state for sensitive data.\n\n### Session state\n\nThere are several ways to persist session state:\n\n*   **InProc mode**, which stores session state in memory on the Web server. This is the default and the one we’ll be discussing here.\n    \n*   **StateServer mode**, which stores session state in a separate process called the ASP.NET state service. This ensures that session state is preserved if the Web application is restarted and makes session state available to multiple Web servers in a Web farm.\n    \n*   **SQLServer mode** stores session state in a SQL Server database. This ensures that session state is preserved if the Web application is restarted and makes session state available to multiple Web servers in a Web farm.\n    \n*   **Custom mode**, which enables you to specify a custom storage provider.\n    \n*   **Off mode**, which disables session state.\n    \n\n[See this page](https://learn.microsoft.com/en-us/previous-versions/aspnet/ms178581(v=vs.100)) for details on configuring session state.\n\nRegardless of the session state mode, setting and getting a session variable is similar to setting and getting a view state variable:\n\n```\n    DclFld Customer Type(*Intreger4) \n    \n    CustomerNumber = 9800\n    // Set the customer number to view state:\n    SessionState['customerNumber'] = CustomerNumber\n    ...\n    // Get the customer out of view state:\n    CustomerNumber = Convert.ToInt32(SessionState['customerNumber'])\n    \n    // AVR implicitly converts strings to numeric values, so you could also do this:\n    CustomerNumber = SessionState['customerNumber'].ToString()\n```    \n\nThe code above makes the `customerNumber` keyed session variable available to all pages of the Web application for the duration of the application’s session. Like view state variables, you can assign both scalars and object instances to session values.\n\n### Application state\n\nApplication state is very much like session state, the primary difference is that application state is global to all users of the Web app. The syntax for setting and getting application state variables is just like that with view state and session state.\n\nSetting and getting application variables works just like it does with view state and session variables:\n\n```\n    DclFld EmailAdmin Type(*String) \n    \n    EmailAdmin = 'admin@asna.com'\n    \n    // Set the customer number to view state:\n    Application['email-admin'] = EmailAdmin\n    ...\n    // Get the customer out of view state:\n    EmailAdmin = Application['email-admin'].ToString()\n ```\n\nIt’s common to set application-wide variables in the `global.asax` file’s `ApplicationStart` event. For example, the code below stores the administrator’s email address to an `appSettings` value in the `web.config` file.\n\n```    \n    <appsettings>\n        <add key=\"email-admin\" value=\"admin@asna.com\">\n        ...\n```        \n\nThe code below saves that email address in an application variable in `global.asax's` `Application_Start` event (which fires once when the app is started by the first user requesting a page):\n\n```\n    BegSr Application_Start\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(EventArgs)\n    \n            // Code that runs on application startup\n        Application['email-admin'] = System.Configuration.ConfigurationManager.AppSettings[\"email-admin\"]\n    EndSr\n```    \n\nLater in the app, you would get that email address like this:\n\n```    \n    DclFld EmailAdmin Type(*String) \n    \n    EmailAdmin = Application['email-admin'].ToString()\n```    \n\n### Considering sensitive data\n\nView state data should never be considered secure–beware of putting highly sensitive information in view state.\n\nApplication state and Session state are generally secure–these values all live in memory on the server (when you are using InProc session state). That said, a clever hacker with access to your Web server could conceivably take memory dump snapshot and try to find sensitive data. That scenario isn’t likely (I’ve never heard of it happening in 20+ years of ASP.NET), but it could. At the very least, it’s a reminder to keep your Web server very secure.\n\nThere may also be Sarbanes Oxley-like rules that prohibit using view, session and application variables for sensitive data. Before saving any highly sensitive data with these mechanisms check with your security officer. You may need to consider persisting highly sensitive values to a secure data store like a file or table.\n\n### Beware the \"Object reference not set to an instance of an object\" error!\n\nAn ASP.NET error that you’ll probably see a lot, especially in your early days of learning AVR and ASP.NET, is the dreaded \"Object reference not set to an instance of an object\" error.\n\n![The yellow screen of death reporting a null object reference](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/object-not-instanced.png)\n\nFigure 3. The yellow screen of death reporting a null object reference\n\nThat error is shown above as reported in ASP.NET’s so-called ‘yellow screen of death\" runtime error. In this case the code is trying to fetch a session variable keyed as `'numberxx'`. Several different conditions can lead to this error, but fetching values from one of the three state persistence mechanisms is one of the major offenders. Take great care with your keys. They are easy to specify incorrectly and sometimes devilish to track down.\n\n> A friendly hint: If you get the error above, ASNA Tech Support can’t be much help with it. It isn’t an AVR- or .NET-caused issue, it’s a problem with program logic (or poor typing!). You’ll need to get your debugging magnifying glass out and start digging! The error shown here is easy to find because the app is running under debug; but when the app is running in production you won’t get the line number or variable name info.\n\nTo avoid this error, you can first test to see if the key exists (this also works with view state and application state keys):\n\n```\n    If Session['numberxx'] = *Nothing\n        CustomerNumber = Session['numberxx'].ToString()\n    Else \n        CustomerNumber = 0\n    EndIf \n```    \n\n### Cleaning up after yourself\n\nSession and application values use Web server memory. It’s prudent to keep these values in memory for only as long as they are needed. When they are no longer needed, delete them like this:\n\n```\n    Session.Remove('customernumber') \n    \n    Application.Remove('email-admin')\n```    \n\nWhile that impact is usually negligible, if your application scales to many users the memory demands may be high. That said, the trouble you’re most likely to get into with session/application variables probably isn’t about server performance, it’s about being sloppy with them and frittering them about the application. Session and application variables are, for all intents and purposes, global variables. And what is the path to hell paved with? Global variables."
        }
    },
    {
        "dirent": {
            "name": "avr-data-types.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Understanding AVR for .NET data types",
                "description": "This article explains how Visual RPG for .NET Framework data types work and how they relate to .NET Framework, C#, and VB data types.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-15T11:22:47.000Z",
                "date_updated": "2024-01-15T17:24:30.000Z",
                "date_created": "2024-01-15T17:24:30.000Z",
                "pinned": false
            },
            "content": "\nASNA Visual RPG for .NET data types\n-----------------------------------\n\n.NET lays out very specific rules for what a language must implement to be able to generate verifiable .NET assemblies (binaries). One of the rules is that a .NET language must implement the full complement, and only the full complement, of .NET Framework data types. This consistency is important to ensure appropriate interoperability between .NET applications written with multiple .NET languages.\n\nFor example, imagine a class written in AVR needing to instance and use a class written in C#. Both languages must be able to correctly exchange data types. Without being able to do so, there would be no language-to-language interoperability in .NET.\n\nThe chart below shows corresponding data types for AVR, the .NET Framework, C#, and VB.NET.\n\n## Reference types\n<div class=\"table-container\">\n\n|AVR for .NET|.NET Framework|C#|VB.NET|\n|--- |--- |--- |--- |\n|*String|System.String|string|String|\n|*Char|System.String|N/A|N/A|\n\n</div>\n\n## Value/structure types \n\n<div class=\"table-container\">\n\n|AVR for .NET|.NET Framework|C#|VB.NET|\n|--- |--- |--- |--- |\n|*Date|System.DateTime|datetime|DateTime|\n|*Time|System.DateTime|datetime|DateTime|\n|*TimeStamp|System.DateTime|datetime|DateTime|\n\n</div>\n\n## Value types\n\n<div class=\"table-container\">\n\n|AVR for .NET|.NET Framework|C#|VB.NET|\n|--- |--- |--- |--- |\n|*Boolean|System.Boolean|bool|Boolean|\n|*Indicator|System.Char|N/A|N/A|\n|*Binary|System.Decimal|N/A|N/A|\n|*Decimal|System.Decimal|decimal|Decimal|\n|*Packed|System.Decimal|decimal|Decimal|\n|*Zoned|System.Decimal|decimal|Decimal|\n|*Float4|System.Float32|System.Float32|System.Float32|\n|*Float8|System.Float64|System.Float64|System.Float64|\n|*Byte|System.Byte|byte|Byte|\n|*Integer2|System.Int16|short|Short|\n|*Integer4|System.Int32|int|Int|\n|*Integer8|System.Int64|long|Lon|\n|*OneChar|System.Char|char|Char|\n\n</div>\n\n> Note that AVR specifies its integer types with the number of bytes and .NET does so with the number of bits. Therefore AVR’s `*Integer4` type corresponds to the .NET Framework’s `System.Int32` type.\n\n## Declaring variables\n\nYou can use either the AVR data type or the .NET Framework’s data type when declaring a variable in AVR. For example:\n\n```\nDclFld s1 Type(*String) \n```\n\nor\n\n```\nDclFld s1 Type(System.String) \n```   \n\ndo exactly the same thing.\n\n## A note about \\*Char\n\nGreen-screen RPG as well as ASNA Visual RPG Classic (the COM version of AVR) both implement a fixed-length string called a \\*Char. AVR for .NET implements that type as well as shown below:\n\n```\nDclFld CustomerName Type(*Char) Len(40)\n\nCustomerName = 'Neil Young'\n```    \n\nAt a glance, you might think that CustomerName’s value is ‘Neil Young’, but no, its value is that plus 30 trailing blanks. Any time a variable is a \\*Char in AVR for .NET, AVR will right-pad with blanks as necessary to ensure it is the correct length. Note from the chart above that AVR for .NET’s \\*Char type resolves to a .NET Framework System.String. This value would be passed to C# or VB as a System.String _with its trailing blanks_.\n\n### What is a \\*OneChar?\n\nAVR for .NET’s \\*OneChar is a potentially confusing and data type. Don’t confuse it with the far more frequently used \\*Char data type. Confusingly, a \\*OneChar is not a string or a character, and, adding to the confusion, it is implemented in the .NET Framework as a System.Char (further contributing to confusing it with a \\*Char). The value of System.Char is a 16-numeric value. For example, these two declarations seem to both be containing a value of `c`.\n\n```\n    DclFld cChar Type(*OneChar) Inz('c') \n    DclFld cString Type(*String) Inz('c')\n```    \n\nThey aren’t: The `cChar’s` value is u0063 and `cString’s` value is ‘c’. In many cases, a single \\*OneChar value does represent a single Unicode character; but (says the MS docs).\n\n> A character that is encoded as a base character, surrogate pair, and/or combining character sequence is represented by multiple Char objects. For this reason, a Char structure in a String object is not necessarily equivalent to a single Unicode character.\n\nWhat’s it all mean? Not much. For nearly everything you do, you can ignore the \\*OneChar data type and live happily ever after. That said, it’s worth knowing that when a .NET API references a `char` that doesn’t mean an RPG’s programmer’s version of a \\*Char, but it means a single, 16-bit Unicode value which is a System.Char or in AVR, a \\*OneChar. You may encounter this issue with some of the .NET Framework’s System.String methods that use `char` arguments or you might see the data type used with third-party custom controls. If .NET-based\n\n> Remember this: When a .NET API references a `char` data type that doesn’t mean an RPG’s programmers version of a \\*Char, but it means a single, 16-bit Unicode value. Read more about [the .NET Framework’s System.Char.](https://docs.microsoft.com/en-us/dotnet/api/system.char?view=netframework-4.5)\n\n### \\*Form data type\n\nAVR for .NET also implements a \\*Form data type than resolves to a System.Windows.Forms.Form data type. Rarely in your AVR for .NET code will you know or care about \\*Form. However, coders coming to AVR for .NET from AVR Classic may appreciate understating the relationship between what they used to know as a \\*Form object and .NET’s System.Windows.Forms.Form.\n\n"
        }
    },
    {
        "dirent": {
            "name": "avr-primer.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "ASNA Visual RPG for .NET Framework Primer",
                "description": "This document introduces several of the unique and powerful features of ASNA Visual RPG for .NET Framework.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T20:41:17.000Z",
                "date_created": "2024-01-11T20:41:17.000Z",
                "pinned": false
            },
            "content": "\nThis document introduces several of the unique and powerful features of ASNA Visual RPG for .NET (AVR). Whether you’re a traditional RPG programmer with little or no experience with other languages, or a veteran VB/C# programmer, this document provides an overview of several of AVR’s language concepts and syntactical details.\n\nAVR has one foot clearly in the roots of green-screen RPG but the other is firmly planted in .NET. Its version of RPG is a sophisticated, highly-evolved version of the language. AVR continues to offer standby RPG idioms and constructs (such as externally described data structures, key lists, parameter lists, record-level operations, and program calls). However, it also improves on old-fashioned RPG with a modern, expressive syntax and many new facilities and powers. With AVR, you can build rich Windows applications, powerful browser-based apps, mobile apps, and web services.\n\nThis document takes you on a quick tour of some of the features and facilities offered by AVR. It’s not intended to provide all the details you need for everything it describes; rather, this document’s purpose is to introduce you to some of the ways AVR supercharges RPG.\n\n## Raising the bar on RPG\n\nAVR’s RPG substantially raises the bar on old-time, green-screen RPG. Syntactically, AVR’s RPG has been extended to use an indented, block structure. This enhanced syntax lets you write more expressive RPG, removes green-screen RPG’s dogged insistence on specific column position, and more naturally lends itself to AVR for .NET’s event-driven environment. While AVR doesn’t at first look like green-screen RPG, when you learn the basics of its syntax and fully appreciate the power it offers, I think you’ll agree that AVR does a good job of merging the best of the old RPG model with the best of what .NET has to offer.\n\nIn addition to its numerous syntactical enhancements, AVR brings RPG fully into the world of object-oriented programming. With AVR, you can gracefully implement the three hallmarks of object-oriented programming: encapsulation, polymorphism, and specialization. Before we dig into OO detail (that’s covered later), let’s take a closer look at AVR’s syntax and some of its general features.\n\nGreen-screen RPG required you to write your code to a very specific columnar scheme (owing back to its reliance on punched cards in the days of its youth). AVR eschews specific columns with a keyword syntax very similar to that used by the iSeries’s Command Language (CL). If you’re familiar with RPG and CL, it might help to think of AVR as a blend of the best CL’s syntax with the power and structure of RPG. (If you’re familiar with [ILE RPG’s full free-format syntax](https://goo.gl/PyVSz7) you’ll notice a few syntactical similarities between it and AVR as well.)\n\nFor example, this snippet of green-screen RPG:\n\n```\nC                Z-ADD  0        TOTBAL\nC*\nC* Read 10 customer records.\nC      1         DO     10\nC                READ   CUST                     50\nC      *IN50     ADD    CMBAL    TOTBAL\nC                ENDDO\n```\n\ncould look like this in AVR:\n\n```\nTotalBalance = 0\n\n// Read 10 customer records.\nDo FromVal(1) ToVal(10)\n    Read Cust\n    If (NOT %EOF(Cust))\n        TotalBalance = TotalBalance + CMBAL\n    EndIf\nEndDo\n```\n\nThis snippet shows several things about AVR’s RPG:\n\n*   statements are keyworded like CL\n*   green-screen RPG’s column dependence is eliminated\n*   statements can (and should!) be indented\n*   whitespace, empty lines, and case don’t matter\n*   two slashes (//) indicate a comment\n*   RPG built-in functions (BIFs) are supported (you’ll later learn that there are also powerful alternatives to BIFs)\n*   implicit simple variable assignments are allowed (instead of requiring explicit operations like ADD or Z-ADD)\n*   long identifier names are available\n*   case doesn’t matter—tokens and operations can be expressed in uppercase, lowercase, or any combination thereof.\n*   operations are always listed before the operation’s operands\n\nAnother more subtle thing about the AVR snippet above is the phrase ‘could look like this.’ AVR supports a full complement of backward-compatible RPG constructs. However, as you’ll learn in this document, it also offers powerful alternatives to many long-standing green-screen RPG idioms.\n\nLet’s take a closer look at AVR’s RPG.\n\n## AVR leaves RPG column-dependence behind\n\nAVR’s RPG uses CL-like keywords to remove the need for specifically placing code in specific columns. In fact, if you come from an RPG background, you’ll notice that AVR was styled almost as though RPG and CL were merged into one language, with CL-like command interfaces provided over all RPG operations. This isn’t by accident. AVR retains a great deal of RPG’s idioms and personality, but it also needed a more rational, expressive syntax. Given most RPG programmer’s experience with CL, blending the best of both worlds was a natural for AVR. AVR applies the ‘command interface’ concept to virtually all RPG operations as well as RPG specification types such as F-Specs and D-Specs.\n\nAVR uses CL-like rules to govern its use of keywords. Like CL, keywords are optional. For example, if you were to write this code\n\n```\nChain File(Cust) Key(CustKey)\n```\n\nor\n\n```\nChain Cust Key(CustKey)\n```\n\nor\n\n```\nChain Cust CustKey\n```\n\nany of the three lines would compile. AVR’s positional rules for keywords would apply and the first value would be assumed to be the ‘from value’ and the second would be assumed to be the ‘to value’. If you omit keywords, the values must be provided in the order in which the RPG operation expects them.\n\nIf you specify a given keyword, all keywords following the given keyword must be provided. For example, you could use:\n\n```\nChain Cust Key(CustKey)\n```\nbut you could not use:\n\n```\nChain File(Cust) CustKey\n```\n\nThe occurrence of the first keyword tells the compiler to ignore positional use from there on. Search AVR’s online help for Operation codes to see each operation’s keywords.\n\nFrom a styling perspective, the general rule is to omit the first keyword and include all others for clarity’s sake. The additional clarity keywords provide is generally worth the extra typing they require. For example, consider these two lines of code\n\n```\nChain Cust CustNo\n```\n\nand\n\n```\nChain Cust Key(CustNo)\n```\nSemantically, these lines are identical—the compiler accepts either. But the second version is much easier to read. Although the general rule is to omit the first keyword and include all others, there are exceptions. Consider this AVR:\n\n```\nDo 1 10 x\n```\n\nand\n\n```\nDo 1 ToVal(10) Index(x)\n```\n\nand\n\n```\nDo FromVal(1) ToVal(10) Index(x)\n```\n\nThese lines show the AVR `Do` loop in action. As you can see, for maximum clarity you will probably want to use all the keywords for a few of the AVR opcodes.\n\nLong-time RPG coders often react negatively to the suggestion that keywords be used to improve code readability (I’ve heard more than one beginning AVR coder say, \"If I wanted to write something as wordy as COBOL, I’d write COBOL!\"). You may consider the keyworded version too verbose and to require too much typing. However, remember that it’s much harder to read code than it is to write code. Extra care taken to write highly readable code will pay huge dividends over the life of a program.\n\nVeteran green-screen RPG programmers will notice that in most cases AVR’s keywords map directly to columns in corresponding green-screen RPG operations. For example, in the Do statement above, the FromVal keyword maps to RPG’s factor 1; the ToVal maps to RPG’s factor 2; and the Index keyword maps to RPG’s result column.\n\nWith some RPG operations, such as the `Do` operation, the keywords directly convey the keyword's purpose—without regard for what column the `Do's` operands used to occupy (in other words, the `Do's` keywords `FromVal` and `ToVal` don't reference factor 1 or factor 2 in any way). In others, such as the `Z-ADD` operation, the keywords reflect a more direct relationship with green-screen RPG columns. For example, a keyworded `Z-ADD` to add the value of 8 to variable x could be written as\n\n```\nZ-Add F2(8) Result(x)\n```\n\nwhere `F2` is shorthand for the factor 2 column and `Result` is shorthand for the result column. See the AVR help for each operation’s exact keywords.\n\nIf you are a VB or C# programmer and all this talk about RPG’s columns has you confused, don’t worry about it. It’s your good fortune to be able to learn RPG and not ever have to worry about columns and exactly what goes in each column!\n\n## AVR ignores whitespace, empty lines, and case\n\nNot only does AVR remove columnar restrictions, it’s also very flexible with regard to whitespace, empty lines, and case. For example, you could write\n\n```\nMyVar = 9\n```\n\nor you could use:\n\n```\nMYVAR = 9\n```\n\nand AVR would know that both `MyVar` and `MYVAR` are referring to the same variable. Case insensitivity also applies to all other program identifiers (such as routine names, file names, and array names). There are two additional important points to make about AVR’s case insensitivity:\n\n*   Just because case doesn’t matter to AVR doesn’t mean it doesn’t matter to you and other programmers. Strive for diligent consistency with your use of case in your AVR programs.\n*   Although AVR’s language is case insensitive, there will be times when you’ll need to pay close attention to case—especially when specifying the keys to collections. This will be covered in more detail later.\n\nAVR is also very liberal about accepting whitespace. For example, you could write\n\n```\nChain Cust Key(CUSTKEY)\n```\n\nor (although you probably wouldn’t!)\n\n```\nChain     Cust         Key(CUSTKEY)\n```\n\nAny additional whitespace is ignored by the AVR compiler. AVR also allows blank lines. Whitespace, or the lack of it, doesn’t matter to the compiler; but it matters greatly to programmers trying to read code. The code we write in class will use plenty of whitespace and consistent casing to improve clarity and readability.\n\n## Continuing lines\n\nAVR doesn’t use an end-of-line mark character as C# or ILE RPG’s free-format syntax does with the semi-colon. Each AVR line ends simply with a carriage return. There may be times, for readability purposes, when you want to continue a line to one or more other lines. Consider this `DclDiskFile` :\n\n```\n    DclDiskFile Cust Type(*Input) Org(*Indexed) Prefix(Cust_) File('Examples/CMastNewL2')...\n```\nyou’ll often see such a line written using AVR’s line continuation syntax (which, again, borrows from CL):\n\n```\nDclDiskFile Cust +\n    Type(*Input) +\n    Org(*Indexed) +\n    Prefix(Cust_) +\n    File('Examples/CMastNewL2') \n    ...\n```\n\nWhile the second requires more lines, it is much more readable. Continued lines must end with the `+` sign. Continued lines inside expressions are often vexing at first. For example, don’t let this line of code trip you up:\n\n```\nMyValue = SomethingReallyLong ++\n            SomethingElseReallyLong\n```\n\nIn this case, the first plus sign is part of the expression, the second is the line continuation character.\n\n## AVR comments\n\nAnytime AVR encounters two contiguous slashes it assumes they denote a comment area. Used at the beginning of a line, two slashes indicate the entire line is a comment. Used anywhere else in a line indicates that from the slashes to the end of the line is a comment. For example, the snippet below has three comments. One is a full line comment, the other two are partial-line comments.\n\n```\n// Read 10 customer records.\nDo FromVal(1) ToVal(10)\n    Read Cust // Read one record.\n    If (NOT Cust.IsEOF) // Record not found.\n```\n\nAVR also supports CL/C#-like `/* */` streaming comments. For example, you could also do this:\n\n```\n/*\n| Read 10 customer records.\n*/\nDo FromVal(1) ToVal(10)\n    Read Cust // Read one record.\n    If (NOT Cust.IsEOF) // Record not found.\n    ...\n```\n\nwhere anything between `/*` and `*/` is considered a comment by the AVR compiler.\n\n## AVR statements can (and should!) be indented\n\nGiven AVR’s whitespace rules, it shouldn’t come as a surprise that you can use any indention style you want. You could write this:\n\n```\nIf (NOT Cust.IsEOF)\n    TotalBalance = TotalBalance + CMBAL\nEndIf\n```\n\nor you could write this:\n\n```\nIf (NOT Cust.IsEOF)\n    TotalBalance=TotalBalance + CMBAL\nEndIf\n```\n\nHowever, it is highly recommended that you adopt a rational indention scheme so that the layout of your source code conveys the logic of that code. For example, you could eschew indention and write this:\n\n```\nDo FromVal(1) ToVal(RecordsToReadBackwards)\nReadP Cust BOF(BegOfFile)\nIf (BegOfFile)\nLeave\nElse\nWrite CustMem\nEndIf\nEndDo\n```\n\nOr you could do this:\n\n```\nDo FromVal(1) ToVal(RecordsToReadBackwards)\n    ReadP Cust BOF(BegOfFile)\n    If (BegOfFile)\n        Leave\n    Else\n        Write CustMem\n    EndIf\nEndDo\n```\nWhich stub would you rather try to make sense out of later? The better and more consistent you are with indenting your code, the easier your AVR code will be to read and maintain. Consistent, deliberate use of proper indention is a hallmark of a great AVR program.\n\n## AVR data types\n\nAVR has a broad range of data types; some derived from the underlying .NET type system and some from green-screen RPG. A cross-referenced list of AVR’s data types is [available here](/en/kb/avr-data-types). The AVR data types you’ll use most frequently are:\n\nAVR has a broad range of data types; some derived from the underlying .NET type system and some from green-screen RPG. A cross-referenced list of AVR’s data types is available here. The AVR data types you’ll use most frequently are:\n\n*   \\*Boolean. The Boolean data type represents a true or false value. Under the covers, `*True` resolves to the numeric value 1 and `*False` resolves to the numeric value zero. AVR provides two keywords, `*True` and `*False`, to use for \\*Boolean testing.\n    \n*   \\*Indicator. AVR’s `*Indicator` data type provides backward compatibility with green-screen RPG’s named indicators. While it is similar to the `*Boolean` data type, `*Indicator` resolves to either character value `1` or character value `0`. `*Boolean` is the preferred data type for true/false values and should be used over `*Indicator` (this is especially true if you think you’ll ever want to share your AVR assemblies with C# or VB programmers).\n    \n*   \\*IntegerX (where x is 2, 4, or 8). These three integer types represent two-, four-, and eight-byte integer values. RPG programmers should remember that the 2, 4, and 8 refer to data storage bytes, not character positions (as is the case with zoned or packed variables). Thus the `*Integer4` data type has a maximum value of 2,147,483,657 (not 9999 as might be assumed by a green-screen RPG programmer). Generally, you should use the `*Integerx` data type any time you need a whole number program variable.\n    \n*   \\*String. Strings are alphameric values of undeclared length. They are similar to green-screen RPG’s `*Char` character data type but their length is dynamic and is determined by the variable’s content. A string’s actual length is determined at runtime. Generally, you should use a `*String` data type any time you need a character program variable. Not only are `*Strings` more convenient than `*Chars` in that strings aren’t constrained to a specific length and you don’t need to worry about declaring a `*String's` length.\n    \n\n.NET has nullable versions of several of its data types. With this data type, an integer, for example, can either have a numeric value or be null. Nullable types are often handy for working with SQL tables that have nullable columns. While not first-class data types in AVR, with just a little effort you can make .NET’s nullable types work in AVR.\n\n.NET has nullable versions of several of its data types. With this data type, an integer, for example, can either have a numeric value or be null. Nullable types are often handy for working with SQL tables that have nullable columns. While not first-class data types in AVR, with just a little effort you [can make .NET’s nullable types work in AVR.](/en/kb/nullable-types-with-avr)\n\nAVR’s data types do a lot more for you than simply represent a value. As you’ll soon see, in AVR for .NET, all variables are instances of objects and these objects bring events, methods, and properties to the party. We’ll cover what this means for you in more detail later, but in the meantime, pay close attention as to how data types are used in AVR—you notice that interesting, subtle power lurks for virtually all of AVR’s data types. Here’s just one example to pique your interest. Consider having `*Packed`, 8, 0 database field named `LoadDate` that stores the date as a numeric value in the format` yyyymmdd`` . You could easily format this value like this:\n\n```\n    LoanDate.ToString('0000-00-00')\n```\n\nThis code is using the `*Packed` field's `ToString() `method, with a custom numeric formatting string, to render the numeric value as a string with the format given. In this case, zeros mean non-suppressed zero numeric place holders. If `LoanDate`'s value was `20070602 `the output from the code above would be `2007-06-02`. Don't worry too much right now about `ToString()` and how it’s actually formatting the numeric value; rather understand that because virtually all data elements in AVR for .NET are instances of objects, lots of interesting power lurks just below the surface.\n\nBeyond simply adding these (and many other) new data types to your RPG kitbag, you’ll soon see that AVR supports all old familiar green-screen RPG data types. And, as alluded to above, you’ll see that old friends such as `*Packed`, `*Zoned`, and fixed-length `*Char` character strings aren’t just supported, but that AVR highly supercharges them.\n\n## Casting and type conversions with AVR\n\n.NET’s most basic data type is [`System.Object`](https://goo.gl/iKgKVA), which AVR aliases as `*Object`. `Object` supports all classes in the .NET Framework class hierarchy and provides low-level services to derived classes. It is the ultimate base class of all classes in the .NET Framework; it is the root of the type hierarchy.\n\nOne of the purposes of `*Object` is to provide a generic place to store any type of variable. Consider the Windows `ComboBox` for example. It has an `Items` property that is a collection of `*Objects`. This means that any type can be assigned as a dropdown item to the `ComboBox`. For example, given a `ComboBox` named `MyComboBox`, you could add a `*String` item like this:\n\n```\nMyComboBox.Items.Add('Indiana') // Assign a string to the combo box. \n```\nTo later get the selected item, it seems reasonable that you could do this:\n\n```\nDclFld SelectedState Type(*String)\n\nSelectedState = MyComboBox.SelectedItem \n```\n\nBut that fails at compile-time with the message:\n\n```\nCannot convert 'System.Object' to type '*String'\n```\n\nWhen you fetch a value out of a `*Object` you _must_ either explicitly convert or cast (a fancy word for convert) it as the type you expect. The first example below converts and the second casts the `SelectedItem` to a string:\n\n```\nSelectedState = Convert.ToString(MyComboBox.SelectedItem) // Convert\n```\n\nor\n\n```\nSelectedState = MyComboBox.SelectedItem *As *String // Cast\n```\n\nC# coders are familiar with this syntax to cast the SelectedItem to a string:\n\n```\nSelectedState = (string)MyComboBox.SelectedItem \n```\n\nAVR’s `*AS` operator is the functional equivalent to the C# casting show above. VB.NET’s `TryCast` and `DirectCast` are VB.NET’s special-case ways to cast values.\n\nLet’s consider populating the combo box with an instance of an object other than a string.\n\n```\n// Because the ComboBox is populated with an object, setting its DisplayMember and \n// ValueMember properties to the names of the object's corresponding properties \n// tells it what value to display in the ComboBox and what value to fetch with the \n// ComboBox's SelectedValue property.\nMyComboBox.DisplayMember = 'State'\nMyComboBox.ValueMember = 'Abbreviation'\n\nMyComboBox.Items.Add(*New MyComboItem('Indiana', 'IN'))\n\n...\n\nBegClass MyComboItem Access(*Public)\n    DclProp State Type(*String) Access(*Public)\n    DclProp Abbreviation Type(*String) Access(*Public)\n\n    BegConstructor Access(*Public)\n        DclSrParm State Type(*String)\n        DclSrParm Abbreviation Type(*String)\n\n        *This.State = State\n        *This.Abbreviation = Abbreviation \n    EndConstructor \nEndClass \n```\n\nTo fetch the selected item, you might hope this works:\n\n```\nDclFld SelectedState Type(MyComboItem)\n\nSelectedState = MyComboBox.SelectedItem \n```\n\nIt doesn’t. It fails at compile-time with the error:\n\n```\nCannot convert 'System.Object' to type MyComboItem\n```\n\nThat this causes an error in .NET has always bugged me. `SelectedState` has clearly been declared as type `MyComboItem` and the compiler knows it because it just told us so in its message; it clearly has all the information it needs to take care of this. No matter, the rule stands:\n\n> When you fetch a value out of a `*Object` you _must_ either explicitly convert or cast it as the type you expect.\n\nIn this case, .NET doesn’t have a built-in method for converting the custom MyComboItem object so it needs to be casted:\n\n```\nDclFld SelectedState Type(MyComboItem)\n\nSelectedState = MyComboBox.SelectedItem *As MyComboItem  \n```\n\nHaving done the cast, `SelectedState` is an instance of` MyComboItem`` and its public members are available via this instance.\n\n> Although this article uses the Windows ComboBox for this discussion, web developers also have the need for converting and casting values. The ASP.NET Session is a good example where converting or casting is needed to fetch values stored in the Session object.\n\n## Simple variable assignments\n\nAlthough AVR supports legacy RPG assignment operations such as `ADD`,`Z-ADD` and `MOVE` (along with the myriad related assignment operations), the preferred AVR way to perform variable assignments is with a simple equal statement. For example, you could write this:\n\n```\nZAdd F2(8) Result(x)\n```\n\nor\n\n```\nZAdd 8 x\n```\n\nHowever, the preferred way to perform this assignment is to simply use the `=` assignment operator:\n\n```\nx = 8\n```\n\nAVR’s simple assignment operation also has a very interesting implication on the strongly-typed nature of .NET. AVR’s equal sign assignment operator is, for the most part at least, the semantic equivalent to green-screen RPG’s MOVE operation code (which did double duty as both an assignment operator and, if needed (and possible) a conversion operator. For example, AVR allows this code:\n\n```\nDclFld Rate Type(*String)\nDclFld NumericValue Type(*Packed) Len(8, 0)\n\nRate = '45678'\nNumericValue = Rate // String assigned to numeric value!\n```\n\nIn the example above, AVR automatically converts the string value to a numeric value—no explicit conversion is required. (As with green-screen RPG’s MOVE, the code above would fail if the string value contained a non-numeric character.) To RPG programmers familiar with green-screen RPG’s MOVE operation, this automatic conversion should seem pretty natural. To VB and C# programmers, though, it’s borderline heresy! By its nature, .NET is very type-specific and generally doesn’t tolerate the assignment of one data type to another. AVR does indeed follow nearly all the rules for type-specificity that C# and VB (with [Option Strict On](https://goo.gl/cLkD5X) ) do. As you can see, though, AVR’s equal assignment operation is more forgiving than what VB or C# allow. For the sake of VB and C# sharp programmers who are especially irked by this violation of type-specificity, relax. You could also write the above code pretty much like you would in VB or C# (In the code below `Convert.ToInt32()` is an intrinsic .NET numeric conversion method that attempts to convert a string to its corresponding integer value):\n\n```\nDclFld Rate Type(*String)\nDclFld NumericValue Type(*Packed) Len(8, 0)\n\nRate = '45678'\nNumericValue = Convert.ToInt32(Rate)\n```\n\nDo note that AVR’s implicit assignment conversion only works with the `*String` data type. It does not work with the `*Char` data type. The following code would not compile\n\n```\nDclFld Rate Type(*Char)\nDclFld NumericValue Type(*Packed) Len(8, 0)\n\nRate = '45678'\nNumericValue = Rate\n```\n\nThe attempted assignment of a `*Char` data type to a `*Packed` data type would cause the program compile to fail. You can use AVR's implicit assignment conversion with `*String` data types only.\n\n## AVR offers alternatives to RPG’s traditional indicators\n\nAVR offers several alternatives to both RPG’s traditional indicators and its built-in-functions (BIFs). For example, you could write this:\n\n```\nChain Cust NotFnd(*IN50)\nIf (NOT *IN50)...\n```\n\nor this\n\n```\nChain Cust\nIf (NOT %FOUND(Cust))...\n```\n\nor this\n\n```\nChain Cust\nIf (Cust.IsFound)...\n```\n\nAlthough indicators and BIFs are supported, their use for new code is discouraged. The indicator method lends itself easily to problems because the indicator is a global variable (bringing along with it the potential grief that any global variable offers). It’s just good defensive coding to avoid indicators wherever you can (and, AVR lets you avoid them everywhere!). In this example, you see that the Cust file has a property called IsFound that indicates the success of the preceding Chain operation. You’ll learn later that AVR programs are built of many objects that offer many properties. These object properties are one of the ways you can avoid using indicators in AVR.\n\nUsing RPG built-in functions is less problematic from a defensive point of view, but as you read this document, you’ll soon discover that AVR and the .NET Framework offer powerful alternatives to most green-screen RPG BIFs. Having said that, remember that if you want to use BIFs (and even indicators), you certainly can.\n\nFor VB/C# programmers, RPG indicators are class-level Boolean variables used to indicate program state. There are 99 of these variables accessible in a special array called \\*IN (in addition to these 99 indicators, there were also a handful of other special-case indicators). Years ago, before RPG acquired ‘structured’ operations such as IF and DOW (DoWhile), RPG programmers used global variables to manage program state. As explained in the paragraph above, except for backward compatibility with old code, indicator usage should generally be considered a deprecated language feature.\n\n## AVR allows long variable names\n\nUnlike traditional variable naming rules, AVR allows long variable names. While 15 or 20 characters may be the most rational maximum, AVR allows any length variable name. Long naming applies not only to variable names, but also to control names, arrays and array indexes and subroutine names.\n\nAfter having lived with the 10-character (and long ago, 6-character!) restraints green-screen RPG imposes on field names, you’ll find AVR’s long variable names quite helpful.\n\n## AVR opcodes are always listed first\n\nAVR opcodes are always listed before the operation’s operands. For example,\n\n```\nChain File(Cust) Key(CustNo)\n```\n\nor\n\n```\nDo FromVal(1) ToVal(10)\n```\n\nThis may be initially off-putting to long-time RPG coders, but most quickly realize that having the ‘verb’ first increases comprehending the code.\n\n## AVR programs don’t have executable ‘mainline’ code\n\nIn an ILE RPG or RPG/400 program, mainline code is that code provided between the top of the source code and the first subroutine. Any calculation specs provided here were executed once when the program was initially loaded. The essential building block of an AVR program is a class (more about that later) and classes don’t have executable mainline code. That may seem quite limiting but you will soon learn that AVR has more than one trick up its sleeve to provide the semantic equivalent of mainline code. (Sneak peak: If you’re even conversationally familiar with classes, you may be familiar with what a constructor is. The constructor is one way to achieve ‘mainline code’ execution.)\n\nDespite not having executable mainline code, AVR does continue the RPG idiom using the ‘mainline’ area as the place to declare anything that should be globally available to all other routines in that member. Like RPG, you must declare all F-Specs, KeyLists, and constants in this area.\n\n## Local variables\n\nUnlike traditional RPG, AVR lets you define program variables scoped only to the subroutine in which they are declared. Locally scoped variables add substantially to the robustness of your code. With locally-scoped variables, you no longer have to worry about other subroutines inadvertently changing a variable’s value. With locally scoped variables your subroutines are more loosely coupled to the rest of the routines in your program (and that’s a good thing!). When a routine is more loosely coupled to a program, changes made to the routine are less likely to cause problems in other parts of your code.\n\nAVR’s `DclFld` operation declares variables. You can use `DclFld` in either the mainline part of the program (AVR has a mainline part of code that, although it can't have any executing code, it is used to declare things global to the rest of the program.) or in subroutines. While AVR still lets you declare variables on the fly (as result fields with operations like `Z-ADD` ) that practice is strongly discouraged; it’s much better to use `DclFld` to declare all of your program or routine-level variables.\n\nBriefly a DclFld looks like this:\n\n```\nDclFld x Type(*Boolean)\n```\n\n`DclFld’s` lineage owes partly to RPG’s D-Spec and partly to CL’s `DclVar` operation. `DclFld` declares a variable's name and its data type. RPG/CL programmers should quickly see its relationship to either RPG's D-Spec and CL's `DclVar`. VB coders would see the above in VB as:\n\n```\nDim x as Boolean\n```\n\nAnd C# coders would see it as\n\n```\nboolean x;\n```\n\nFor VB/C# coders, it’s important to remember that AVR does not support block-level variable scoping like VB and C# do. In AVR, variables are scoped either to the class or to a routine.\n\nIn addition to local variables, AVR also introduces several new data types. In addition to the expected types of packed, zone, binary, and character (to name a few) AVR also introduces strings, Booleans, and integers (to name a few!). Beyond data types, there’s still plenty more to cover with DclFld—as you’ll soon see.\n\n## Subroutines\n\nSubroutines are the basic build block of an RPG program. In AVR for .NET, you’ll see that this is still true—AVR supports subroutines just like green-screen RPG does. For example, this subroutine,\n\n```\nBegSr MySubr\n    ... do some code\nEndSr\n```\n\nprovides a programming unit just as RPG/400 or ILE RPG programmers are familiar with. It can be called as RPG/400 or ILE RPG would have with\n\n```\nExSr MySubr\n```\n\nbut AVR also allows this streamlined syntax to call a subroutine:\n\n```\nMySubr()\n```\n\nThe parenthesis denote ‘subroutine.’ Anytime an identifier is followed by parenthesis it is assumed to be a subroutine (or function, which will be covered shortly). Although using `ExSr` is legal and valid in AVR, this second way is the preferred way to call a subroutine in AVR. `ExSr` should generally be considered a deprecated operation code for new programs.\n\nWhy is the second method preferred? It has to do with passing arguments to subroutines. AVR lets you pass arguments to subroutines—very much like you may be familiar with passing arguments to an OS/400 program using `CALL/PARM`. Let that concept soak in for a minute. Empowering subroutines with parameters dramatically reduces the global knowledge a subroutine must have about your program. Using parameters to get data into a subroutine more loosely couples those routines to your program that does their need for using global values to get data. Let’s consider an example.\n\nThe following subroutine requires two parameters, x and y.\n\n    BegSr MySubr\n        DclSrParm x Type(*Integer4)\n        DclSrParm y Type(*Boolean)\n    \n        ... do some code\n    EndSr\n\nAs you can see, the AVR `DclSrParm` operation is used to define subroutine parameters. The `DclSrParm` operation must follow the `BegSr` operation (or, the soon-to-be explained `BegFunc` operation). The `DclSrParm` operation will be covered in more detail later; for now just understand that each `DclSrParm` describes a parameter and data type, for a subroutine. You’ll also learn later that subroutine parameters can be passed by value or by reference.\n\n`MySubr` can be called two ways. The first of which is the verbose method which uses Exsr and the DclParm operation:\n\n```\nExSr MySubr\nDclParm a\nDclParm b\n```\n\nThe `DclParms` must be specified in the order in which the target parameters are defined in the subroutine itself (in other words, a variable must be an integer and b must be a Boolean). Like passing parameters to an OS/400 program with ``Call/Parm`, variable names don’t have to match between the call and the subroutine definition.\n\nUsing the verbose calling method requires a single line for the `Exsr` and additional single lines for each `DclSrParm` . A more succinct way, and the recommended way, of making the call is:\n\n```\nMySubr(a, b)\n```\n\nThere isn’t anything wrong with the verbose method. But as you can see, this second method is cleaner and more concise. In either case, a and b are passed as arguments to MySubr. If the subroutine doesn’t have parameters, you simply use:\n\n```\nMySubr()\n```\n\nTake care to provide the trailing, closing parentheses. These parentheses are very important. These parentheses are what indicates to the AVR compiler that this line is calling a routine. Without the parentheses, the line wouldn’t compile.\n\nC# coders should recognize an AVR subroutine as the semantic equivalent of a C# void function and VB programs should recognize it as a VB procedure.\n\nThe previous section said that subroutines are the basic building block of an RPG program. That may have been true in the green-screen RPG world, but in AVR, there is another basic build block called a function. As you’ll see in this section, functions are just as important to program building blocks as subroutines are.\n\n## Functions\n\nFunctions are similar to subroutines, but a function always returns a single value. If you’re familiar with RPG BIFs (built-in functions), AVR functions provide a similar capability but you’re in control of what they do. Let’s first look at a built-in function example as a refresher to what a function does. We’ll use the `%SUBST` BIF as our example. Consider the code below:\n\n```\nIf (%SUBST(CustName, 1, 1) = 'A')\n    ... Customer name started with 'A'\nElse\n    ... some other code\nEndIf\n```\n\nThis code uses the RPG %SUBST BIF to determine if the first character of a variable named `CustName` is an `A`. The function returns a string value. Assuming the customer's name did start with an `A`, the `%SUBST` call resolves to an `A` , resulting in the test ultimately looking like this to the compiler:\n\n```\nIf ('A' = 'A')\n```\n\nThe concept of ‘resolves to’ is very important here. The call to `%SUBST` resolved to `A` at runtime. This is an important feature of functions—they are resolved inline and their results can be used in expressions. For example, let's say you wanted to know if a customer's name begins with `AL` . You could use this (silly!) code to do that:\n\n```\nIf (%SUBST(CustName, 1, 1) + 'L' = 'AL')\n    ... Customer name started with 'AL'\nElse\n    ... some other code\nEndIf\n```\n\nThis illustrates that a function’s return value (what it resolves to) can be used in an expression. In other words, the results of a function can be used inline without intermediate variables. In the example above, the test first resolves to this code at runtime\n\n```\nIf ('A' + 'L' = 'A')\n```\n\nThen, immediately to this:\n\n```\nIf ('AL' = 'AL')\n```\n\nIn AVR, you’ll create functions to return values to your program using your data and the context of your application to determine what should be returned (and why!). Let’s take a look at a simple example. The AVR function below calculates a 5% sales tax on a sale amount. The sales tax calculated is the value this function returns.\n\n```\nBegFunc CalcSalesTax Type(*Packed) Len(12, 2)\n    DclSrParm SalesAmount Type(*Packed) Len(12, 2)\n\n    DclFld TaxAmount Type(*Packed) Len(12, 2)\n\n    TaxAmount = %DECH(SalesAmount * .05, 12, 2)\n    LeaveSr TaxAmount\nEndFunc\n```\n\nLet’s take a look at each line of code. The first line declares the function. This does two things: it names the function (`CalcSalesTax`, in this case) and identifies its return type. All functions must have a return type specified in their declaration.\n\n```\nBegFunc CalcSalesTax Type(*Packed) Len(12, 3)\n```\n\nThe next line declares a parameter for the function. In this case, the sales amount is being passed to the function. Functions can have any number of parameters. Note that the parameter types don’t have anything to do with the return type. In this case, they are the same, but they don’t have to be (and often aren’t).\n\n```\nDclSrParm SalesAmount Type(*Packed) Len(12, 3)\n```\n\nThe next line declares a return value as in intermediate variable. This line isn’t necessary but is added for clarity. A subsequent example will show how this line can be eliminated.\n\n```\nDclFld TaxAmount Type(*Packed) Len(12, 3)\n```\n\nThe next line performs the calculation. In this case, the function uses the `%DECH` BIF to calculate the rounded sales tax amount. As with most of AVR’s BIFs, the syntax is identical to that of the corresponding ILE RPG function.\n\n```\nTaxAmount = %DECH(SalesAmount * .05, 12, 2)\n```\n\nThe next line returns the value of the function. Every function must have at least one `LeaveSr`. `LeaveSr's` job is to cause program flow to immediately leave the function, returning the result value specified. AVR's `LeaveSr` opcode is analogous to VB and C#'s` Return`` statement.\n\n```\nLeaveSr TaxAmount\n```\n\nAnd finally, the function is ended with EndFunc.\n\n```\nEndFunc\n```\n\nHere’s how the preceding function could have been written without the TaxAmount:\n\n```\nBegFunc CalcSalesTax Type(*Packed) Len(12, 2)\n    DclSrParm SalesAmount Type(*Packed) Len(12, 2)\n\n    LeaveSr %DECH(SalesAmount * .05, 12, 2)\nEndFunc\n```\n\nIn the example above the sales tax is calculated and returned all at once. This style of function saves code and may be appropriate for very simple functions. However for most functions I think you’ll find that using an intermediate variable for the return value adds substantially to the clarity of the function.\n\nThere is a subtle nuance that the `CalcSalesTax` function illustrates: It receives an input and returns an output. This function knows nothing about the rest of the program, nor does it need to—for all intents and purposes CalcSalesTax is a black box that hides its implementation from the rest of the program. All a consumer need to know about the function is that when you pass it a value, it returns a 5% sales tax. The consumer doesn’t know, or care, how the sales tax was calculated.\n\nLong-time RPG coders should ponder the concept of `CalcSalesTax` not having any dependency on global variables. This is a good thing! With `CalcSalesTax's` action isolated from the rest of the program, we know it's 100% safe to make changes to `CalcSalesTax` without causing any unexpected side effects throughout the rest of the program. This black box concept, known also as information hiding or loose coupling is key to quality programs. You’ll see this concept revisited many times as you learn about AVR.\n\n## Summary\n\nThis document introduced you to a number of AVR’s unique features. For veteran RPG programmers, concepts were covered that you’ve never seen in RPG before. There are certainly a lot of new and exciting features in AVR. And, as you’ll see as you learn more about AVR, that AVR has taught the old RPG dog many other new dazzling tricks (OO, anyone?). However, you’ll also see that AVR, for all its newfound power and capabilities, is surprisingly backward compatible with many time-honored RPG features and facilities. For example, virtually all of green-screen’s RPG file IO model persists. You’ll also recognize many other old RPG friends as you read on. For VB/C# coders, this document introduced AVR’s syntax and also hinted at the fact that AVR does indeed, semantically if not syntactically, have a lot in common with VB.NET and C#.\n\nAs you learn AVR, you’ll quickly see that RPG isn’t near as old-fashioned, or foreign, as you may have once thought."
        }
    },
    {
        "dirent": {
            "name": "avr-classic-cloud-environment.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR Classic and cloud environments",
                "description": "This article discusses considerations for moving an ASNA Visual RPG Classic application to a cloud provider.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T19:07:27.000Z",
                "date_created": "2024-01-11T19:07:27.000Z",
                "pinned": false
            },
            "content": "\nOver the last couple of years, the cloud has become a very desirable option for deploying enterprise applications. Lately, we’ve had a couple of customers deploy AVR Classic apps to the cloud–with mixed results. The cloud has gotten so popular that there are now many cloud providers. A partial list includes:\n\n*   Amazon Web Services\n*   Digital Ocean Cloud\n*   Google Cloud Platform \n*   IBM Cloud\n*   Microsoft Azure\n*   Rackspace Managed Cloud Services\n\nWhile conceptually similar, each of these cloud vendors has very different ways of doing things, different names for things, and varying levels of compatibility with older, COM-based applications.\n\nAVR Classic was originally introduced more than 25 years ago. It was intended for traditional desktop environments–not modern cloud environments. The cloud injects many more variables into the deployment of what was intended to be a traditional, desktop application. \n\nWe test our Classic products in their traditionally-intended desktop environments, not in cloud-based environments. We don’t have the expertise to test and certify our AVR Classic products when deployed to cloud environments, so therefore we do not support nor do we recommend using AVR Classic in cloud environments. \n\nPlease beware that you may be able to use AVR Classic with your cloud vendor of choice, but many issues abound, including:\n\n*   Deployment\n*   Performance\n*   Printing\n*   Security\n*   Third-party controls\n\nMany of these issues are quite challenging to resolve, especially without having deep, first-hand experience with these environments. It’s prudent to consider hiring a qualified cloud specialist (for the specific cloud vendor you’ve selected) to help you. There are lots of knobs and dials to twist to get this right.\n\nIf you do choose to deploy your AVR Classic applications to a cloud-hosted service, we’ll do all that we can to help you, but please understand that it might not work and we don’t claim that it does.\n"
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-ranked.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR for .NET arrays: dynamically-sized arrays",
                "description": "This article explains how to used ranked (aka dynamic) arrays in Visual RPG. ",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:10:39.000Z",
                "date_updated": "2024-01-09T17:47:19.000Z",
                "date_created": "2024-01-09T17:47:19.000Z",
                "pinned": false
            },
            "content": "\nAVR for .NET offers two types of arrays:\n\n*   **Dimmed array**. An array whose number of elements are known when it’s declared (ie, at compile time). Part 1 of this series covered the basics of dimmed arrays. If you’re familiar with AVR Classic’s arrays you’ll find AVR for .NET’s dimmed arrays to be very similar.\n*   **Ranked array**. An array whose number of elements are not known when it’s declared (ie, the number of elements in ranked arrays are set at runtime–and may change at runtime).\n\nAVR Classic offered only dimmed arrays (arrays of fixed size). This constraint often caused arrays in AVR Classic to be declared much larger than necessary. For example, consider needing to populate an array with the names of files in a folder. In some cases, there may be just a few files in that folder; in other cases there may be hundreds. To be safe in AVR Classic, you’d need to declare the array with enough elements to hold the maximum number of files you’d expect the folder to contain. Not only was this nearly always very wasteful, guessing too low would cause the program to fail. AVR for .NET’s dynamically-sized arrays, its ranked arrays, allow for that array of file names to be correctly sized every time.\n\n#### Declaring variably-sized arrays\n\nTo declare an array of a known number of elements at design-time use the`Dim()` keyword;  to declare an array with a dynamic number of elements at design-time use the `Rank` keyword. to specify the number of dimensions. The `Dim()` and `Rank()` keywords are mutually exclusive—use one or the other.\n\nThe code below declares a single dimension array with 10 elements:\n\n```\nDclArray MyFiles Type(*String) Dim(10)    \n```\nThis array can only contain ten elements, no more, no less.\n\nThe code below declares an array of a single dimension with an unknown number of elements:\n\n```\nDclArray MyFiles Type( *String ) Rank( 1 )\n```\n\nThis array can contain any number of elements and its number of elements may change multiple times during runtime. Although the number of elements in a ranked array can vary at runtime, the number of dimensions is fixed with the number of dimensions specified with the `Rank()` keyword. That ranked arrays use `Rank` and not `Dim` to specify the number of dimensions is a little confusing. However, AVR Classic’s long history of using `Dim` to specify fixed-size arrays required that dynamic arrays dimensions be specified with a different keyword.\n\nTo summarize: Ranked arrays are declared with a specify number of dimensions using the `Rank` keyword. A ranked array’s number of elements is determined at runtime and may change during the course of the program.\n\nUsing a breakpoint right after the ranked array declaration below shows that at runtime, immediately after the declaration, the array has no elements and its value is `*Nothing.`\n\n![how a ranked array looks in Visual Studio immediately after its declaration](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dynamic-arrays-01.png)  \n\nFigure 1 shows how a ranked array looks in Visual Studio immediately after its declaration.\n\nRanked arrays are often used to store a varying size list of array elements as returned from a function. Many functions in the .NET Framework return dynamically-sized arrays (and we’ll soon see how you can write your own functions to return a dynamically-sized array). Let’s revisit the need to fetch a list of file names from a folder. Here’s a good way to do that in AVR for .NET:\n\n```\nDclArray MyFiles Type( *String ) Rank( 1 )\n\nMyFiles = System.IO.Directory.GetFiles(\"c:\\pdfs\")\n```\n\n![A ranked array populated with file names in a given folder](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dynamic-arrays-02.png)  \nFigure 2. A ranked array populated with file names in a given folder.\n\nRegardless of the number of files in the `c:\\pdfs` folder MyFiles will always have one element for each file in the folder each time `GetFiles()` is called.\n\n#### Explicitly populating a ranked array\n\nTo explicitly populate a ranked array, you need to create a new instance of the array. For example, let’s use a variable named `MemberCount` to determine, at runtime, how many elements the `Members` array should have. To do this, you’d use this code:\n\n```\nDclFld MemberCount Type(*Integer4) \nDclArray Members Type(*String) Rank(1) \n\nMemberCount = 4\nMembers = *New *String[MemberCount]   \n```\n![After creating a new instance of the Members array it has four elements](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dynamic-arrays-03.png)  \nFigure 3. After creating a new instance of the Members array it has four elements.\n\nAfter creating the Members array, you can now assign the four elements’ values.\n\nNote that `MemberCount` is wrapped in brackets \\[\\] immediately after the array type. Parentheses _will not work_ in this case. The line below will not compile:\n\n```\nMembers = *New *String(MemberCount)\n```\n\nThis is yet another good reason to always use brackets to indicate array subscripts. There are some places where AVR for .NET will accept either parentheses or brackets—it is better to always use brackets to indicate array subscripts.\n\n#### A ranked array subtly\n\nA subtle ranked array rule is at play here: a ranked array’s size is immutable–once a number of elements is assigned to it, it can’t be changed. However, you can re-instance the array to a number of elements as many times as necessary. For example, consider the following code:\n\n```\nDclArray MyFiles Type( *String ) Rank( 1 )\n\nMyFiles = System.IO.Directory.GetFiles(\"c:\\pdfs\")\n// Do something here with the file names returned. \n\nMyFiles = System.IO.Directory.GetFiles(\"c:\\docs\")\n// Do something here with the file names returned.\n```\n\nEach time `GetFiles()` is called, the array it returns is instanced to the correct size and a reference to that new instance is assigned to `MyFiles.`\n\nDimmed arrays, by contrast, must always have the number of elements with which the dimmed array was declared.\n\n#### Ranked array shorthand\n\nWhen declaring ranked arrays, there is a shorthand available that instances and populates a ranked array with a single line of code. For example, this code:\n\n```\nDclArray Members Type(*String) Rank(1)\n\nMembers = *New *String[] {\"John\", \"George\", \"Ringo\", \"Paul\"}\n```\n\nfirst declares a ranked array of type `*String`. The second line then implicitly instances a four-element array with the values specified in braces. The number of values specified in the braces determines how many elements will be in the array.\n\nThe code above is semantically identical to doing this:\n\n```\nDclArray Members Type(*String) Rank(1)\n\nMembers = *New *String[4]\n\nMembers[0] = \"John\"\nMembers[1] = \"George\"\nMembers[3] = \"Ringo\"\nMembers[4] = \"Paul\"\n```\n\n#### Creating a function that returns a ranked array\n\nYou’ll usually want to bury the details of how a ranked array gets populated in a function. For example, consider how clean this code is:\n\n```\nDclArray MyFiles Type( *String ) Rank( 1 )\n\nMyFiles = System.IO.Directory.GetFiles(\"c:\\pdfs\")\n```\nThe code doesn’t care how the array of file names was populated. Here is a function that hides the logic of getting the names of the Beatles:\n\n```\nBegFunc GetBeatlesNames Type(*String) Rank(1)   \n    DclArray Members Type(*String) Rank(1)\n\n    Members = *New *String[] {\"John\", \"George\", \"Ringo\", \"Paul\"}\n\n    LeaveSr Members\nEndFunc\n``` \n\nTo return a ranked array from a function, specify the function’s type with the Type() keyword and then specify the number of dimensions of an array of that type. Note that you never specify the number of elements to return; you only specify the array’s dimensions. Calling the `GetBeatlesNames()` function is pretty predictable:\n\n```\nDclArray Members Type(*String) Rank(1)\n\nMembers = GetBeatlesNames()\n``` \n\n#### The Chicken or the Egg\n\nA ranked array conundrum awaits you if you want to populate a ranked array by reading a variable number of records in a file. The problem is, you can’t instance the ranked array until you’ve read the variable number of records because you wouldn’t know how many elements the ranked array should be instanced with. Ranked arrays aren’t like collections, you can’t just dynamically add elements to them; you must first instance the ranked array to the correct number of elements.\n\nA way to resolve this conundrum is to read as many records as required and save the values from each in a collection. Then, convert that collection to an array as the function’s return value. This version of the `GetBeatlesNames()` function is shown below:\n\n```\nBegFunc GetBeatlesNames Type(*String) Rank(1)   \n    DclArray Members Type(*String) Rank(1)\n\n    DclFld BeatlesCollection Type(System.Collections.Generic.List(*Of *String)) New()\n\n    SetLL Beatles Key(*Start) \n    Read Members\n    DoUntil (Members.IsEof)\n        BeatlesCollection.Add(Name) \n        Read Members\n    EndDo \n\n    Members = BeatlesCollection.ToArray()\n\n    LeaveSr Members\nEndFunc\n``` \n\nIn this case, a member is added `BeatlesCollection` each time a record is read. After populating the `BeatlesCollection`, its `ToArray()` method assigns the correspond array to `Members`.  Why not just return the collection? In many cases you might, but there are also many cases where it is leaner and cleaner to return a simple array.\n\n"
        }
    },
    {
        "dirent": {
            "name": "change-datagate-for-ibm-i-port.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Change DataGate for IBM i's TCP/IP port",
                "description": "How to change the TCP/IP port that DataGate for IBM i uses",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2023-11-14T00:00:00.000Z",
                "date_updated": "2023-11-14T00:00:00.000Z",
                "date_created": "2023-11-14T00:00:00.000Z",
                "pinned": false
            },
            "content": "\nThis article explains how to change the TCP/IP port that DataGate uses.\n\nWhy would you ever want to change the TCP/IP port? In normal circumstances, you’d generally not ever need to do this. However, if you're installing a second DataGate instance, you may want to change the existing existing TCP/IP port so that the second instance can use that port number. \n\n## To change the TCP/IP port that DataGate uses:\n\n1. Ensure no DateGate user jobs are active and then end DataGate with \n    ```\n    <DataGate library name>/ENDDG8SRV\n    ```\n2. Delete the Service Table Entry for your old version of DataGate:\n\n\t* Type `WRKSRVTBLE` on the IBM i command line and press Enter.\n\n\t* Scroll to bottom of the list.\n\n\t* The DataGate entry is usually listed as `DataGatexxy` where `xx` = main version number and `y` = minor version number.\n\n\t* Use option 5 to display the DataGate entry.\n\n\t* Write down the Service and Port values shown (or take a screen shot of it). You’ll use the port value in Step 5.\n\n\t* Press enter to return to the Service Table Entries list and use Option 4 to remove this Service Table Entry.\n\n3. Create a new Service Table Entry for your new DataGate instance with the ADDSRVTBLE command using these values:\n\n    * `Service` = Use the Service value as determined in Step 4 (use exactly the same case as determined in Step 4).\n     \n    * `Port` = Port value used by old instance (as determined in Step 3)\n    \n    * `Protocol` = \"tcp\" where lowercase is very important!\n    \n    * `Description` = DataGate xxy (where xx = the major DG  version number and y = the minor version number)\n\n3. Restart your new DataGate instance:\n\n    ```\n    <new DG Library name>/STRDG8SRV\n    ```\n    \n> Your DataGate Database Names must also be changed to match the port number in the Service Table entry. \n\n"
        }
    },
    {
        "dirent": {
            "name": "calculate-date-time-differences.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to calculate date/time differences in Visual RPG for .NET",
                "description": "This article shows how to calculate date/time differences in Visual RPG for .NET.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-08T23:31:20.000Z",
                "date_updated": "2024-01-09T06:26:24.000Z",
                "date_created": "2024-01-09T06:26:24.000Z",
                "pinned": false
            },
            "content": "\nBack in the halcyon days of RPG II/III, calculating differences between two dates or times was enormously complex and took tons of code (does anyone else remember Paul Conte's multi-part \"Ultimate Date Routines\" series in NEWS/400 magazine?). Well, that was then and this is now.\n\n.NET offers superb date calculation capabilities. Let's take a brief look at how to use them. Let's say you wanted to know how long it's been since the Beatles' US debut on Ed Sullivan's stage on February 9th, 1964 and the last time they played together live on that blustery rooftop in London (with the late, great Billy Preston on the organ) on January 30th, 1969.\n\nHere is the nearly self-explanatory code to calculate date durations in ASNA Visual RPG:\n\n```\n    DclFld From Type(DateTime) \n    DclFld To Type(DateTime) \n    DclFld ts Type(TimeSpan) \n    \n    From = *New DateTime(1964, 2, 9)\n    To = *New DateTime(1969, 1, 30)\n    \n    ts = To.Subtract(From) \n    \n    DclFld Difference Type(*Packed) Len(12,2) \n    \n    Console.WriteLine('Duration between the Beatles'' first live US performance')\n    Console.WriteLine('and their last live performance in London')\n    Console.WriteLine('')\n    \n    Difference = ts.TotalDays / (365.25 / 12)         \n    Console.WriteLine('Decimal months :' + Difference.ToString('#,###.00'))\n    \n    Console.WriteLine('Decimal days :' + ts.TotalDays.ToString('#,###.00'))\n    Console.WriteLine('Decimal hours :' + ts.TotalHours.ToString('#,###.00')) \n    Console.WriteLine('Decimal minutes :' + ts.TotalMinutes.ToString('#,###.00'))\n    Console.WriteLine('Decimal seconds :' + ts.TotalSeconds.\n    ToString('#,###.00'))\n```    \n\n![Showing date/time differences in action](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/datediff-2.png)\n\n  \nFigure 1. Program output  \n\nCrazy, huh? The magic is in the [System.TimeSpan structure](https://docs.microsoft.com/en-us/dotnet/api/system.timespan?view=netframework-4.7.1) , which represents a time interval. As you can see, TimeSpan is capable of rendering differences in several units.\n\nThe example above shows just the tip of the iceberg for what you can do with dates and times in AVR for .NET. Study the TimeSpan structure for more of its capabilities."
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-methods-props.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR for .NET arrays: methods and properties",
                "description": "This article explains the many methods and properties that you can use with Visual RPG and its arrays",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:54:01.000Z",
                "date_updated": "2024-01-09T17:54:27.000Z",
                "date_created": "2024-01-09T17:54:27.000Z",
                "pinned": false
            },
            "content": "\nUnder the covers, arrays in AVR are instances of .NET’s [System.Array class.](https://msdn.microsoft.com/en-us/library/system.array(v=vs.110).aspx) As such, there are a bevy of methods you can use to work with arrays. There are also a few properties that are handy. [Click here](https://msdn.microsoft.com/en-us/library/system.array_members(v=vs.90).aspx) to read details about all the methods and properties arrays provide. Here is a quick overview of the most-used methods and properties:\n\n#### Array methods\n\n*   **Clear**– Sets a range of elements in the array to zero, false or null\n*   **Copy** – Copies elements from one array to another\n*   **CopyTo** – Copies all the elements of a one-dimensional array to another one-dimensional array\n*   **GetUpperBounds** – Get the upper bound of a given dimension of an array\n*   **GetLowerBounds** – Get the lower bound of a given dimension of an array\n*   **IndexOf** – Returns the index of the first occurrence of a value in a one-dimensional array\n*   **Sort** -Sort the elements in a one-dimensional array\n\n#### Array properties\n\n*   **Length** – Get the number of elements in an array. For multi-dimensional arrays, this returns the total number of elements (ie, a 3×3 array has a Length of 9).\n*   **Rank** – Get the number of dimensions in an array.\n\n#### Traversing an array\n\nYou can see array methods in action when you investigate the ways AVR for .NET lets you traverse an array. There are at least four ways to do this.\n\nConsider this array declaration:\n\n```\nDclArray MyArr Type(*Integer4) Rank(1)\nDclFld   x     Type(*Integer4)\n\nMyArr = *New *integer4[] {24, 30, 36, 42}\n```    \n\nYou could traverse this array with a `Do` loop using a hard-coded upper bound:\n\n```\nDo FromVal(0) ToVal(3) Index(x) \n    MsgBox MyArr[x] \nEndDo\n```       \n\nYou could also traverse this array with a `Do` loop using a soft-coded upper bound this way:\n\n```\nDo FromVal(0) ToVal(MyArr.Length - 1) Index(x) \n    MsgBox MyArr[x] \nEndDo\n```  \n\nWith the above method, note that if `MyArr` were a multi-dimensional array, the loop would traverse over all elements of all dimensions.\n\nYou could traverse this array with a `Do` loop using a soft-coded upper bound:\n\n```\nDo FromVal(0) ToVal(MyArr.GetUpperBound(0)) Index(x) \n    MsgBox MyArr[x] \nEndDo\n```  \n\nWith the above method, the argument you pass to `GetUpperBound` specifies which dimension to traverse.\n\nAnd, you could also use `For/Each` to traverse the array:\n\n```\nForEach x Collection(MyArr)\n    MsgBox x \nEndFor\n```                 \n\nThe `For/Each` method is handy, but it does not explicitly provide access to the current index of the element fetched.\n\nIn Part 4, we’ll take a look at passing arrays as arguments."
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-overview.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Getting to Know Arrays in AVR for .NET",
                "description": "This article provides an overview of using arrays with Visual RPG.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:10:39.000Z",
                "date_updated": "2024-01-09T17:12:13.000Z",
                "date_created": "2024-01-09T17:12:13.000Z",
                "pinned": false
            },
            "content": "\nArrays are one of the most frequently used data structures in computer programming. Arrays are quite different in AVR for .NET than they were in AVR Classic–but they are also vastly more powerful. This article takes a look at AVR for .NET’s arrays. This article is aimed at getting any programmer quickly up to speed with AVR’s arrays, but it should be especially helpful for programmers with an AVR Classic background. Please note that when this article references “AVR” it is speaking about AVR for .NET.\n\nHere is a summary of the array topics this article covers:\n\n*   AVR for .NET supports a statically-sized array (just like AVR classic did).\n*   All arrays in AVR for .NET are zero based (unlike AVR Classic arrays).\n*   AVR for .NET supports multi-dimensional arrays.\n*   You don’t have to specify the number of elements in an array when you declare it (this is a “ranked” array—more on ranked arrays in a moment).\n*   Arrays can be traversed with For/Each.\n*   You can change the number of elements in an array at runtime.\n*   Arrays can be passed, by reference, as arguments to subroutines and functions.\n*   Arrays can be returned as a function result.\n\n#### Using statically-sized arrays\n\nThe number of elements of a statically-sized array is hardcoded in your code and cannot be changed at runtime. For example:\n\n```\nDclArray arr Type(*String) Dim(4) \n\narr[0] = \"John\"\narr[1] = \"George\"\narr[2] = \"Ringo\"\narr[3] = \"Paul\" \n``` \n\nThis type of array is essentially what AVR Classic offered—however note that the first element is the zeroth element. _This is very important._ If you have experience with VB.NET, AVR fixed an annoying VB quirk with its array declarations. In VB.NET, the default behavior of Dim(4) results in an array with five elements—which is silly. I can’t think of another zero-based language that does that (C# and Java, for example, don’t  do that).\n\nWhile AVR fixed one VB.NET array annoyance, another was persisted. Had this issue not been persisted, it would have probably caused AVR Classic coders some grief–but still, it’s odd. The Dim keyword implies that you are specifying the number of dimensions in the array. You aren’t, you are specifying the number of elements in as many dimensions as are declared. For example, Dim(4) declare a single-dimensioned array with four elements; Dim(3,3) (as shown below) declares two dimensional array where each dimension has three elements.\n\n#### Multi-dimensional arrays\n\nThe code below creates a statically-sized multi-dimensional array:\n\n```\nDclArray arr Type( *Integer4 ) Dim( 3,3 ) \n\narr[0,0] = 1 \narr[0,1] = 2\narr[0,2] = 3 \n\narr[1,0] = 5 \narr[1,1] = 6\narr[1,2] = 1\n```\n\nIn this case, the use case might be that we need to model a Rubik’s cube for an online game. Each element in the matrix is assigned one of six colors. (This example shows filling only six of the available 27 elements). For a fun exercise, [take a look at some algorithms to solve Rubik’s cube.](http://en.wikipedia.org/wiki/Optimal_solutions_for_Rubik%27s_Cube)\n\n#### Using dynamically-sized arrays\n\nLet’s say that you need to get a list of files in the root of your C: drive. In this case, a variable number of files may be returned each time you request the list–depending on when files have been added or deleted. With statically-sized arrays, you need to guess the largest possible value—which can be quite wasteful. Dynamically-sized arrays are called “ranked” arrays. Before we look at ways to populate a ranked array, let’s take a look at one way you can use ranked arrays. The code below uses the GetFiles() method in .NET’s System.IO.Directory class to return the names of the files in the path specified. There are many other methods in the .NET Framework that return ranked arrays.\n\n```\nDclArray files Type(*String) Rank(1)\n\nfiles = Directory.GetFiles( \"c:\\\" )\nForEach f Type( *String ) Collection( files ) \n    Console.WriteLine( f )\nEndFor\n```\n\nThe GetFiles() method always returns an array with exactly the number of elements required. Note also how this code uses ForEach to traverse the array returned.\n\nIn this case, the DclArray operation declares the variable _files_ as an array of strings with a single dimension—but this declaration doesn’t assign any elements to the ranked array at compile time (formally, the ranked array has been declared but it has not yet been instanced). Ranked arrays are _always_ populated at runtime. In the case of ranked arrays, we need to declare the number of dimensions of the array. But we can’t use the Dim keyword because, for legacy reasons, that keyword is use for statically-sized arrays. Therefore, in this case you need to use the Rank keyword. Just like statically-sized arrays, ranked arrays can also be multi-dimensional. The code below declares a two-dimensional array of integers.\n\n```\nDclArray arr Type(*Integer4) Rank(2)\n```\n\nHow many elements are in either of the two dimensions of _arr_? You can’t tell from looking at the single line of code above. The number of elements in any of a ranked array’s dimensions is unknown until runtime.\n\nLet’s say that you want a single dimensional array of integers with four elements. The code below declares a single-dimensioned array of integers and then assigns four elements. The compiler doesn’t know how many elements are in _arr_–it gets instanced to four elements at runtime.\n\n```\nDclArray arr Type( *Integer4 ) Rank( 1 )\narr = *New *Integer[4]\n```\n\nNote the brackets in the second line above. When instancing a ranked array, these brackets must immediately follow the array’s data type (don’t use parenthesis here, they won’t work). The value inside the brackets must specify the number of array elements to create—if it is known at design time. (The brackets indicate “array” to .NET.) If the number of elements isn’t known until runtime, use a variable instead of hard coding the value (as shown below).\n\n```\nDclArray arr      Type(*Integer4) Rank(1)\nDclFld   Elements Type(*Integer4) \n\nElement = 67\nArr = *New *Integer[ Elements ]\n```\n\nRanked arrays also let you assign the number of elements and the element values all at once with the code shown below:\n\n```\nDclArray Beatles Type( *String ) Rank( 1 )\n\nBeatles = *New *String[] { \"John\", \"George\", \"Ringo\", \"Paul\" }\n```\n\nIn this case, note that the brackets following the data type are empty—the number of elements in the braces immediately following the data type are assigned to the array. Let’s assume that in another part of your code, you needed an array with _all_ of the members of the Beatles, not just the Fab Four. You could redefine the previously populated Beatles array with this code:\n\n```\nBeatles = *New *String[] { \"John\", \"George\", \"Ringo\", \"Paul\", \"Stu\", \"Pete\", \"Billy\" }\n```\n\nThe code above assumes you’re willing to accept the late, great [Billy Preston](http://en.wikipedia.org/wiki/Billy_preston) (which I admit is a reach) as a member of the Beatles. AVR (as well as C#) doesn’t have a REDIM operation like VB does, but you could easily code one yourself if you need it (however, if you need to do that, you should maybe be looking at the numerous collection data types that .NET provides in the System.Collections namespace). (A minor footnote for advanced .NET programmers: recognize that the code above isn’t appending elements to the previously populated array, rather is its simply instancing a new array with seven elements. The original array with only the Fab Four in it gets reclaimed by the garbage collector.)\n\nTo iterate over the elements in a ranked array, you can either use the ForEach construct previously discussed or if you need the current index during the iteration use AVR’s For opcode as shown below:\n\n```\nDclFld i Type( *Integer4 )\n\nFor Index( i = 0 ) To( myArr.Length - 1 )           \n    Console.WriteLine( myArr[i] )\nEndFor\n```\n\n#### Passing arrays as arguments to functions or subroutines\n\nEither Dimmed or Ranked arrays can be passed as arguments to either functions or subroutines. But do remember that because arrays in general in .NET are instances of a reference type, they are _always_ passed by reference. Therefore, changes made in the called routine are _always_ reflected in the caller. _Always. Because arrays are a reference type object, you can’t defeat this pass-by-reference behavior—so be careful and know what to expect when you pass arrays around._\n\nConsider the following code:\n\n```\nBegSr PassArraysAsArgs Access( *Public )\n    DclArray Beatles Type( *String ) Rank( 1 )\n\n    Beatles2 = *New *String[] { \"John\", \"George\", \"Ringo\", \"Paul\" } \n\n    ChangeBeatle( Beatles )\n    // Beatles[1] is now \"GEORGE\"\nEndSr\n\nBegSr ChangeBeatle\n    DclSrParm Beatles Type( *String ) Rank( 1 )\n\n    Beatles[1] = Beatles[1].ToUpper()\nEndSr\n```\n\nOr\n\n```\nBegSr PassArraysAsArgs Access( *Public )\n    DclArray Beatles Type( *String ) Dim( 4 ) \n\n    Beatles1[ 0 ] = \"John\"\n    Beatles1[ 1 ] = \"George\"\n    Beatles1[ 2 ] = \"Ringo\"\n    Beatles1[ 3 ] = \"Paul\"\n\n    ChangeBeatle( Beatles )\n    // Beatles[1] is now \"GEORGE\"\nEndSr\n\nBegSr ChangeBeatle\n    DclSrParm Beatles Type( *String ) Rank( 1 )\n\n    Beatles[1] = Beatles[1].ToUpper()\nEndSr\n```\n\nIn either example, the value of the Beatles\\[1\\] element that was changed in the ChangeBeatle() subroutine is reflected in the routine that called ChangeBeatle(). Even though it was not declared as such, the dimmed array in the second example is passed as a ranked array. The only way to pass arrays as routine arguments is to pass them as ranked arrays.\n\n#### Returning an array as a function result\n\nUsed ranked arrays to return an array as the result of a function, isn’t something you’ll do often, but it’s good to know how to do it. Note how the array returned in the GetBeatlesArray() function is declared as a dimmed array inside the routine–but also notice that the return value of the function is declared as a ranked array. The result array can be either a dimmed or ranked array, but it must be returned as, and received as, a ranked array.\n\n```\nBegSr TestGetBeatlesArray Access(*Public)\n    DclArray Beatles Type(*String) Rank(1) \n\n    Beatles = GetBeatlesArray()\n\n    ForEach Beatle Type(*String) Collection(Beatles) \n        Console.Writeline(Beatle)\n    EndFor\nEndSr\n\nBegFunc GetBeatlesArray Access(*Public) Type(*String) Rank(1) \n    DclArray Beatles Type(*String) Dim(4) \n\n    Beatles[0] = \"John\"\n    Beatles[1] = \"George\"\n    Beatles[2] = \"Ringo\"\n    Beatles[3] = \"Paul\" \n\n    LeaveSr Beatles\nEndFunc\n```\n\nThat’s probably enough about arrays for now. Spend some time with the array handling in AVR for .NET and don’t be afraid to break out of your dimmed array comfort zone. Once learned, ranked arrays provide a tremendous payout.\n"
        }
    },
    {
        "dirent": {
            "name": "clearing-dg8_vcat72-library.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Clearing DataGate's DG8_VCAT72 library",
                "description": "DG8_VCAT72 is a cache library that all installed DG for IBM i instances user. This article discusses clearing DG8_VCAT72.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2023-11-14T17:47:50.743Z",
                "date_updated": "2023-11-14T17:47:50.743Z",
                "date_created": "2023-11-14T17:47:50.743Z",
                "pinned": false
            },
            "content": "\n## Question\n\nCan DataGate’s IBM i DG8_VCAT72 library be cleared? There are over 11,000 objects in this library, some dating back to 2016. Please help!\n\n## Answer\n\nThe DG8_VCAT72 library is cache library that is shared by all installed instances of DataGate for IBM i.\n\nIt is OK to use CLRLIB with the DG8_VCAT72 library, but do that when there aren't any any active DataGate for IBM i users&mdash;otherwise the active users will immediately get a non-responsive app and those jobs will lock-up and need manual attention to remove. Except for very old versions of DataGate, this library is always named DG8_VCAT72. \n\nUnder normal circumstances you don’t want to clear this library because it does significantly improve DataGate performance. However, there may be times where it has acquired a number of unused or stale cached file definitions or if your disk space is running so dangerously low that you need disk space. In that case, you can use CLRLIB (as explained above) to clear this library.\n\nYou may also need to clear DG8_VCAT72 if you get this error message:\n\n`Acceler8DB Error: Corrupt file definition cache member.`\n\nThat error usually means the cache contains a corrupt member&mdash;probably as the result of an end-user job that ended abnormally. \n\n"
        }
    },
    {
        "dirent": {
            "name": "datagate-monitor.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using the DataGate Monitor",
                "description": "The ASNA DataGate Monitor (DGM) is a free-standing utility that lest you servers to create, maintain, and test database names.",
                "tags": [
                    "datagate-ibm-i",
                    "datagate-sql-server"
                ],
                "date_published": "2024-01-10T14:45:54.000Z",
                "date_updated": "2024-01-10T20:46:44.000Z",
                "date_created": "2024-01-10T20:46:44.000Z",
                "pinned": false
            },
            "content": "\nThe ASNA DataGate Monitor (DGM) is a free-standing utility that you can install on client Windows desktops and servers to create and maintain database names. It doesn’t require Visual Studio and has a very small footprint on the client machines.\n\nDGM can also help with several aspects of using the ASNA DataGate Local Database engine. It can: \n\n*   Create local databases\n*   Create database names (this video also digs into some detail on database names)\n*   Show local database active jobs\n*   Repair local databases\n\n<a target=\"_blank\" href=\"https://youtu.be/DQ4W3BR11ZU\">This video </a> explains the DataGate Monitor shows it in action. \n\n"
        }
    },
    {
        "dirent": {
            "name": "dot-net-saga.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "The .NET Saga: From .NET Framework to .NET",
                "description": "This article explains Microsoft .NET versus .NET Framework.",
                "tags": [
                    "dot-net",
                    "dot-net-framework"
                ],
                "date_published": "2024-01-09T12:29:30.000Z",
                "date_updated": "2024-01-09T18:46:53.000Z",
                "date_created": "2024-01-09T18:46:53.000Z",
                "pinned": false
            },
            "content": "\nIn early 2002, Microsoft officially released .NET Framework 1.0 to the world. This was a big bet from Microsoft that aimed to replace the aging and ailing COM development model. .NET Framework was part:\n\n*   a competitive response to Java\n*   an amalgam of various languages and integrated developer tools\n*   an attempt to make it much easier to create enterprise Websites and Web services\n\nAt its launch in 2002, Bill Gates described it as \"the first fully integrated development environment for building XML Web services and next-generation Internet applications.\" As with everything else Microsoft did back then, .NET Framework ran only on the Windows platform.\n\n.NET Framework compilers don’t generate processor-specific instructions, rather they generate a source language-independent byte code binary called Microsoft Intermediate Language (MSIL). At runtime, the .NET Framework Common Language Runtime translates the byte code to machine instructions to execute the .NET Framework binaries (as shown below in Figure 1a). The .NET Framework runtime model was very similar to the Java runtime model.\n\n## A new programming model\n\n![.NET Framework 1.0 MSIL and CLR](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dot-net-1-fw.png)\n\nFigure 1a. .NET Framework 1.0 MSIL and CLR\n\n.NET Framework also provided a full-featured stack of application development components. Its original stack is shown below in Figure 1b, which identified Windows forms, ASP.NET Web development, and ADO.NET database access as its major components:\n\n![The original .NET Framework stack](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dot-net-1-0-components.png)\n\nFigure 1b. The original .NET Framework stack.\n\n.NET Framework also included Visual Studio for .NET, which provided a full-featured and comprehensive integrated development environment. Visual Studio provided, in one package, user interface designers, debuggers, language services that provided design-time code information (Intellisense), and database access deployment tools (among a host of other bits and bobs). A notable feature of Visual Studio was that it could support third-party add-ins and extensions. This opened the door for third parties to add languages and productivity plugs to Visual Studio.\n\nMicrosoft was especially proud that at the .NET Framework 1.0 announcement there were 20 or so languages available for .NET, most provided by third-parties. Although many of these languages were academic exercises, ASNA Visual RPG and MicroFocus COBOL (both there at the beginning), were proof that the enterprise was represented with real-world languages. Having multiple development languages gave .NET a big nudge over the Java ecosystem, which also let you use any language you wanted, as long as it was Java.\n\nASNA is a charter member of the Visual Studio Integration Partner program. We’ve worked very hard to ensure that our .NET Framework products work in a seamless, natural way with Visual Studio. .NET Core and .NET Framework coexist well together on the same PC.\n\n## Open source, the cloud, and cross platform\n\nThe .NET Framework was an audacious, comprehensive step forward. It has served us very well in the 20 years since it was introduced. Since its introduction, it’s been through at least ten major revisions. Alas, time marches on. As the market needs shift, new technologies arise to meet new challenges.\n\nIn 2012, Microsoft signaled a huge strategic shift by [announcing that it released ASP.NET MVC (and a few other Web-related technologies, including Razor pages) as open-source products](https://weblogs.asp.net/scottgu/asp-net-mvc-web-api-razor-and-open-source). This marked the first time ever that developers outside of Microsoft could not just see Microsoft source code, but also submit patches and code contributions to these open-source products.\n\nThen, in 2014, Microsoft announced the creation of the [.NET Foundation](https://dotnetfoundation.org/), an independent organization for the development and collaboration of open-source technologies for .NET. ASP.NET, Entity Framework. WebApi, [Nuget](https://www.nuget.org/), and even C# and VB compilers were open sourced through the .NET Foundation.\n\nThe new .NET\n------------\n\nLater in 2014, also through the .NET Foundation, Microsoft announced .NET Core 1.0, the follow-on to .NET Framework. .NET Core, out of the gate, supported Windows, Linux, and the Mac. It is a group of languages, runtimes, and libraries that coalesced .NET Framework, the [Mono Project](https://www.mono-project.com/) (an open-source version of .NET for Linux), and [Xamarin](https://dotnet.microsoft.com/en-us/apps/xamarin) (an open-source Android/iOS mobile platform) into a single, cohesive cross-platform solution that enables building applications for:\n\n*   Web\n*   Mobile\n*   Desktop\n*   Microservices\n*   Gaming\n*   Machine learning\n*   Cloud\n*   Internet of Things\n\nFor nearly six years, Microsoft doggedly pushed .NET Core through three versions to provide the stability, cross-platform tooling, and features it needed to make the deliverable live up to the vision and dream. In the fall of 2020, .NET Core 3.1 was the break-out release that proved that Microsoft’s dreams with the new .NET Core were approaching reality and quite nearly for the enterprise.\n\nFigure 2 below shows a highly abstracted view of the .NET Core stack. From an architectural level, .NET Core is generally very much like .NET Framework (compare Figure2 to Figure 1b). It has a top-level stack of \"enablers,\" its own .NET Core Base Class Library, and its own Common Language Runtime. At a high level, the .NET Core architecture was similar to that of the .NET Framework. A substantial difference between the two stacks is that the .NET Framework targets specifically, and works only on, Windows; out of the gate the new .NET Core stack worked on Windows, Linux, and macOS (Mac) operating systems but would also later add Android, iOS, tvOS, and watchOS support to the mix.\n\n![An abstracted view of the multi-platform .NET Core stack.](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/dot-core-stack.png)\n\nFigure 2. An abstracted view of the multi-platform .NET Core stack.\n\nAnother way .NET Core is different from .NET Framework, and one of reasons Figure 2 is abstracted, is that .NET Core is substantially more compartmentalized than .NET Framework. Where .NET Framework is (mostly) a monolith that includes code for nearly _everything_ it might ever need to do, .NET Core is more à la cart. That is, many of its components aren’t included in the initial package but can be added as needed through [Nuget](https://www.nuget.org/). [See this article](https://learn.microsoft.com/en-us/nuget/what-is-nuget) for Nuget details. For example, the [Microsoft.Data.SqlClient](https://www.nuget.org/packages/Microsoft.Data.SqlClient) Nuget package provides enhanced features and capabilities over the original `System.Data.SqlClient.` Distributing this new client through Nuget enables Microsoft to make improvements to that driver, and make those improvements available to users, independent of the release cadence .NET Core itself.\n\n> Although .NET Core targets multiple operating systems, .NET Core does offer some Windows-specific features. For example, .NET supports Windows Forms, but only on Windows.\n\nIn addition to all of .NET Core’s new features, it’s also notable for what it did not bring forward. Initially WPF (Windows Presentation Foundation, an alternative to Windows forms), WCF (Windows Communication Foundation), and ASP.NET WebForms were not supported by .NET Core. WPF was added to .NET with .NET Core 3.0 and recently WFC was given a new lease on life (with some architectural changes) with the [CoreWCF](https://devblogs.microsoft.com/dotnet/corewcf-v1-released/) project. Alas, ASP.NET WebForms received no such reprieve and is not (and by all accounts) will not be a part of .NET Core. (More on what this means to WebForms developers in a moment.)\n\nMicrosoft’s shifts to open source had many cynics and naysayers. However, in 2023 Microsoft is [second in the list of worldwide companies making open-source contributions](https://opensourceindex.io/). Microsoft has three times more active open-source contributors that IBM. It is very clear that Microsoft is very serious about its cross-platform, open-source initiatives.\n\n> In an interview with the Chicago Sun-Times in June, 2001, Microsoft’s then CEO, Steve Ballmer said \"Linux is a cancer that attaches itself in an intellectual property sense to everything it touches.\" Now, 20 years later Microsoft is clearly very serious about the importance of open source and Linux compatibility.\n> \n> What changed? It’s hard to say for sure what changed. But, 20 years ago Microsoft’s primary revenue streams were Windows and Office Products. Today, those products are still important, but its cloud initiatives have grown to be a third of company’s revenues (and growing dramatically) and its Xbox-related gaming are also growing nicely. So, maybe Microsoft perceives these things as good hedge/replacement balance sheet line items. Also, while Ballmer did advocate heavily for the cloud, during his tenure Microsoft’s stock price fell 32%. After Ballmer left the new CEO, Satya Nadella, immediately started dramatically reforming Microsoft and [growing its stock value 600%](https://www.cnbc.com/2021/06/24/microsoft-closes-above-2-trillion-market-cap-for-the-first-time.html) while doing so.\n\nNo Framework left behind\n------------------------\n\nDespite being all-in on .NET Core, Microsoft knows that the .NET Framework has millions of worldwide users. With the first release of .NET Core 1.0, Microsoft pledged then, and continues to pledge, that .NET Framework 4.8 remains very much a supported platform. It receives bug/security fixes and will continue to be distributed with future releases of Windows. The statement of support isn’t just altruistic, Windows itself has a substantial .NET Framework dependence. [The short, clear promise from Microsoft](https://dotnet.microsoft.com/en-us/platform/support/policy/dotnet-framework) is: As long as it is installed on a supported version of Windows, .NET Framework 4.8 will be supported.\n\nFor current ASNA customers using our .NET Framework-based products, there is a clear take-away: All versions of the .NET Framework under version 4.6.1 are deprecated and no longer supported. All ASNA customers using our .NET Framework-based products should set a course to upgrade to .NET Framework 4.7x or 4.8x as soon as possible.\n\nWhat’s in a name?\n-----------------\n\nWhen planning the release of what had been planned to be .NET Core 4.0, Microsoft determined it was brewing itself a big naming problem. Being firmly committed to supporting .NET Framework 4.8, Microsoft was concerned that customers would find both a \".NET Framework 4.8\" and a \".NET Core 4.0\" confusing. Two things were done to try to resolve that confusion:\n\n1.  Microsoft skipped version 4.0 of .NET Core and went from 3.1 directly to 5.0.\n2.  Perceiving that the word \"Core\" was also troublesome, Microsoft dropped the word \"Core\" from the naming.\n\nThese changes made .NET 5.0 the follow-on to .NET Core 3.1. The marketing wizards who thought that \".NET Framework 4.8\" and a \".NET Core 4.0\" would be confusing, also thought that having \".NET Framework 4.0\" and a \".NET 5\" would be crystal clear. The issue that they ignored was that for 20 years the names \".NET Framework\" and \".NET\" were used interchangeably to refer to the only .NET available, .NET Framework. This leaves us today with one .NET version with a qualifying name (.NET Framework) and one without (.NET). From this point forward, whenever you hear or read \".NET\" you need to carefully consider the context to ensure you know which .NET platform that \".NET\" references.\n\n> [Scott Hanselman](https://youtu.be/bEfBfBQq7EE?t=49) on .NET naming: \"It’s not the best name, but it’s the name we have.\" By the way, this video referenced by Hanselman provides a concise, clear definition of .NET.\n\nAn example of this naming fiasco that hits ASNA very close to home is the formal, registered name of our .NET Framework-based RPG compiler: ASNA Visual RPG for .NET: Visual RPG targets .NET Framework exclusively, not what is now formally known as .NET. We have hundreds of references to \"Visual RPG for .NET\" on our website! (We originally wanted to name our product \"ASNA Visual RPG .NET\" but Microsoft insisted on us injecting the \"for.\" Its argument was that its customers would be confused by a \"Visual Basic .NET\" and a \"Visual RPG .NET.\") We aren’t formally changing ASNA Visual RPG for .NET’s name (just as Microsoft appears to not be changing Visual Basic for .NET’s name), but we are calling \"ASNA Visual RPG for .NET Framework\" in several places on the Website. For future content, we’ll try to always append \"Framework\" to avoid any confusion.\n\nFigure 3 below shows a .NET family timeline. It skips showing .NET Core 3.0. .NET Core 3.0 was a notable improvement over .NET Core 2.0 but a mere three months after releasing it Microsoft released .NET 3.1. .NET 3.1 is generally considered the version where .NET Core got real–where it was something well beyond an extended R&D exercise.\n\n![A Microsoft .NET family timeline](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/microsoft-net-family-timeline.png)\n\nFigure 3. A Microsoft .NET family timeline\n\nFigure 3 reveals another subtle problem with the .NET naming. The introduction of .NET Core 1.0 represents a _major_ shift from the .NET Framework–it was a ground-up new product over .NET Framework. A casual observer could easily look at Figure 3 and assume that the introduction of .NET 5 (missing \"Core\" in its moniker) also represents a major shift from what it replaced. That isn’t the case. .NET 5 is to .NET Core 3.1 what .NET Core 3.1 is to .NET 3.0 Core–the incremental progression from one version to the next. When you see .NET 5, keep in mind that it is effectively .NET Core 4.0 with a streamlined name.\n\n.NET has a [fixed, annual release schedule](https://dotnet.microsoft.com/en-us/platform/support/policy/dotnet-core). In the late fall of each year, a refreshed version of .NET is released. Even years are Long Term Service (LTS) versions (supported for 36 months) and odd years are Standard Term Support (STS) versions (supported for 18 months). There is an important, subtle implication here: another of .NET’s \"features\" is that Microsoft pushes you harder to keep things upgraded.\n\nWhat does this mean for ASNA?\n-----------------------------\n\nASNA started migrating IBM i RPG applications to .NET Framework in 2005. We have tons of experience with that and a full migration and analytic suite that automates more than 95% of the migration. Migrations have become a large part of our business model and our first move into the new .NET arena is with our Monarch and Synon Escape products. After many hard months of work, today both products target .NET 6 and 7.\n\nAs for ASNA Visual RPG, Wings, and Mobile RPG, all of which target the .NET Framework, we remain committed to these products. We will continue to update them to keep them current with the latest versions of Visual Studio. Given Microsoft’s strong commitment to persisting the .NET Framework well into the future, these products have a long future ahead of them."
        }
    },
    {
        "dirent": {
            "name": "browsers-supported.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Browsers and mobile clients supported for ASNA products",
                "description": "Browsers and mobile clients supported for ASNA products.",
                "tags": [
                    "mobile-rpg",
                    "monarch",
                    "synon-escape",
                    "visual-rpg",
                    "wings"
                ],
                "date_published": "2024-01-09T12:29:30.000Z",
                "date_updated": "2024-01-09T18:44:45.000Z",
                "date_created": "2024-01-09T18:44:45.000Z",
                "pinned": false
            },
            "content": "\nOur general recommendation is to use the latest editions of:\n\n*   Chrome\n*   MS Edge\n*   FireFox\n*   Safari\n\nChrome and MS Edge are both based on the open-source Chromium engine. There are many other Chromium-based browsers (including Brave, Opera, and Vivaldi) and you may get a good user experience with these other Chromium-based browsers.\n\nMS Internet Explorer went out of support in 2022 and we no longer test with it or recommend its use.\n\n#### More details\n\nFor any platform, you’ll get the best results with browsers that support the latest HTML/CSS/JavaScript standards. These standards are updated very frequently so it’s very important to keep your developer and end-user browsers current.  We define current as: no more than 12 months old. We strongly recommend that you use current browsers. Not only are do they support the latest APIs but they are better protected against security issues. The automated update facilities of most browser families today make it easy to stay current.\n\nWings, Mobile RPG, Monarch, Synon Escape, and BTerm all use a great deal of JavaScript and CSS. We aren’t early adopters of any client-side technology, but do adopt features we deem very useful once a feature reaches critical mass. For example, JavaScript’s ES 6 specification added [import](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import) and [export](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export) (three years ago) which enable using modules. This enables more reliable and more easily tested JavaScript. When support for these modules fanned out [to the current release of all of the major browsers](https://caniuse.com/#search=javascript%20modules) we adopted these features.\n\n#### Other platform notes\n\n**Tablets**\n\nWings, Mobile RPG, Monarch, Synon Escape, and BTerm all have affinity for the native browsers on Apple (Safari), Android (Chrome), and Microsoft Surface (Edge). Other browsers may work on tablet devices but test thoroughly. As with desktop browsers, the older the tablet the more questionable its support is. It’s best to stick with current tablets and operating systems.\n\nThis desktop browser recommendation applies primarily to Wings, Mobile RPG, Monarch, Synon Escape, and BTerm.\n\n**Smartphones**\n\nASNA Mobile RPG specifically targets tablets and smartphones. Its tablet requirements are listed in the paragraph above. Like our tablet support, Mobile RPG has affinity for the native browsers on Apple (Safari), Android (Chrome), and Microsoft Surface (Edge). Other smartphone browsers may work with Mobile RPG but test thoroughly. As with desktop browsers, the older the smartphone the more questionable its support is. It’s best to stick with  current smartphones and operating systems. Please note that we do not recommend using Wings, Monarch, Synon Escape, and BTerm with smartphones.\n\nThis smartphone browser recommendation applies primarily to Mobile RPG.\n\n**ASNA Visual RPG**\n\nUnlike Wings, Mobile RPG, Monarch, Synon Escape, and BTerm, ASNA doesn’t provide any CSS or JavaScript to use with ASNA Visual RPG (AVR). You write the CSS or JavaScript used with AVR apps, so you get to dictate the requirements. Having said that, as we’ve said above, you’ll have the most success with your AVR Web applications (and the modern technologies you’ll need) using current browsers."
        }
    },
    {
        "dirent": {
            "name": "finding-build-version-numbers.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to determine ASNA product versions",
                "description": "This article explains where to find your ASNA product number and build versions. ",
                "tags": [
                    "licensing"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T05:16:49.000Z",
                "date_created": "2024-01-10T05:16:49.000Z",
                "pinned": false
            },
            "content": "\nWhen you report an issue to ASNA tech support, or when you need a new or updated product license key, we’ll usually need to know your exact product version(s).\n\n## Windows-based products\n\nVisual Studio has an \"about\" that shows some license information, but the ASNA licensing information that that dialog shows isn’t detailed enough.\n\nThe best way to see what versions of ASNA software you have installed is to use Windows \"Programs and Features\" list launched from the Windows Control Panel (on either a desktop PC or a Windows server). That displays a list like the one shown below:\n\n![ALT NEEDED](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/asna-programs-features-2.png)\n\nProduct names are shown in the \"Name\" column and the version number we need is in the \"Version\" column.\n\nIt’s important to launch \"Programs and Features\" from the Control Panel to see this information. There are many ways to launch this applet:\n\n*   Press Windows-X, and select \"Programs and Features\" at the top of the list\n*   Press Windows-R (to launch the run command line window) and type \"appwiz.cpl\"\n*   Open the Control Panel, select Programs, and then select Programs and Features\n\n## DataGate on the IBM i\n\n[This article shows how to determine what version of DataGate you’re running on your IBM i.](/en/kb/get-datagate-library-name)\n"
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-dclaliasgroup.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR for .NET arrays: using DclAliasGroup",
                "description": "This article explains how to use DclAliasGroup to map record format fields to an array with Visual RPG.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:57:42.000Z",
                "date_updated": "2024-01-09T18:01:56.000Z",
                "date_created": "2024-01-09T18:01:56.000Z",
                "pinned": false
            },
            "content": "\nThis final array article in this series is a specialized tip, but when needed it is very handy to have available.\n\nIn AVR Classic you could use data structures to overlay incoming values from a disk file record buffer into other values, structures, or arrays. Overlapping array techniques with packed and binary data is troublesome in .NET (because .NET doesn’t have the concept of field values being mapped contiguously in memory like AVR Classic and green-screen RPG do). The `DclAliasGroup` operation helps to remove the pain of mapping an incoming record buffer to an array.\n\nFor example, consider the following record format. It has twelve monthly account balance values in fields `CSSales01` through `CSSales12`. When this record is read, you want to implicitly map these 12 record format fields into an array.\n\n```\n----------------------------------------------------------------\n    CSMasterL1 file layout.\n----------------------------------------------------------------\n    Database name... DG Net Local\n    Library name.... Examples\n    File name....... CSMasterL1\n----------------------------------------------------------------\n    CSCustNo    *Packed  Len(  9,  0) Customer Number\n    CSYear      *Zoned   Len(  4,  0) Sales Year\n    CSType      *Zoned   Len(  1,  0) 1 = sales 2 = returns\n    CSSales01   *Packed  Len( 11,  2) Sales Month 01\n    CSSales02   *Packed  Len( 11,  2) Sales Month 02\n    CSSales03   *Packed  Len( 11,  2) Sales Month 03\n    CSSales04   *Packed  Len( 11,  2) Sales Month 04\n    CSSales05   *Packed  Len( 11,  2) Sales Month 05\n    CSSales06   *Packed  Len( 11,  2) Sales Month 06\n    CSSales07   *Packed  Len( 11,  2) Sales Month 07\n    CSSales08   *Packed  Len( 11,  2) Sales Month 08\n    CSSales09   *Packed  Len( 11,  2) Sales Month 09\n    CSSales10   *Packed  Len( 11,  2) Sales Month 10\n    CSSales11   *Packed  Len( 11,  2) Sales Month 11\n    CSSales12   *Packed  Len( 11,  2) Sales Month 12\n```\n\nThe array below is the target array into which we want to put each of the twelve monthly fields:\n\n```\nDclArray    MonthlyTotals  Type(*Packed) +\n                            Len(11, 2)    +\n                            Dim(12)\n```\n\nThis line of AVR for .NET (defined in the code right after the `DclArray`) causes the automatic mapping of the fields into the array—implicitly each time a record is read:\n\n```\n    DclAliasGroup MonthlyTotals             +\n                  Flds(SalesDtls_CSSales01) +\n                  Fmt(SALESFORMAT)          +\n                  Count(12)\n``` \n\nWith the target array and the `DclAliasGroup` declared, the twelve monthly balance fields are moved implicitly into the `MonthlyTotals` array after the record format is read. After a read operation, fields `CSSales01` through `CSSales12` values are in `MonthlyTotal's` elements 0 through 11, respectively.\n"
        }
    },
    {
        "dirent": {
            "name": "licensing-datagate-for-ibm-i.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Licensing DataGate for IBM i 16.x and up",
                "description": "Licensing DateGate for IBM i now requires the IBM i partition number. Here's how to get the information needed to license ASNA DataGate for IBM i 16 and higher. ",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2024-01-04T14:59:52.000Z",
                "date_updated": "2024-01-04T23:33:06.000Z",
                "date_created": "2024-01-04T23:33:06.000Z",
                "pinned": false
            },
            "content": "<script>\n    import Image from \"$components/text-decorators/Image.svelte\"\n</script>\n\n>This article applies to DataGate for IBM 16.0 and higher\n\nASNA DataGate for IBM i 16.x introduced a license registration change. Starting with 16.x, the license now includes the IBM i partition number (LPAR). While there isn't a direct way to see this value on your IBM i, there is an easy, indirect way.  These steps are all read-only and don't change anything on your IBM i. \n\nFirst, from the IBM i command line:\n\n```\nCALL QCMD\n```\nThen, from the QCMD panel:\n\n```\nCALL QSYS/QLZARCAPI\n```\nWhich shows this display:\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/qlzarcapi-2.png\" alt=\"Using IBM's qlzarcapi API\" width=\"600\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nThe Partition ID is in the`Partition Info->` area, about four or five lines down (shown in Figure 1 above in the red box).\n\nWe'll also need your IBM serial number. Get it with:\n\n```\nDSPSYSVAL QSRLNBR\n```\nand your IBM i model number. Get it with:\n\n```\nDSPSYSVAL QMODEL\n```\n## Getting your license\n\nContact us and provide us with:\n\n- Company name\n- DataGate version number\n- IBM i model number\n- IBM i serial number\n- IBM i partition number (the red box in the image below)\n- User Count\n\nand we'll generate a license for you.\n\n## Applying the license\n\nA apply the license with this command:\n\n`[Library]/register`\n\nwhere  `[library]` is the name of your DataGate library.\n\nThat displays the screen below shown in Figure 2:\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/dg16-x-ibmi-register-1.png\" alt=\"Applying a DataGate license on the IBM i\" width=\"600\" alignment=\"center\" caption=\"Figure 2.\"/>\n\nAs an aside, notice the the red box above in the Registration Assistant panel shows the Partition ID. \n\n> A big thank you to Matt Marsh at The Walt Disney Company for bringing the QLZARCAPI API to our attention and a big thank you to Simon Hutchinson for writing about the API at his blog [RPGPGM.com.](https://www.rpgpgm.com/2017/03/system-partition-and-processor-pool.html)\n\n"
        }
    },
    {
        "dirent": {
            "name": "chrome-blocking-exe-download.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Stop Chrome from blocking \"insecure\" ASNA EXE downlaods",
                "description": "All ASNA download exe files are signed, and have been for years, but a recent Google Chrome update now marks our exe downloads as insecure. Note that, Microsoft Edge (as of build 131.0.2903.112), allows ASNA exe downloads with its strictest security settings.",
                "tags": [
                    "asna-web-site"
                ],
                "date_published": "2025-01-05T00:00:00.000Z",
                "date_updated": "2025-01-05T00:00:00.000Z",
                "date_created": "2025-01-05T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\nimport Image from \"$components/text-decorators/Image.svelte\";\nimport ContactUs from '$components/all-locales/all-pages/ContactUs.svelte';\nimport Callout from \"$components/text-decorators/Callout.svelte\"\n</script>\n\n\nAll ASNA download `exe` files are signed, and have been for years, but a \nrecent Google Chrome update, on some Windows PCs, now marks our `exe` downloads as insecure. Note that Microsoft Edge (as of build 131.0.2903.112), allows ASNA `exe` downloads with its strictest security settings. \n\nThere isn't anything dangerous about our `exe` files; Chrome is erroneously reporting a false positive with its security test. Until we can convince Google otherwise, the workaround to download ASNA `exe` files with Google chrome is:\n\n1. Click the link you were emailed to download the file. \n\nThe file may download successfully, but if it doesn't, continue with: \n\n2. After getting the message that the file was \"dangerous\" press Ctrl+J to shown Chrome's download list. The `exe` you tried to download will be at the top of the list. Click the vertical ellipsis to the right of the file name.\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/images/chrome-download-fig-1.png\"\nalt=\"Figure 1a. Opening Chrome's custom flag settings\"\nwidth=\"100%\" alignment=\"center\" \n/>\n\n3. Select \"Download dangerous file\" (again, this file isn't dangerous).\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/images/chrome-download-fig-2.png\"\nalt=\"Figure 1a. Opening Chrome's custom flag settings\"\nwidth=\"100%\" alignment=\"center\" \n/>\n\n4. Click the \"Download dangerous file\" button. The file will download to your PC. For your piece of mind, you can scan the downloaded file with your virus checker. This is very easy to do with Microsoft Defender; right-click the file and select \"Scan with Microsoft Defender.\"\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/images/chrome-download-fig-3.png\"\nalt=\"Figure 1a. Opening Chrome's custom flag settings\"\nwidth=\"100%\" alignment=\"center\" \n/>\n\nAlternatively, use Microsoft Edge to download `exe` files from ANSA.com. Even with its security settings set to \"strict\" MS Edge successfully downloads the file. (MS Edge is installed by default on all Windows 10/11 PCs.)"
        }
    },
    {
        "dirent": {
            "name": "dg8svcprf-user-profile.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "What is the IBM i user profile DG8SVCPRF used for?",
                "description": "The DG8SVCPRF user profile is used by ASNA DataGate's DG8SVC service job to start new DataGate end-user jobs. ",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-01-05T12:35:56.000Z",
                "date_updated": "2024-01-05T18:40:06.000Z",
                "date_created": "2024-01-05T18:40:06.000Z",
                "pinned": false
            },
            "content": "\n## Question\n\nWhat is the IBM i DG8SVCPRF used for?\n\n## Answer\n\nWhen an application requests a DataGate job on the IBM i, the ASNA DG8SVC initiates that job through an ASNA DG8\\_START job. DG8\\_START jobs run under the DG8SVCPRF user profile. Once DG8\\_START gets user credentials from the DataGate client, it adopts authority of the incoming user profile and then submits a DG8\\_NET job for the application. DG8\\_START then fades back into the background awaiting a another application request. Note that prior to DataGate 16.x, DG8\\_START jobs were spun up on demand; with DataGate 16.x three (by default) DG8\\_START jobs persist. (See            [this article](/en/kb/understanding-datagate-for-ibm-i-service-jobs)            for details on DataGate IBM i jobs).\n\nThe DG8SVCPRF user profile is created during DataGate installation (if it doesn't already exist). If the DataGate service job has trouble starting a job, a one-page report outlining the possible cause of the problem will be generated for the user DG8SVCPRF and printed to the assigned printer. This report will not print unless the Output Queue associated with this printer automatically prints the generated reports. Otherwise, to view the list of reports that have not printed for this user, enter the following command:\n\n```\nWRKSPLF SELECT(DG8SVCPRF)\n```\nAnytime you have issues with ASNA DataGate, taking a look at DG8SVCPRF's spool file is a good place to start."
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-basics.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR for .NET arrays: the basics",
                "description": "This article explains how to use arrays in ASNA Visual RPG. It looks at fixed-sized arrays. Both single- and multi-dimensional arrays are covered.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:10:39.000Z",
                "date_updated": "2024-01-09T17:36:05.000Z",
                "date_created": "2024-01-09T17:36:05.000Z",
                "pinned": false
            },
            "content": "\nStoring data in arrays is a key way to implement effective and efficient algorithms. This article series takes a look at the different ways you can use arrays in AVR for .NET.  This article explains AVR for .NET array basics.\n\nAVR for .NET substantially ramps up array capabilities over what AVR Classic offered. Briefly, the changes include:\n\n*   All arrays in AVR for .NET are zero based (ie, the first element is always the zeroth element)\n*   Arrays can be declared globally in a class or locally to a function or subroutine\n*   You don’t have to specify the number of elements in an array when you declare it\n*   Arrays can be passed as arguments to subroutines and functions\n*   Arrays can be returned as a function result\n*   Single-dimensioned array contents can be specified when you declare the array\n*   Arrays can be ragged\n*   Arrays are objects and have methods and properties\n*   Array contents can be traversed with the For/Each construct\n\nAll arrays in AVR for .NET are zero-based. The first element _always_ occupies the zeroth position. This is very much unlike arrays in AVR Classic; they are one-based.\n\n#### Declaring fixed-sized arrays\n\nThe following declaration declares a four-element array of strings:\n\n```\nDclArray myArr Type(*String) Dim(4)\n```\n\nYou would populate this array like this:\n\n```\nmyArr[0] = \"Neil\"\nmyArr[1] = \"Young\"\nmyArr[2] = \"Van\"\nmyArr[3] = \"Morrison\"\n```\n\nNotice that the first element occupies the zeroth position. In AVR for .NET, you can use either parentheses () or brackets \\[\\] to indicate the array subscript. However, although either is allowed, the brackets are the preferred method (so as to more quickly denote an array subscript over a method call).\n\nExcept for being zero-based, declaring fixed-sized arrays in AVR for .NET provides arrays that are very similar to the arrays that AVR Classic offered. However, .NET also has a dynamically sized array (known as a `ranked array`). AVR for .NET’s ranked array is covered in part two of this series. You see, there another reason to always use brackets \\[\\] to indicate array subscripts.\n\n#### AVR avoids VB.NET’s array mistake\n\nAVR avoids the confusing mistake VB.NET made with declaring arrays. For example, the following line is a VB.NET array declaration:\n\n```\nDim x(4) as Integer\n```\n\nThis VB declaration creates an array with, not four, but five(!) array elements. In VB.NET, the subscript value provided declares the array’s upper bounds, not the number of elements in the array.\n\nThe corresponding code in AVR for .NET would be:\n\n```\nDclArray x Type(*Integer4) Dim(5)\n```\n\nIn AVR for .NET (as in C#), array declarations declare the number of elements in the array, not the array’s upper bounds.\n\n#### Declaring multi-dimensioned arrays of known size\n\nTo declare arrays of fixed size with multiple dimensions, you specify the dimensions in the `Dim()` keyword. For example, this code\n\n```\nDclArray MyArr Type(*Integer4) Dim(4, 2)\n```\n\ndeclares an array with four rows and two columns. Figure 3 shows how this array looks in the QuickWatch window.\n\n![Visual Studio debugger showing a multi-dimensional fixed-size array](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/array-basics-01.png)  \n\nFigure 1a. Visual Studio debugger showing a multi-dimensional fixed-size array.\n\nUse this code to assign a value to row 2, column 1:\n\n```\nMyArr[2,1] = 77  \n```\n\n![Visual Studio debugger showing a value having been assigned to row 2, column 1](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/array-basics-02.png)\n\nFigure 1b. Visual Studio debugger showing a value having been assigned to row 2, column 1.\n\nYou can have more than two dimensions, if you need. For example, to model a Rubik’s cube, you could use an array declared like this:\n\n```\nDclArray RubiksCube Type(*Integer4) Dim(3,3,3)\n```\n\nThere is no practical limit to the number of array dimensions you can declare, but anything more than three dimensions should only be attempted by certified lunatics.\n\nIn Part 2, we’ll examine AVR for .NET’s dynamically-sized ranked arrays."
        }
    },
    {
        "dirent": {
            "name": "dynamic-db-name.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Change an app's DB name at runtime without recompiling",
                "description": "This article provides a way to change your ASNA Web or Windows application’s runtime database name without recompiling or redeploying the application.",
                "tags": [
                    "dot-net-framework",
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T03:38:27.000Z",
                "date_created": "2024-01-10T03:38:27.000Z",
                "pinned": false
            },
            "content": "I’ve seen some crazy code lately that enables the ability to change an application’s database name at runtime. Much of the code I’ve seen makes this way harder than it needs to be. This article provides a simple way to be able to dynamically change your Web or Windows application’s runtime database name without recompiling or redeploying the application.\n\nNote that while this article is database name-specific, the same concept can be applied to any application value that you need to be able to change easily at runtime.\n\n### ASP.NET example\n\nLet’s say you have two database names available:\n\n*   A database name for the ASNA Win/Server desktop database for a development named “\\*Public/DG NET Local.”\n*   A database name for DataGate for IBM i for production named “\\*Local/Cypress.”\n\nYou’d like to develop with the local database but when pushed to production you’d like to use the IBM i database name–without needing to recompile the application.\n\n#### Specifying database names in the `web.config` file\n\nIn your ASP.NET web app’s `web.config` file add the three `appSettings` key-value pairs shown below.\n\n*   The `dev` key provides the local database’s database name.\n*   The `prod` key provides the production database’s name.\n*   The `activeDBName` provides the runtime database name. It is currently set to `dev`.\n\nAt runtime, first the `activeDBName` key-value is looked up, and then its value is used to read the database name of the specified environment. This database name overrides the AVR database object database name at runtime.\n\n#### The ASP.NET code-behind\n\nTo hook up the code, add a reference to `System.Configuration` and add a `using` statement for it.\n\n```\nUsing System.Configuration\n\nBegClass views_TestDBConnection Partial(*Yes) Access(*Public) Extends(System.Web.UI.Page)\n\n    // This is the compile-time database name.\n    DclDB DGDB DBName(\"*Public/DG8_160x\") \n\n    DclDiskFile Customer +\n            Type(*Input) + \n            Org(*Indexed) + \n            Prefix(Customer_) + \n            File(\"examples/cmastnewl2\") +\n            DB(DGDB) +\n            ImpOpen(*No)  \n\n    BegSr Page_Load Access(*Private) Event(*This.Load)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        DclFld ActiveDBKey Type(*String) \n\n        ActiveDBKey = ConfigurationManager.AppSettings['activeDBName']\n\n        // Override runtime database name.\n        DGDB.DBName = ConfigurationManager.AppSettings[activeDBKey]\n\n        Connect DGDB \n\n        If (NOT Page.IsPostBack)\n            //\n            // Called the first time that the page is loaded.\n            //\n        Else\n            //\n            // Called subsequent times that the page is displayed.\n            //\n        EndIf\n    EndSr\n\n    BegSr Page_Unload Access(*Private) Event(*This.Unload)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        Disconnect DGDB \n    EndSr\n\nEndClass\n```\n\nIn the page’s `Load` event-handling code, this code:\n\n```\nDclFld ActiveDBKey Type(*String) \n\nActiveDBKey = ConfigurationManager.AppSettings['activeDBName']\nDGDB.DBName = ConfigurationManager.AppSettings[activeDBKey]\n\nConnect DGDB \n```\n\nLooks up the active database name key and uses that value to read the corresponding database name from the `web.config` file. That name is then assigned to the AVR database object before it is connected.\n\n## Windows example\n\nThe Windows version to add dynamic database names is very similar.\n\n## Specifying database names in the `app.config` file\n\nFrom the Solution Explorer, use Add New Item to add an “Application Configuration File”, as shown below. Change the default file name to `app.config` (`app1.config` will not work) and click the ‘Add’ button.\n\n![ALT NEEDED](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/web-config-add-new-item.png)\n\nAdd the `appSettings` `dev`, `prod`, and `activeDBName` keys just as we did for the Web example.\n\n## The Windows code-behind\n\nTo hook up the code, add a reference to `System.Configuration` and add a `using` statement for it.\n\n```\nUsing System.Configuration\n\nBegClass Form1 Extends(System.Windows.Forms.Form) Access(*Public) Partial(*Yes)\n\n    /region Default Constructor\n\n    BegConstructor Access(*Public)\n        //\n        // Required for Windows Form Designer support\n        //\n        InitializeComponent()\n\n        //\n        // TODO: Add any constructor code after InitializeComponent call\n        //\n    EndConstructor\n\n    /endregion\n\n    // This is the compile-time database name.\n    DclDB DGDB DBName(\"*Public/DG8_160x\") \n\n    DclDiskFile Customer +\n            Type(*Input) + \n            Org(*Indexed) + \n            Prefix(Customer_) + \n            File(\"examples/cmastnewl2\") +\n            DB(DGDB) +\n            ImpOpen(*No)  \n\n    BegSr Form1_Load Access(*Private) Event(*this.Load)\n        DclSrParm sender *Object\n        DclSrParm e System.EventArgs\n\n        DclFld ActiveDBKey Type(*String) \n\n        ActiveDBKey = ConfigurationManager.AppSettings['activeDBName']\n\n        // Override runtime database name.\n        DGDB.DBName = ConfigurationManager.AppSettings[ActiveDBKey]\n\n        Connect DGDB \n    EndSr\n\n    BegSr Form1_FormClosing Access(*Private) Event(*This.FormClosing)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.Windows.Forms.FormClosingEventArgs)\n\n        // Occurs when form is closing.    \n        // Put form \"housecleaning\" code here (ie close files).\n\n        Disconnect DGDB \n    EndSr\n\nEndClass\n```\nIn the form’s `Load` event-handling code, this code:\n\n```\nDclFld ActiveDBKey Type(*String) \n\nActiveDBKey = ConfigurationManager.AppSettings['activeDBName']\nDGDB.DBName = ConfigurationManager.AppSettings[activeDBKey]\n\nConnect DGDB \n```\n\nLooks up the active database name key and uses that value to read the corresponding database name from the `app.config` file. That name is then assigned to the AVR database object before it is connected.\n\n## Windows caveat\n\nWhen a Windows app is compiled that has an `app.config` file, that file is copied to the target `bin` folder as `<ProjectName>.exe.config.` Runtime changes to `appSettings` values need to be made to this file, not the `app.config` file.\n\nFor example, if your project name is `DynamicDB` and it is compiled as a debug release, after compiling the project there will be a `DynamicDB.exe.config` file in the project’s `bin\\debug` folder. Be sure to deploy this file in the same folder where you put the EXE. Changes made to this file will apply without recompiling the app.\n\n## Summary\n\nYou aren’t limited to two database names with this technique, you can specify as many database names as needed (for example, you specify `dev`, a `test`, a `production` and an `altproduction` databases. After the app is deployed you can change what database name the app uses by changing the value of the `activeDBName` key. No redeployment of the application is necessary. The change will be applied with a fresh request of the app.\n\nWhile this article is database name-specific, the same concept can be applied to any application value that you want to be able to change easily at runtime.\n"
        }
    },
    {
        "dirent": {
            "name": "kelly-software-license-keys.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Kelly Software and expired license keys",
                "description": "This article explains the situation of Kelly Software customers needing license keys for ASNA products.",
                "tags": [
                    "licensing"
                ],
                "date_published": "2022-09-24T00:00:00.000Z",
                "date_updated": "2022-09-24T00:00:00.000Z",
                "date_created": "2022-09-24T00:00:00.000Z",
                "pinned": false
            },
            "content": "This article is about ISV orphans. Although it references a now-defunct company in the US, it generally applies to any ASNA customer using software created by an ISV who is now out of business.\n\nAfter many years in business, Jack Kelly closed Kelly Software in January 2019. By then Kelly Software had discontinued all product maintenance with ASNA. Except in rare cases, Kelly Software customers didn't interact with us directly--you interacted with us indirectly through Kelly Software. Kelly Software would get license keys from us and send them to you (and may even have applied them for you). Now that Kelly Software is out of business, you need to request, receive, and apply license keys yourself. Kelly Software customers usually first come to our attention because an ASNA database license has expired. ASNA product license keys can expire when a PC or server changes. Changes can happen for several reasons, but the three most likely are:\n\n*   Windows updates\n*   Any hardware changes\n*   Moving to a different virtual machine\n\n### A little history and detail\n\nThe Kelly Software package was written with our Visual RPG 4.0 product. Visual RPG 4.0 was introduced in the mid-90s and is nearly 25 years old. It predates modern versions of Windows desktop and server products by decades. This product was retired in 2012. AVR 4.0 is not formally supported on:\n\n*   Windows 10/11 desktop products\n*   Windows Server version higher than Windows Server 2008 R2\n\nAVR 4.0 was replaced in 2012 with AVR 5.0, which does support Windows 8/10 and Windows Servers 2012 R2 and up. As a Kelly Software customer you are most likely using two ASNA software products:\n\n*   ASNA Visual RPG 4.0 runtime. This is the runtime component of the ASNA Visual RPG compiler Kelly Software used to create its software package.\n*   ASNA DataGate for Windows and Desktops. This is the database component of the Kelly Software package. Very early versions of this product were called ASNA Acceler8. This is probably the only ASNA software product you have licensed. Its license also applies to the ASNA Visual RPG 4.0 runtime.\n\n### Your best path forward when your ASNA product license expires\n\n#### If you expect to replace your Kelly Software package ASAP\n\nThis applies to most Kelly Software customers we talk to. For this group, we encourage you to take the most minimal steps necessary to push your Kelly Software over the finish line. Although your Kelly Software product was created with AVR 4.0 and that version doesn't formally support current versions of Windows desktops or servers, it may continue to work with them. We can't guarantee this, but we know that some customers say it does work; however, we also know some customers who say it doesn't work. If things were working before your license expired, it's quite likely you'll be fine. To get you back up and running, we'll issue you a free, 30-temp key for your ASNA database product. It's highly likely that will get you back up and running. If that temporary license works, you'll need to purchase a new permanent key. Keys are available in groups of:\n\n*   1 user\n*   5 users\n*   20 user\n\nKeys are only available in these quantities. If you need 30 users, you'll need to purchase one 20-user license and two 5-user licenses or two 20-user licenses whichever is the least expensive. Please contact ASNA at info@asna.com for current pricing. This price is a one-time charge. Without active product maintenance, if the keys expire again (usually because of Windows updates), you'll need to buy new keys. If you'd rather play it safe, please talk to an ASNA salesperson (once again, you can use info@asna.com for this) about establishing active product maintenance on your ASNA products. That will usually save you money over time (even over a year).\n\n#### If you hope to use your Kelly Software package for the foreseeable future\n\nIf you're in this group, first, we strongly encourage you not to be! Find an alternative software package and put yourself in the other group! The Kelly Software package is nearly 25 years old. It had a good run but it was written at a different time for different platforms. Please consider seriously looking for a replacement. Note that we don't have an agenda or a vested interest in you making this decision--we don't sell software packages. However, if you're a hard-head and say, \"Nope, gonna run it till the wheels fall off,\" read on. For database licensing, the licensing issues mentioned in the first group also apply to this group. If you intend to keep the Kelly Software for more than a year, you might at some point start to see software failures--because Visual RPG 4.0 doesn't support Windows 8 or 10, and the longer you continue to use Visual RPG 4.0, the more likely you are to have critical issues. If you do start to experience issues, you can upgrade to Visual RPG 5.0 or 5.1--which does support Windows 8 and 10 and Windows Servers 20012 R2 and up. To do this, you can:\n\n1.  **Do the upgrade yourself.** You can license a copy of AVR 5.0 and perform the upgrade yourself. This is a nerdy task and, while relatively simple, requires a solid knowledge of ASNA Visual RPG. You'll also need to fully test, and then redeploy, the recompiled application.\n2.  **Have us do the upgrade.** Our ASNA Services can, for a fee, perform this upgrade for you.\n\nIf you have the technical talent available, the first option may be viable. If you don't, you'll need to use the second option. Depending on your company size and your critical need for the application, the cost of the second option will either be worthwhile or you'll need to reconsider replacing the Kelly Software package.\n"
        }
    },
    {
        "dirent": {
            "name": "listview-asp-net-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Working with the ASP.NET ListView and row and column clicks",
                "description": "The ListView control is a worthly alternative to the GridView control. This article shows how to use the ListView control in your AVR for .NET Framework ASP.NET apps.",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T20:18:15.000Z",
                "date_created": "2024-01-11T20:18:15.000Z",
                "pinned": false
            },
            "content": "\n[See code on GitHub](https://github.com/ASNA/listview-row-col-clicked)\n\nThe [ListView](https://msdn.microsoft.com/en-us/library/bb398790.aspx) is a worthy alternative to the [GridView](https://msdn.microsoft.com/en-us/library/2s019wc0.aspx) control. With the ListView control, you are 100% in charge of the markup produced. This makes the ListView much better suited to pages where you need complete control over the markup, such as when you’re using a CSS framwork like BootStrap.\n\nHowever, the ListView’s model for determining row clicks is quite different from the GridView. This article shows how to determine what row and column got clicked with the ListView.\n\n#### The ListView’s OnItemCommand property\n\nThe OnItemCommand binds an event handler subroutine to the ListView’s OnItemCommand event. Unlike a GridView, the ListView’s internal controls (those defined in the ItemTemplate section) _do not_ fire their own intrinsic events. Instead, these controls events (which are usually click events) are channeled through the handler registered with the OnItemCommand. The OnItemCommand handler must include the two parameters shown below\n\n```\nBegSr listviewCustomersRowAction Access(*Protected) \n    DclSrParm sender Type(*Object)\n    DclSrParm e Type(ListViewCommandEventArgs)\n\n    DclFld CommandName Type(*String) \n    DclFld RowNumber Type(*Integer4)\n\n    CommandName = e.CommandName\n    RowNumber = Convert.ToInt32(e.CommandArgument)\n\n    // Do something here based on CommandName and RowNumber \nEndSr\n```  \nFigure 1. An example OnItemCommand handler  \n\n> There may be other ways to assign ListView’s OnItemCommand handler, but assigning the handler with the declarative OnItemCommand property is the technique that’s always worked for me.\n\n#### Identifying button and row clicked using CommandName and CommandArgument properties\n\nAll buttons (or other controls with \"click\" events) should specify a CommandArgument and CommandName in the markup. These two values are available in the OnItemCommand handler through its ListViewCommandEventArgs parameter. The CommandName easily indicates what control got clicked. It would be nice if there was an intrinsic way to determine what row got clicked–but there isn’t. However, the ordinal row number position is available through the `Container.DisplayIndex` property. Assign it as shown below in Figure 2:\n\n```\n    CommandArgument=\"<%# Container.DisplayIndex %>\"\n```    \n  \nFigure 2. Assigning the ordinal row number to the CommandArgument property.  \n\nThe ListView has seven special-case command names:\n\n*   Cancel\n*   Delete\n*   Select\n*   Edit\n*   Insert\n*   Update\n*   Sort\n\n[ASP.NET prescribes specific behaviors](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.itemcommand%28v=vs.110%29.aspx) for these seven command names. Any other command name is considered a custom command. I rarely use the built-in behaviors for the special-case command names and generally use custom command names. Don’t use any of the seven special-case command names for custom commands (ie, use \"updaterow\" instead of \"Update\" for a custom update command).\n\n#### Example ListView markup\n\nExample ListView markup is shown below in Figure 3. Using this markup along with the OnItemHandler shown in Figure 1 makes is easy to determine what button and row got clicked in a ListView control.\n            \n```\n<asp:ListView ID=\"listviewCustomers\" runat=\"server\" OnItemCommand=\"listviewCustomersRowAction\">\n    <LayoutTemplate>\n        <div class=\"row\">\n            <div class=\"col-sm heading\">\n                Name\n            </div>\n            <div class=\"col-md heading\">\n                City, State, Zip\n            </div>\n            <div class=\"col-sm heading\">\n                Actions\n            </div>\n        </div>        \n        <asp:PlaceHolder runat=\"server\" ID=\"itemPlaceholder\" />\n    </LayoutTemplate>\n\n    <ItemTemplate>\n        <div class=\"row\">\n            <div class=\"col-sm\">\n                <%# (Container.DataItem *As Customer).FirstName.Trim() ++ \n                    \" \" ++ \n                    (Container.DataItem *As Customer).LastName.Trim() %>\n            </div>\n            <div class=\"col-md\">\n                <%# (Container.DataItem *As Customer).City.Trim() ++ \n                    \" \" ++ \n                    (Container.DataItem *As Customer).State.Trim() ++ \n                    \" \" ++ \n                    (Container.DataItem *As Customer).ZipCode.ToString(\"00000\") %>\n            </div>\n            <div class=\"col-sm\">\n                <asp:LinkButton ID=\"linkbuttonUpdate\" class=\"btn btn-primary btn-tiny\" runat=\"server\" \n                     CommandArgument=\"<%# Container.DisplayIndex %>\" CommandName=\"updaterow\">Update</asp:LinkButton>\n                <asp:LinkButton ID=\"linkbuttonEmail\" class=\"btn btn-primary btn-tiny\" runat=\"server\" \n                     CommandArgument=\"<%# Container.DisplayIndex %>\" CommandName=\"sendemail\">Email</asp:LinkButton>\n            </div>                    \n        </div>\n    </ItemTemplate>\n</asp:ListView>        \n``` \n\nFigure 3a. Example ListView markup  \n\n![Example ListView control at runtime](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/listview-row-clicked.png)\n  \nFigure 3b. The ListView output generated from the markup in Figure 3a\n\n"
        }
    },
    {
        "dirent": {
            "name": "avr-classic-upgrade-guide.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR Classic upgrade guide",
                "description": "This article discusses upgrade strategies for ASNA Visual RPG Classic (our COM product).",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T12:29:30.000Z",
                "date_updated": "2024-01-09T18:37:41.000Z",
                "date_created": "2024-01-09T18:37:41.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Callout from '$components/text-decorators/Callout.svelte'\n</script>\n\nAVR Classic is ASNA’s original RPG compiler for Windows. Its core codebase is nearly thirty years old. Windows 7 (supported October 22, 2009 through January 14, 2020) introduced many internal changes over Windows XP that didn’t play well with AVR 4.x.\n\nIn 2012, we spent a lot of time moving our AVR 4.x code from a very old C++ compiler to the (then) latest MS C++ compiler. Recompiling AVR 4.x with this much newer compiler added stability and compatibility with Windows 7. We released this recompiled AVR Classic version as AVR 5.0. This was a lateral upgrade and beyond support for Windows 7/8, it didn’t add any new features to AVR Classic.\n\n> Microsoft retired Windows 7 on January 14, 2020 and Windows 8 on January 10, 2023. Neither is supported for use with any version of ASNA Visual RPG.\n\nWe’ve upgraded AVR 5.0 twice since its introduction. AVR 5.1 was introduced in 2018 and AVR 5.2 was released in 2023. AVR Classic 5.0 is retired and AVR Classic 5.1 and 5.2 are the two currently supported versions at the time of this article’s publication (October 2023). AVR 5.1/5.2 both support Windows 10/11. Like AVR 5.0, 5.1 and 5.2 are both lateral upgrades; they don’t add new programming features but both work with newer versions of Windows.\n\nIf you are using a version of AVR Classic below 5.1, we strongly recommend that you upgrade to either AVR 5.1 or 5.2.\n\n> What does \"retired\" mean? Retired means the product no longer receives updates or changes and that tech support is no longer available. Should you have a problem with a retired version AVR, you’ll need to upgrade to get it resolved. However, keys are available for retired versions of ASNA Visual RPG.\n\n \n<Callout icon=\"fa-solid fa-circle-exclamation\">\nASNA Visual RPG 4.x is known to have many unpredictable issues with Windows 10 and 11. AVR 5.1 and 5.2 are both compiled with more modern C++ compilers to resolve these issues. We don't recommend trying to use anything lower than AVR 5.1 with Windows 10/11.\n</Callout>\n\n### Check your DataGate version\n\nBefore upgrading your AVR instance, be sure to check your DataGate version. AVR 5.1 and 5.2 both require either DataGate 16 or 17. If you’re using a lower version of DataGate, you _must_ upgrade it before upgrading to AVR. 5.1/5.2.\n\nIf you do need to upgrade DataGate, we recommend you upgrade it before upgrading AVR Classic. Any version of AVR Classic (up to 5.2) connects successfully DataGate 16 or 17. With DataGate upgraded and working with your version of AVR, you’re ready to upgrade AVR itself. See this article for details on [upgrading DataGate for IBM i](/en/kb/installing-a-second-instance-of-datagate-for-ibm-i).\n\n### Upgrading to AVR Classic 5.1 or 5.2\n\nGenerally, the effort required to upgrade a lower version of AVR Classic to AVR Classic 5.1 /5.2 is to open the older AVR project in AVR 5.1/5.2 and recompile. The older project is implicitly upgraded for you. Before opening an older project, be sure to make a copy of the old AVR project. The implicit conversion is one-way and you can’t convert a 5.1 or 5.2 back to a lower version of AVR. While nothing usually goes wrong with the implicit upgrade, Murphy lurks and it’s good to be able to start over if you need to. If you’re upgrading from AVR 5.0, it’s not likely that you’ll need to change any code (except for the third-party control caution mentioned below). If you are upgrading from AVR 4.x, you may need to remediate some code.\n\nAfter compiling but before redeploying your upgraded apps, be sure to test them thoroughly. This is especially true with places in the apps that use third-party controls (see the section below for more on third-party controls).\n\n> You can only have one AVR Classic version on a PC at a time. Using multiple virtual machines is the best way to work with multiple environments.\n\n### Redeploy the new deployment package and your apps\n\nAfter recompiling your projects with AVR 5.1/5.2, then you need to redeploy them to your clients. Each client must also be upgraded to the corresponding AVR 5.1/5.2 deployment package.\n\n### Beware third-party controls\n\nThat said, there is a dark side to an AVR 4.x to AVR 5.1/5.2 upgrade: third-party controls. Although we’ve refreshed AVR 5.1/5.2 to work with Windows 10 and 11, virtually all third-party COM and ActiveX controls have long since been discontinued and/or deprecated. These controls may or may not work on Windows 10/11–and even more frustrating, sometimes they work on some Windows 10/11 PCs but don’t work on others. Beyond troublesome interoperability with Windows 10/11 watch for licensing issues. If you’ve lost the license for a third-party control, it’s not likely that you can get a replacement. The FarPoint tab control and the Larcom and Young resizing control are both examples of controls that are notoriously unfriendly to Windows 8/10.\n\nThis third-party control warning also applies to the chart control that originally shipped with AVR Classic. ASNA licensed that control for redistribution in the early 90s and the vendor has long since gone out of business. Most customers report that it appears to work with Windows 10/11, but your mileage may vary. The old chart control is available for AVR 5.1/5.2 but it is no longer supported.\n\n### AVR Classic Web applications — any version\n\nAVR Classic Web apps require VB Script, and VB Script is no longer supported by any modern browser. Even the lowly, and long-retired IE 11, runs VB Script only in \"legacy document mode.\" As of October 2023, Microsoft no longer includes VB Script in Windows.\n\nVB Script is very susceptible to many browser exploits and hackers. Its use today is [strongly discouraged by Microsoft.](https://www.zdnet.com/article/microsoft-were-disabling-vbscript-in-windows-7-8-to-block-attackers/) There isn’t any upgrade path available for AVR Classic applications. If you’re one of the few shops still running AVR Classic websites, we strongly recommend that you rewrite them. While there aren’t automation tools, depending on how your AVR Classic Web application code was written you may be able to salvage some code with cut and paste."
        }
    },
    {
        "dirent": {
            "name": "arrays-visual-rpg-arguments.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR for .NET arrays: arrays as arguments",
                "description": "This article explains how to use arrays as arguments to methods with Visual RPG.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T11:57:42.000Z",
                "date_updated": "2024-01-09T17:58:44.000Z",
                "date_created": "2024-01-09T17:58:44.000Z",
                "pinned": false
            },
            "content": "\nYou can easily pass an AVR for .NET array, as an argument, to subroutines and functions. To do so, the `DclSrParm` that receives the array must be declared as a ranked array (remember, rank means number of dimensions). However the array that you pass may have been declared, as either a ranked or dimmed array, the distinction is that regardless of how the array is declared, when passed to a subroutine or function, the array will be seen as a ranked array.\n\nIn the example that follows, `MyRoutine` passes the ranked array `MyArr` to a routine `Test1`.\n\n```\nDclArray MyArr Type(*Integer4) Rank(1)\n\nMyArr = *New *integer4[] { 24, 30, 36, 42 }\n\nTest1(MyArr)\n\n...\n\nBegSr Test1\n    DclSrParm InArr Type(*Integer4) Rank(1) \n    .         \n    .         \n    Test1 has the contents of MyRoutine's array available\n    to it here--as the InArr array.\n    .         \n    .         \nEndSr\n```   \n\nor with a dimmed array:\n\n```\nDclArray MyArr Type(*Integer4) Dim(4)\n\nMyArry[0] = 24\nMyArry[1] = 30\nMyArry[2] = 36\nMyArry[3] = 42\n\nTest1(MyArr)\n\n...\n\nBegSr Test1\n    DclSrParm InArr Type(*Integer4) Rank(1) \n    .         \n    .         \n    Test1 has the contents of MyRoutine's array available\n    to it here--as the InArr array.\n    .         \n    .         \nEndSr\n``` \n\nNote that `Test1` won’t explicitly know how many elements are in the `InArr` array. If `Test1` needs to traverse the `InArr,` it needs to use either the `For/Each`, the array’s `GetUpperBound()` method, or the array’s `Length` property. Don’t ever assume the array bounds in called routines–always use softcoded techniques for determining the upper bounds of the passed array.\n\nIt’s also important to note that you use `DclSrParm` to declare array arguments to functions and subroutines, but you must also include the `Rank()` keyword to indicate that parameter is an array.\n\n#### Arrays are reference types\n\nBecause arrays are reference types they are implicitly passed by reference. Thus, any changes made in the called routine are reflected in the caller. This is illustrated in the code below. The zeroth element of `MyArr` is 24 below the call to `Test1`; after the call to `Test1` its value is 189.\n\n```\nDclArray MyArr Type(*Integer4) Rank(1)\n\nMyArr = *New *integer4[] { 24, 30, 36, 42 }\n\n// MyArr[0] is now 24.\n\nTest1(MyArr) \n// After the call, MyArr[0] is 189. \n\nBegSr Test1\n    DclSrParm InArr Type(*Integer4) Rank(1) \n    .         \n    .         \n    InArr[0] = 189\n    .         \nEndSr\n```   \n\nIn .NET, by default, arguments are passed by value. So, the above behavior is probably not the behavior a beginning AVR for .NET programmer expects. (In AVR Classic, changes to arguments passed by value were not seen by the caller). However, when .NET reference types are passed by value, they have pass-by-reference semantics when values are changed. The notion of reference types being passed by value is a concept that will raise its pointy head time and time again in AVR for .NET. Get very familiar with it! Read more about [value and reference types](https://msdn.microsoft.com/en-us/library/t63sy5hs.aspx) here.\n\n#### Redimension arrays\n\nYou cannot explicitly redimension arrays in AVR for .NET. The `ReDim` operation is specific to VB. It is not a .NET operation and therefore also not available to AVR or C#. However, the fact that arrays are reference types can be exploited to implement your own array redimensioning. Pay close attention to the code that follows—it has a few subtleties.\n\n```\nBegSr MyRoutine     \n    DclArray MyArr Type(*Integer4) Rank(1)\n\n    MyArr = *New *integer4[] { 24, 30, 36, 42 }\n    // MyArr has four elements.\n\n    MyArr = ReDimMyArr(MyArr, 8) \n    // Now MyArr has eight elements. \nEndSr\n\nBegFunc ReDimMyArr Type(*Integer4) Rank(1) \n    DclSrParm InArr  Type(*Integer4) Rank(1) \n    DclSrParm ElementCount Type(*Integer4)\n\n    DclArray MyArr Type(*Integer4) Rank(1)\n\n    MyArr = *New *Integer4[ElementCount]        \n    Array.Copy(InArr, MyArr, InArr.Length)\n\n    LeaveSr MyArr\nEndFunc\n```\n\nBecause `MyArr` was passed by value to `ReDimMyArr()` the returned reference to a new array (with the number of elements provided) is assigned to `MyArr` in `MyRoutine.` This effectively reassigns a new array to the `MyArr` in `MyRoutine.` This technique wouldn’t work if `MyArr` was passed to `ReDimMyArr()` by reference.\n\nIn Part 5, we’ll take a look at the convert record format data into an array.\n\n"
        }
    },
    {
        "dirent": {
            "name": "dfu-like-utility-with-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Emulating DFU with ASNA Visual RPG",
                "description": "This small ASNA Visual RPG Windows project shows a way to build a simple Data File Utility (DFU)-like program with AVR. ",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T18:27:16.000Z",
                "date_created": "2024-01-11T18:27:16.000Z",
                "pinned": false
            },
            "content": "\nThis small ASNA Visual RPG Windows project shows a way to build a simple Data File Utility (DFU)-like program with AVR. This is a very simple project and a good one for first-time AVR coders to spend time with.\n\n[Full project on GitHub](https://github.com/ASNA/avr-windows-dfu-example)\n\n[Download project zip file from GitHub](https://github.com/ASNA/avr-windows-dfu-example/archive/main.zip)\n\n[See fully annotated source code](https://asna.github.io/avr-windows-dfu-example/Form1.vr.html)\n\n![Enter a customer number](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/screen-1.png)\n\nFigure 1a. Enter a customer number\n\n![Update customer number](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/screen-2.png)\n\nFigure 1b. Update customer information\n\n#### A bonus for the adventurous coder\n\nThe text above includes a link to this project’s annotated source code ([here is that link again](https://asna.github.io/avr-windows-dfu-example/Form1.vr.html)). That annotated code is created directly from the project’s source code with an open-source Python-based tool called [Pycco](https://github.com/pycco-docs/pycco).\n\nPycco is one of many projects derived from the JavaScript-based [Docco](http://ashkenas.com/docco/) project which generates documentation (annotated code, really) from source. Pycco is Docco written in Python.\n\nUsing Pycco, this source code:\n\n```\n// ### Copy fields record format fields to input fields\nBegSr PopulateUIFromRecord\n    txtCMName.Text     = Cust_CMName.Trim()\n    txtCMAddr1.Text    = Cust_CMAddr1.Trim()\n    txtCMCity.Text     = Cust_CMCity.Trim()\n    txtCMState.Text    = Cust_CMState.Trim()\n    txtCMPostCode.Text = Cust_CMPostCode.Trim()        \n    // Input fields in .NET Windows forms apps are always text. They need to be \n    // converted to and from source and target values. Cust_CMFax is a numeric value.\n    // The .NET's ToString() method used to format the numeric value to a desired\n    // string format. [Read about .NET's custom numeric format strings here](https://docs.microsoft.com/...)\n\n    txtCMFax.Text      = Cust_CMFax.ToString(\"(000) 000-0000\") \n    txtCMPhone.Text    = Cust_CMPhone.Trim()\nEndSr\n```\n\nProduced this portion of the annotated code:\n\n![A Pycco-generated document fragment](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/pycco.png)\n\nPycco reads your source and uses its comments to generate the annotations. Comments can be formatted with Markdown. For example, this line of code\n\n```\n// ### Copy fields from inputs fields to record format fields`\n```\n\ntranslates to an H3 tag in the code annotation (in Markdown, \"###\" translates to the H3 tag):\n\n```\n<h3>Copy fields from inputs fields to record format fields</h3>`\n```\n\nYou can read more about [Markdown syntax here](https://www.markdownguide.org/). Visual Studio Code has great Markdown support–I use it and Markdown for virtually all of the writing I do. As you read the [raw code here](https://github.com/ASNA/avr-windows-dfu-example/blob/main/Form1.vr) you’ll notice that Markdown has a simple syntax for inserting things such as images and links.\n\nYou need to have Python and Pycco installed on your PC. See [python.org](https://www.python.org/) for how to get and install Python (it’s free). Instructions for installing custom modules (such as Pycco) [are here](https://docs.python.org/release/3.9.1/installing/index.html). (An older version of Python may already be present on your Windows PC. If so, you could try using it–but generally, it’s better to install Python 3.9x).\n\nTo annotate one of your projects, copy the Pycco folder from this project (use the download zip file link near the top of the article) into the root of your AVR project. Then from the `pycco` folder run the `annotate-code.bat` batch file from a command line. That command produces a `pycco-docs` folder with your source code annotated in HTML files. A top-level directory of source members (with your folder structure preserved) is in the file named `master_index.html.`\n\nThe `run-pycco.py` Python script in the `pycco` directory does the work of annotating your source.\n\nNear the end of that script you’ll see these two lines:\n\n```\ncmd = f'pycco {file} -d ./pycco-docs -l javascript -p'           os.system(cmd)\n```\n\nThis Python code results in the command line:\n\n```\npycco {file} -d ./pycco-docs -l javascript -p'\n```\n\nbeing run for each file in your project (where `{file}` is the name of a source member in your project). This line calls Pycco for each project member and is what generates its annotated HTML file.  Pycco supports many languages, but unfortunately, it doesn’t support AVR directly. However, AVR comment rules match JavaScript’s so the `-l` flag tells Pycco to use JavaScript commenting rules.\n\nTo determine the files for Pycco to process, the `run-pycco.py` script uses this Python structure (formally, it’s a Python tuple):\n\n```\nsearches = ('global.asax', 'web.config', '*.aspx', '**/_.aspx', '_.vr', '**/_.vr', 'app_code/_.vr' )\n```\n\nThis structure names either specific files or directories. For example, the `*_/_.vr` syntax includes any files with a `.vr` extension in any folder.\n\nAnother tuple specifies found files to exclude:\n\n```\nignored_files = ('^._designer.vr', '^._assemblyinfo.vr')       \n```\n\nThis tuple causes any file ending in either `designer.vr` or `assemblyinfo.vr` to be excluded.\n\nI tweaked the Pycco CSS a little to get the green and blue bars on the annotation.\n\nI’m not a fan of overly commented code and Pycco comments certainly fall into that category. However, there may be merit in a team following some good coding conventions and making their annotated code available–and Pycco is great for published, teaching-style code.\n\nIt’s beyond the scope of this article, but to make the Pycco-generated annotated pages available on the Web, I’m using a cool feature of GitHub called [GitHub Pages](https://pages.github.com/) to provide what is essentially a static site host for HTML pages. With just a batch file I can commit project changes to Git, generate the Pycco files, and then push both the project and Pycco changes up to GitHub. GitHub is truly one of the modern wonders of the world!\n\nI know this Pycco section is out in the weeds for many of you, but thought I would include it for the curious (and I got tired of trying to find the last project for which I did this and figuring out how to do it again. Now I have a little documentation.)"
        }
    },
    {
        "dirent": {
            "name": "memory-file.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Getting to know AVR's memory file",
                "description": "A look at Visual RPG's memory file and how it works with the .NET Framework's System.Data.DataTable works.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T21:14:30.000Z",
                "date_created": "2024-01-09T21:14:30.000Z",
                "pinned": false
            },
            "content": "\nAVR for .NET's memory file is an RPG programming interface over .NET's `System.Data.DataSet`. Under the covers, what really lurks in a memory file is .NET's `System.Data.DataSet`. The memory file surfaces this `DataSet` with its dataset property. The `DataSet` is the central nervous system of the memory file. To understand the memory file you need to understand the `DataSet`. When you write to and read from a memory file, the memory file's `DataSet` property is where all that writing and reading is really taking place.\n\nA `DataSet` is an in-memory cache of data retrieved from a data source. The `DataSet` is a parent object that consists of one more `DataTable` objects. For most purposes, especially when using a memory file, you'll only have one table per dataset. Each `DataTable` object consists of `DataColumn` and `DataRow` objects.\n\n![Memory file structure](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/memory-file.png)\n\nFigure 1. The DataSet and its inner members.\n\n## The memory file\n\nAVR's memory file is an in-memory file generally used as a temporary data store. Rows are \"written\" (in quotations because rows are written to memory, not disk) to memory files, usually to later be bound to a .NET user interface element.\n\n> Beware that a memory file stores its contents in memory, never on disk. Be mindful of how many rows you write to a memory file. While it is surprising how many rows .NET can sustain in memory, don't get carried away. Not only would lots of rows tax memory, but they would also offer a larger payload across the network. No user wants to to wait on 5,000 rows being rendered in the browser!\n\nLet's take a look at two ways to declare a memory file:\n\nCreate a memory file that duplicates all of the fields in a given file:\n\n```\nDclMemoryFile MemFile +\n    DBDesc(\"*Public/DG Net Local\") +\n    FileDesc(\"Examples/CMastNewL1\") +\n    RnmFmt(MemFileR)\n```    \n\nThe memory file above contains all of the columns in the `Examples/CMastNewL1` file. Memory files are using used along with a corresponding `DclDiskFile` of the same data file, so it's usually necessary to rename the memory file's format.\n\nCreate a program-described memory file:\n\n```\nDclMemoryFile MemFile ImpOpen(*Yes) \n    DclRecordFormat Customers \n    DclRecordFld    Customer_CMCustNo  Type(*Packed) Len(9,0)\n    DclRecordFld    Customer_CMName    Type(*Char) Len(40)      \n```    \n\nThe memory file above creates a memory file with two fields. Program-described memory files are useful when you don't need every column in a file. A program-described memory file's format name is explicitly provided with the required `DclRecordFormat` operation code.\n\nThe discussion applies to either way of defining a memory file.\n\n## Populating a memory file\n\nThe code below writes up to 16 rows to a memory file, after each read of a record from the `Customer` file.\n\n```\nDclDB DGDB DBName(\"*Public/DG Net Local\") \n            \nDclDiskFile Customer +\n        Type(*Input) + \n        Org(*Indexed) + \n        Prefix(Customer_) + \n        File(\"examples/cmastnewl2\") +\n        DB(DGDB) +\n        ImpOpen(*No)  \n\nDclMemoryFile MemFile ImpOpen(*Yes) \n    DclRecordFormat Customers \n    DclRecordFld    Customer_CMCustNo  Type(*Packed) Len(9,0)\n    DclRecordFld    Customer_CMName    Type(*Char) Len(40)     \n\n    ...\n    \n    Do FromVal(1) ToVal(16)\n        Read Customer \n        If Customer.IsEof()            \n            Leave\n        EndIf\n    \n        Write MemFile      \n    EndDo                   \n```    \n\nThe result of the code above is that the `DataSet` property's `DataTable` property is populated with the rows read from the `Customer` file. Direct access to the memory file's `DataSet` is available with this code:\n\n```\nDclFld ds Type(System.Data.DataSet)\nds = MemFile.DataSet\n```    \n\nRecall that the `DataSet` can have more than one `DataTable` (although used with AVR it rarely, if ever, does). These `DataTables` are available through the `DataSet's` `Tables` collection. The code below fetches the zeroth (the only) `DataTable` in the `DataSet`.\n\n```\nDclFld dt Type(System.Data.DataTable)\ndt = MemFile.DataSet.Tables[0]\n```    \n\n#### DataColumns and DataRows\n\nEach `DataTable` comprises a collection of `DataColumn` objects. These `DataColumns` define the file's layout (i.e., its field names, their types, and their values). The contents of each `DataTable` are stored in a collection of `DataRows`.\n\nFirst, get the table reference. With it, you're ready to work with the table's rows and columns:\n\n```\ndt = MemFile.DataSet.Tables[0]\n```\n    \n\nIterate the `DataTable's` `DataColumns` with:\n\n```\nForEach Col Type(DataColumn) Collection(dt.Columns) \n    // Col now contains a reference to a column in the table\nEndFor\n```    \n\nIterate the `DataTable's` `DataRows` with:\n\n```\nForEach Row Type(DataRow) Collection(dt.Rows) \n    // Row contains a reference to a row in the table\nEndFor \n```    \n\nPutting all that together, the code beloww loads 16 rows into the memory file and then shows each field value in each `DataRow`, fetching the values out by field name:\n\n```\nDclDB DGDB DBName(\"*Public/DG Net Local\") \n        \nDclDiskFile Customer +\n        Type(*Input) + \n        Org(*Indexed) + \n        File(\"examples/cmastnewl2\") +\n        DB(DGDB) +\n        ImpOpen(*No)  \n\nDclMemoryFile MemFile +\n    DBDesc(\"*Public/DG Net Local\") +\n    FileDesc(\"Examples/CMastNewL1\") +\n    RnmFmt(MemFileR)\n\nBegSr Run Access(*Public) \n    DclFld FieldNameList Type(StringCollection) \n\n    Connect DGDB \n    Open Customer \n\n    WriteRowsToMemoryFile()\n    FieldNameList = GetFieldNameList()\n    ShowFieldValues(FieldNameList) \n\n    Close *All\n    Disconnect DGDB \nEndSr\n\nBegSr WriteRowsToMemoryFile\n    Do FromVal(1) ToVal(16)\n        Read Customer \n        If Customer.IsEof()            \n            Leave\n        EndIf\n\n        Write MemFile      \n    EndDo \nEndSr \n\nBegFunc GetFieldNameList Type(StringCollection) \n    DclFld dt Type(DataTable) \n    DclFld FieldNameList Type(StringCollection) New()\n\n    dt = MemFile.DataSet.Tables[0]\n\n    // Iterate each column adding its field name to the collection.\n    ForEach Col Type(DataColumn) Collection(dt.Columns) \n        FieldNameList.Add(col.ColumnName.ToString()) \n    EndFor        \n    LeaveSr FieldNameList \nEndFunc \n\nBegSr ShowFieldValues\n    DclSrParm FieldNameList Type(StringCollection) \n\n    DclFld dt Type(DataTable) \n\n    dt = MemFile.DataSet.Tables[0]\n\n    // Iterate each data row. \n    ForEach dr Type(DataRow) Collection(dt.Rows) \n        // Show the value for each field in the row.\n        ForEach FieldName Type(*String) Collection(FieldNameList)\n            Console.WriteLine(dr[FieldName].ToString())  \n            // Note that field values are also assignable. \n            // Assuming 'FieldName is a string type, you could do this.\n            // dr[FieldName] = 'xyz'\n        EndFor \n    EndFor \nEndSr \n```    \n\n## Summary\n\nWhile the `DataSet` is looked down on by purists, there is a lot AVR can do with it. Spend some time seeing what it can do for you.\n\n"
        }
    },
    {
        "dirent": {
            "name": "confirm-datagate-port.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to confirm DataGate for IBM i's IP port assignment",
                "description": "How to confirm the IP port assigned to DataGate for IBM i. ",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2023-12-29T10:54:25.000Z",
                "date_updated": "2023-12-29T17:17:31.000Z",
                "date_created": "2023-12-29T17:17:31.000Z",
                "pinned": false
            },
            "content": "\nWhen you install ASNA DataGate for IBM i, you select a TCP/IP port through which DataGate connects on your IBM i. The default value for this port is 5042, but you can use any available port on your IBM i. Knowing how to check which port is in use is an important part of troubleshooting DataGate.\n\nThis article confirms that DataGate is using the correct TCP/IP port.           [See this article for how to identify DataGate for IBM i's configured TCP/IP port.](/en/kb/test-ip-address-and-port-for-datagate)\n\n## Determine what port Datagate is using on your IBM i\n\nTo see what port is assigned to your DataGate instance, use the IBM i command\n\n`\n               WRKSRVTBLE\n          `\n\nto show your IBM i's Service Table Entries.\n\nThe list is presented alphabetically with lower-case services listed first. The DataGate entry is in mixed case and is at or near the end of the list. Scrolling down to the DataGate entry shows the TCP/IP port to which it's assigned.\n\n![Work with service table entries](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/wrksvrtble.png)\n\nFigure 1. Showing DataGate's WRKSRVTBLE entry.\n\nThe figure above shows that the DataGate port is 5150. (The default is 5042. On ASNA R&D boxes we often have several instances of DataGate installed and running. Our convention is to assign the port in the format 5xxy where xx is the major version of DataGate and y is the minor version of DataGate)\n\nThe default name for the DataGate Service Table Entry is \"DataGate           *xxy*           \" where           *xx*           is the major version of DataGate and           *y*           is the minor version of DataGate.\n\nNote: if for any reason you need to manually modify the DataGate Service Table entry, be sure that the protocol is entered as           *'tcp'*           with lower case.\n\n## Confirm DataGate Service Table Entry name\n\nTo confirm DataGate's Service Table Entry name, use\n\n```\nDSPDTAARA <DataGateLibrary>/TCPSERVICE \n```\n[See this article to determine your DataGate instance's library name.](/en/kb/get-datagate-library-name)\n\n## View TCP/IP port activity\n\nTo see the DataGate port activity, use the IBM i command\n\n```\nNETSTAT\n```\n![Netstat menu](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/netstat-2.png)\n\nThen take option 3, \"Work with IPv4 Connection Status.\"\n\nThen,\n\n- Press F14 to display port numbers\n- Press F11 to display users\n- Press F13 to select column sort and sort by \"Local Port\"\n- Press F15 to select a port range. Tab down to Local Port range and enter 5000 as the lower value and 6000 as the upper value. This range assumes you're using the convention of assigning DataGate ports in the 5000 to 5999 range. If you're using another convention, select your range appropriately.\n\nDataGate ports are the ones for user           `\n               DG8VSCPRF\n          `           .\n\nThis results in the display shown below:\n\n![Netstat results](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/netstat-1.png)\n\nFigure 2. Showing DataGate TCP/IP port activity with NETSTAT\n\nThis display shows port 5150 activity. You can also see that, on this box, there is a second instance of DataGate running on port 5160. Using our R&D conventions, this quickly tells us that both DataGate 15.0 and DataGate 16.0 are both running on this IBM i."
        }
    },
    {
        "dirent": {
            "name": "check-datagate-for-ibm-i-ip-port.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to see DataGate for IBM i's TCP/IP port configuration",
                "description": "This article shows to identify DataGate for the IBM i’s configured TCP/IP port. Use it to confirm that DataGate is using the correct TCP/IP port.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-01-08T22:54:28.000Z",
                "date_updated": "2024-01-09T04:54:52.000Z",
                "date_created": "2024-01-09T04:54:52.000Z",
                "pinned": false
            },
            "content": "\nThis article shows to identify DataGate for the IBM i’s configured TCP/IP port. Use it to confirm that DataGate is using the correct TCP/IP port.\n\nThe value in the `TCPSERVICE` data area must match _exactly_, including case, the service entry value (as viewed with WRKSRVTBLE). If you change or delete a service table entry,  you must specify the name with its correct casing and the ‘tcp’ protocol must be in lower case.\n\n**Step 1.** Determine the library in which your DataGate instance was installed. See this article for help determining your DataGate library name.\n\n**Step 2.** Display the value of the `TCPSERVICE` data area in your DataGate library with\n\n`DSPDTAARA /TCPSERVICE`\n\n![Using the TCPSERVICE data area to see the DataGate service entry name](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tcp-port-01.png)\n\nIn the figure above, the DataGate library name is DG8_160 and its service table entry name is DataGate160.\n\n**Step 3.** Find the DataGate service table entry. Use the\n\n```\nWRKSRVTBLE \n```\n\ncommand to display all service table entries. Find your DataGate service table entry in the list presented. It is probably near the bottom of the list because by default DataGate service table names start with an upper-case letter.\n\n![Using WRKSRVTBLE to find the DataGate service table entry](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tcp-port-02.png)\n\nIn the example above you can see the DataGate160 service table entry and that it defines port 5160 as your DataGate instance’s port. Each DataGate installation has its own TCP/IP uniquely defined by this service table entry.\n\nNote: this screenshot came from one of ASNA’s test IBM i machines. It has many instances of DataGate installed on it. Most production machines will have only one or two DataGate instances installed.\n\n"
        }
    },
    {
        "dirent": {
            "name": "html-css-js-resources.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "HTML, CSS, and JavaScript resources",
                "description": "This article shows several recommendations for learning HTML, CSS, and JavaScript.",
                "tags": [
                    "front-end"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T20:12:14.000Z",
                "date_created": "2024-01-11T20:12:14.000Z",
                "pinned": false
            },
            "content": "#### Kevin Powell courses and YouTube channel\n\n[Kevin](https://www.kevinpowell.co/courses/) focuses mostly on CSS and HTML . His free courses start at the beginner level and include:\n\n[Conquering Responsive Layouts](https://courses.kevinpowell.co/conquering-responsive-layouts)\n\n[HTML & CSS Crash Course](https://scrimba.com/learn/introhtmlcss)\n\n[Build a space travel website](https://scrimba.com/learn/introhtmlcss)\n\nKevin also has premium courses available for $50 to $250. Kevin also has a [YouTube channel](https://www.youtube.com/@KevinPowell) that focuses almost exclusively on CSS and HTML.\n\n#### Wes Bos courses\n\n[Wes](https://wesbos.com/courses) focuses mostly on JavaScript, CSS, Node, and front-end technologies. His free courses start at the beginner level and include:\n\n[JavaScript30](https://javascript30.com/)\n\n[CSS Grid](https://cssgrid.io/)\n\n[CSS FlexBox](http://flexbox.io/)\n\nWes also has premium courses available for $44.50 and up. Wes (along with Scott Tolinksi) most the [Syntax podcast.](https://syntax.fm/) It covers front-end technologies. Wes also has a [YouTube channel](https://www.youtube.com/@WesBos/videos) that focuses on front-end technologies.\n\n#### [Modern CSS Solutions website](https://moderncss.dev/) by Stephanie Eckles\n\nStephanie provides lots of great CSS content. This site features many great, focused tips on using CSS. [smocss.dev](https://smolcss.dev/) is also Stephanie’s work with other focused CSS examples.\n\n#### [Miriam Suzanne Code Pens](https://codepen.io/miriamsuzanne/pens/public)\n\nMiriam Suzanne is a leading CSS guru. She is an Invited Expert on the W3C CSS Working Group and her work can be found in many places, [including here](https://www.oddbird.net/authors/miriam/). Anytime you Google \"CSS\" and see Miriam’s name, click that link!\n\n#### Google Chrome Developers YouTube Channel\n\nThe Google Chrome Developer’s channel has a little something for everyone. There are so helpful videos on using Chrome Developer Tools. For intermediate/advanced CSS/JS devs, the real gold here is [Adam Argyle’s Gui Challenges](https://www.youtube.com/hashtag/guichallenges). Adam really knows his way around CSS and JavaScript. Each of his challenges goes deep on a specific topic. If you are an intermediate-level CSS/JS coder, digging into any of Adam’s GUI challenges makes lots of lightbulbs come one (each video also includes a blog post and a GitHub link). His [Dialog](https://www.youtube.com/watch?v=GDzzIlRhEzM), [Buttons](https://i.ytimg.com/an_webp/aJNq-b1zlog/mqdefault_6s.webp?du=3000&sqp=CJjP56QG&rs=AOn4CLDQZpoN4QrxGy7s-y4dhWf0TVmDcw), and [Tabs](https://i.ytimg.com/an_webp/mMBcHcvxuuA/mqdefault_6s.webp?du=3000&sqp=CKDg56QG&rs=AOn4CLA380QVJMDXzzTV0eazCcvzS_a5tg) videos are good places to start.\n\n#### Other YouTube channels worth checking out\n\n[9elements](https://www.youtube.com/@9elements) (especially Stephanie Eckles' content) \n\n[Code in Public](https://www.youtube.com/@CodinginPublic) - \n\n[codeSTACKr](https://www.youtube.com/@codeSTACKr)\n\n[Codewrinkles](https://www.youtube.com/@Codewrinkles)\n\n[Coding Tech](https://www.youtube.com/@CodingTech)\n\n[Colt Steele](https://www.youtube.com/@ColtSteeleCode)\n\n[DesignCourse](https://www.youtube.com/@DesignCourse/videos)\n\n[DevelopedByEd](https://www.youtube.com/@developedbyed)\n\n[Frank Liu](https://www.youtube.com/@FrankLiuSoftware)\n\n[Free Code Camp](https://www.youtube.com/@freecodecamp)\n\n[Scott Hanselman](https://www.youtube.com/@shanselman)\n\n[Net Ninja](https://www.youtube.com/@NetNinja)\n\n[Web Dev Simplified](https://www.youtube.com/@WebDevSimplified)\n"
        }
    },
    {
        "dirent": {
            "name": "mobile-rpg-controls.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "ASNA Mobile RPG controls gallery",
                "description": "This article shows the user interface controls available with ASNA Mobile RPG.",
                "tags": [
                    "mobile-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T22:05:30.000Z",
                "date_created": "2024-01-11T22:05:30.000Z",
                "pinned": false
            },
            "content": "[ASNA Mobile RPG] is a mobile application suite for the IBM i. It enables RPG programmers to create smartphone and tablet applications with nothing but ILE RPG. Mobile RPG provides a screen design aid on which you drag and drop various UI elements onto the screens you’re building. After creating the mobile displays they are exported to the IBM i as traditional display objects.\n\nThese exported display files are never seen by human eyeballs; rather they serve as a proxy for the mobile display file so you can compile an ILE RPG program against it. At runtime, IBM’s Open Access API redirects workstation files to the mobile display.\n\nMobile RPG’s controls do most of the heavy lifting, moving data to and from the mobile display. They encapsulate traditional display file behaviors (eg reacting to function keys and indicator-driven conditional behaviors), transport data, and present data to the user. The gallery below shows Mobile RPG’s controls and explains what they do.\n\n* * *\n\n## Navigation bar\n\n![Mobile RPG navigation bar](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSNavBar.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingBarControls.htm)\n\nThe DDSNavBar provides a navigational bar that is placed on the display in the header and/or footer. It can have embedded buttons that cause function key presses to be recognized by the underlying RPG program.\n\n* * *\n\n## Button\n\n![Mobile RPG button](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSButton.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingButtons.htm)\n\nThe DSSButton provides buttons associated with function key presses. For example, you can map an ‘F3’ key press to a button. The RPG can be programmed to react to that F3 key press (through either an associated response indicator or determining the key pressed through position 369 of the INFDS.) Buttons can be displayed with text, images, or icons (see immediately below).\n\n* * *\n\n## Icons\n\n![Mobile RPG icons](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSIcons.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingIcons.htm)\n\nThe DDSIcon provides application icons. As a stand-alone control, icons are output only. However, when combined with the DDSButton control (described above) you can associate a function key press with them.\n\n* * *\n\n## Image\n\n![Display things with Mobile RPG](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSImage.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingImageControls.htm)\n\nThe DDSImage control display images from either an IFS ASCII share on the IBM i or from a directory on the Windows Web server. The image name can be hardcoded or you can map an RPG field value to the image name.\n\n* * *\n\n## Input/Output fields\n\n![Mobile RPG input fields](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSCharField.png)\n\n## Date Field Dropdown Selection\n\n![Mobile RPG date field selector](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSDateField.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingASPXFields.htm)\n\nMobile RPG has a full complement of character, numeric, and date/timestamp fields. The DDSDateField provides a dropdown date picker. Fields can be input, output, or both. Each field is associated directly with a field in the RPG program. Like a traditional display file input field, Mobile RPG’s fields have conditional behaviors (eg position cursor or non-display) governed by RPG indicator values.\n\n* * *\n\n## Switch\n\n![Mobile RPG switch](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSSwitch.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingSwitches.htm)\n\nThe DDSSwitch provides a slider switch, a common mobile idiom. The user can swipe the switch from one position to another with a finger swipe. It presents its on-off value as a single-character field to the RPG program.\n\n* * *\n\n## Google Map\n\n![Mobile RPG Google Map](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSGMap.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingMaps.htm)\n\nThe DDSGMap displays a Google map. It presents itself to the RPG program as a simple subfile with a location column. By writing rows to its subfile, you can set as many locations as you’d like to see mapped. The image below shows the DDSGMap control in action. [See the code for this project.](https://github.com/ASNA/mr-ddsgmap-control)\n\n![Google Map example](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/ddsgmap-example.png)\n\n* * *\n\n## Charts\n\n![Mobile RPG chart](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSChart.png)\n\nRead docs\n\nThe DDSChart displays pie and bar charts. It presents itself to the RPG program as a simple subfile with a location column. By writing rows to its subfile, you can chart as many data points as needed.\n\n* * *\n\n## List\n\n![Mobile RPG list](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSList.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingLists.htm)\n\nThe DDS List displays data in one of four ways:\n\n*   navigable list\n*   dropdown list\n*   radio button list\n*   checkbox list\n\nIt also presents itself to the RPG program as a simple subfile. This control is highly configurable with many options. It can display images in a row (as shown above) and, when it is presented in its navigable list form (which is probably its most frequent use) it has tappable zones. For example, in the image shown below, the artists’ names area is a tappable zone as is the chevron on the right. These tappable zones are associated with function keys and look to the RPG program like a regular function key press.\n\nWhen presented as a list the DDSList is limited to one column of data (plus an optional image and chevron). See the DDSTable below for a grid with multiple columns.\n\n![Mobile RPG list example](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSList-short.png)\n\nThe top part of the image above shows the DDSList as a navigable list and the bottom shows it as a dropdown list.\n\n<!--\n*   [See this article for a detailed look at using the DDSList and several Mobile RPG components.](https://asna.com/us/articles/mr-controls/newsletter/2015/q2/ile-rpg-goes-free)\n    \n*   [See this article for a detailed look at using the DDSList to present a drop-down list.](https://asna.com/us/tech/kb/doc/mobile-rpg-dropdown)\n*   \n-->\n    \n## Table\n   \n\n![Mobile RPG table](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSTable.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingTables.htm)\n\nThe DDSTable presents data in a matrix of rows and columns, It is often used to show grid-based details (eg, part numbers, description, and bin number). Assigning a function key makes rows a tappable zone for selecting a row and doing something with it.\n\n* * *\n\n## Signature capture\n\n![Mobile RPG signature capture](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSSignature.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingSignatures.htm)\n\nThe DDSSignatureCapture provides a way to capture signatures. Signatures are saved as images on either an IFS ASCII share on the IBM i or in a folder on the Windows Web server. The DDSSignatureCapture has all the necessary networking built-in to send the signature to its destination. Once you’ve captured a signature, you could later display in another part of the app with the DDSImage control.\n\n* * *\n\n## File Uploader\n\n![Mobile RPG file uploader](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSFileUploader.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingUploaders.htm)\n\nThe DDSFileUPloader control lets the user send a file back to the server (where it’s stored on either an ASCII share of the IFS on the IBM i or in a folder on the Windows Web server). For example, a user could take a picture with the phone’s camera and then send that picture back to your app on the server. The control works with binary files such as PNG, GIF, JPG, and PDF and has all of the networking built-in.\n\n* * *\n\n## Link\n\n![Mobile RPG link](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSLink.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingLinks.htm)\n\nThe DDSLink control provides hyperlinks (surfaced with the HTML anchor tag) for your mobile applications. These links can navigate to an external URL or to a URL internal to your app.\n\n* * *\n\n## Bar Code Reader\n\n![Mobile RPG bar code reader](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/mr-controls/DDSBarCode.png)\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingBarCodes.htm)\n\nThe DDSBarCode control lets the user scan bar codes (including QR codes) with the phone’s camera. The scanned value is returned to the associated text box.\n\nBecause the DDSBarCode control needs to be tightly coupled with phone hardware, it requires the phone to be using the [ASNA Go](https://asna.com/us/products/mobile-rpg/asna-go) mobile app (available in either the Apple or Google stores). ASNA Go is a special-case browser for Mobile RPG that provides hardware access that exceeds what built-in browsers (ie, Firefox, Chrome, and Safari) provide.\n\n* * *\n\n### Controls with no UI\n\n## Panel\n\nThe DDSPanel control provides a container for any of the other controls mentioned.\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingPanels.htm)\n\n* * *\n\n## Geo Location\n\nThe DDSGeoLocation control doesn’t have a UI. It works in the background to send the user’s GEO coordinates each time a record format is returned to the RPG program. Upon its first use, the user must authorize the use of the control, otherwise no GEO data is returned.\n\n[Read docs](https://docs.asna.com/documentation/Help150/MobileRPG/_HTML/mrUnderstandingGeoloc.htm)\n"
        }
    },
    {
        "dirent": {
            "name": "installing-a-second-instance-of-datagate-for-ibm-i.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Installing a second instance of DataGate for the IBM i",
                "description": "How to install a second instance of DataGate for the IBM i. This article also suggests a good strategy for upgrading DataGate for the IBM i.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2023-11-07T18:54:26.569Z",
                "date_updated": "2022-06-22T00:00:00.000Z",
                "date_created": "2022-06-22T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n> Please read these instructions completely to ensure a successful co-existing install of ASNA DataGate for IBM i. If you have any questions, please contact us at info@asna.com  before you start your installation.\n> \n> It is very important to end all existing versions of DataGate that are running before installing a new instance. Starting with DataGate 16.x, the installation procedure ends all existing instances of DataGate and starts the one you just installed. [See this article for how to end DataGate]\n\n*   During installation, be sure to vary these configuration values:    \n\n    * **Service table entry name** . Be sure to provide service table entry name that is not currently in use. Use WRKSRVTBLE to see your current server table entries. By default, DataGate’s installation creates a service table name \"DataGate400\". However, you might want to consider using the naming it \"DataGateXXN\" where `XX` is the major version and `N` is the minor version number–so that you would use the name `DataGate160` for DataGate 16.0.\n\n    * **TCP/IP port** . Each DataGate instance needs its own TCP/IP port. See the more detailed note on the TCP/IP port below.\n\n    * **Target library name**. By default, DataGate’s installation uses the name `DG8/_XXN` using the major/minor numbering mentioned above. For example, DataGate 16.0’s default library is `DG8_160` .          \n*   During installation, you are asked if you want to clear the DataGate cache library. Be sure to reply \"N\" to this question if other instances of DataGate are running. **Replying \"Y\" will disrupt your running DataGate instance.**\n* DataGate Database Names reference DataGate’s TCP/IP address. During testing of your instance of DataGate, create a Database Name that points to the new instance of DataGate. Later, when you switch the new version of DataGate over to production, you’ll need to either change the production Database Name’s TCP/IP port or change the service table entries that reference the TCP/IP port that your new DataGate instance uses.\n    \n*   It is OK to install another DataGate instance into the same subsystem as the currently-running DataGate instance. By default, this subsystem is QINTER.\n    \n*   Remember to change references to DataGate in your IBM i IPL startup program, when you’re ready switch the new version of DataGate over to production.\n    \n\n"
        }
    },
    {
        "dirent": {
            "name": "how-to-start-stop-confirm-datagate-on-ibm-i.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to start, stop, and confirm DataGate on the IBM i",
                "description": "How to start, stop, and confirm that DataGate on the IBM i.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2023-11-04T18:54:26.569Z",
                "date_updated": "2022-11-03T00:00:00.000Z",
                "date_created": "2022-06-22T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n## Starting and stopping DataGate on the IBM i\n\nTo start DataGate:\n\n`<DataGate Library>/STRDG8SVR`\n\nWhen DataGate starts, a number of DataGate service jobs on the IBM i are started. See this article for an explanation of DataGate’s jobs.\n\nTo end DataGate:\n\n`<DataGate Library>/ENDDG8SVR`\n\nSee this article for help identifying what your `<DataGate Library>` name is.\n\n> It is always best to ensure that no DatGate end-user jobs are active before using `ENDDG8SRV` . See this article for identifying active DataGate end-user jobs.\n\n## How to determine if a given DataGate instance is running\n\nUsing `WRKACTJOB` , look for `DG8SVC` jobs with the function `CMD-DG8_START` . There is one of these jobs for each active (running) instance of DataGate. You can clearly identify the library from which the job’s DataGate instance is running by looking at the job’s job log.\n\nFor example, if you have DataGate installed in the `DG8_140` library, if that instance is running its `DG8SVC` `CMD-DG8_START's` job log will show:\n\n![Using WRKACTJOB to see that DataGate is running](https://nyc3.digitaloceanspaces.com/asna-assets/images/from-wp/datagate-dg8svc-job.png)\n\nwhich indicates that the job is associated with the DataGate instance in the DG8\\_140 library.\n\n\n\n"
        }
    },
    {
        "dirent": {
            "name": "change-dss-port.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to change DataGate for SQL Server's TCP/IP port",
                "description": "This article explains how to change the TCP/IP port that DataGate for SQL Server.",
                "tags": [
                    "datagate-sql-server"
                ],
                "date_published": "2024-12-10T00:00:00.000Z",
                "date_updated": "2024-12-10T00:00:00.000Z",
                "date_created": "2024-12-10T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Image from \"$components/text-decorators/Image.svelte\";\n    import Callout from \"$components/text-decorators/Callout.svelte\"\n</script>\n\nThis article explains how to change the TCP/IP port that DataGate for SQL Server (DSS). By default, DSS uses port 5042. That port number is defined in the registry and to change the port number you need to change that key's value.\n\n> Interesting minutiae: the port number 5042 isn't arbitrary. It was assigned by the Internet Assigned Numbers Authority to ASNA as DataGate's formal port number a very long time ago! [Search this link for 5042.](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.txt )\n\n\n<Callout\nimage=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/icon-images/exclamation-point.png\"\nfont_size=\"1.2rem\"\nfont_style=\"italic\">\nDanger ahead! Incorrect changes to your PC's registry can render your PC unusable. A PC administrator familiar with changing the registry should make these changes. \n</Callout> \n\n\n### Step 1. \n\nEnsure all users are logged out and stop the DG Service on the server. The quick way is by with the \"A\" tray icon.  Right-click and select \"Stop the Service\" as shown below in Figure 1.\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/stop-datagate-service.png\"\nalt=\"Stopping the DataGate service\"\nwidth=\"200\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 1.\"\ncaption_class=\"small-image-component-caption\"\n></Image>\n\nAlternatively, you can use Windows's services panel to end the DataGate as shown below in Figure 2a.\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/services-panel-dss.png\"\nalt=\"Stopping the DataGate services with the Services panel\"\nwidth=\"550\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 2a.\"\ncaption_class=\"small-image-component-caption\"\n></Image>\n\n### Step 2.\n\nOpen the Windows Registry Editor, a.k.a. regedit.exe.  Navigate to the DG Service key. The \"17\" in the key name could be different, depending on the installed version of DSS.  \n\nThe full key name is:\n\n```\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DataGate Server 17\n```\n\nThe DataGate registry key is shown below in Figure 2b.\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/regedit-dss.png\"\nalt=\"Finding the DSS port key in the registry\"\nwidth=\"550\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 2b.\"\ncaption_class=\"small-image-component-caption\"\n></Image>\n\n### Step 3. \n\nIn the right-hand pane, find and double-click the value name \"TCP/IP Port\". The \"Edit DWORD\" dialog should appear. Set the \"Base\" radio button to \"Decimal\" and change the\"Value data\" input to your desired port number (as shown below in Figure 3).\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/change-registry-dss.png\"\nalt=\"Changing the DSS port value\"\nwidth=\"300\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 3.\"\ncaption_class=\"small-image-component-caption\"\n></Image>\n\nClick \"OK\" and close the Registry Editor.\n\n### Step 4.\n\nRestart the service using either the DataGate dialog as shown below in Figure 4 or use the services panel shown in Figure 2b. \n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/start-datagate-service.png\"\nalt=\"Starting the DataGate service\"\nwidth=\"200\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 4.\"\ncaption_class=\"small-image-component-caption\"\n></Image>\n\nDataGate for SQL Server's port is now changed and its ready to use. Be sure to put this changed port number in your DataGate Database names.\n\n<!-- \n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/test-netconnection-dss.png\"\nalt=\"Using PowerShell's test-netconnection cmdlet to check a port's status\"\nwidth=\"600\" alignment=\"left\" hide_caption={false}\ncaption=\"Figure 1.\"\ncaption_class=\"small-image-component-caption\"\n></Image> \n\n-->\n"
        }
    },
    {
        "dirent": {
            "name": "determine-product-version-numbers.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to determine ASNA product versions",
                "description": "How to get ASNA product version and build numbers for Windows and IBM i products.",
                "tags": [
                    "datagate-ibm-i",
                    "datagate-sql-server",
                    "licensing",
                    "mobile-rpg",
                    "monarch",
                    "synon-escape",
                    "visual-rpg",
                    "wings"
                ],
                "date_published": "2024-01-04T14:59:52.000Z",
                "date_updated": "2024-01-04T21:01:34.000Z",
                "date_created": "2024-01-04T21:01:34.000Z",
                "pinned": false
            },
            "content": "\nWhen you report an issue to ASNA tech support, or when you need a new or updated product license key, we'll usually need to know your exact product version(s).\n\n## Windows-based products\n\nVisual Studio has an \"about\" that shows some license information, but the ASNA licensing information that that dialog shows isn't detailed enough.\n\nThe best way to see what versions of ASNA software you have installed is to use Windows \"Programs and Features\" list launched from the Windows Control Panel (on either a desktop PC or a Windows server). That displays a list like the one shown below:\n\n![Windows programs and features](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/asna-programs-features.png)\n\nProduct names are shown in the \"Name\" column and the version number we need is in the \"Version\" column.\n\nIt's important to launch \"Programs and Features\" from the Control Panel to see this information. There are many ways to launch this applet:\n\n- Press Windows-X, and select \"Programs and Features\" at the top of the list\n- Press Windows-R (to launch the run command line window) and type `appwiz.cpl`\n- Open the Control Panel, select Programs, and then select Programs and Features\n\n## DataGate on the IBM i\n\n[This article shows how to determine what version of DataGate you're running on your IBM i.](/en/kb/get-datagate-library-name)\n\n"
        }
    },
    {
        "dirent": {
            "name": "nullable-types-with-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using nullable types with AVR for .NET FW",
                "description": "This article shows how, with a simple bit of prodding, to use them with ASNA Visual RPG for .NET Framework.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T19:11:03.000Z",
                "date_created": "2024-01-11T19:11:03.000Z",
                "pinned": false
            },
            "content": "\n[Nullable types](http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx) are data types that can contain a valid data type value _or_ be null. This article shows how, with a simple bit of prodding, to use them with ASNA Visual RPG for .NET Framework. \n\n**What are nullable types?**\n\nNullable types are special-case versions of .NET value types that represent either a valid value or null (`*Nothing` in AVR parlance). For example, a nullable Boolean variable would have one of three values: true, false, or null; a long integer would be either zero, a plus or minus value, or null; a date would be either a valid date value, the minimal date value (1/1/0001), or null. Nullable types are good for those times when a program needs to represent a value or the absence of a value. For example, consider an integer value, weight, which indicates the weight of a shipment. If weight is a numeric value, it represents the weight of the shipment; if it is null it means the shipment hasn’t yet been weighed. \n\nThe need for nullables is usually driven by either a database requirement (eg, a nullable column in a table) or nullable third-party control properties (eg, Telerik and Infragistics use nullable types in a few places). Use nullable types where you need them, but don’t get carried away with nullable types. The overuse of nullable types makes your program overly complex. However, for those times with you really need a nullable type (as in the case of the third-party controls) knowing the simple coercion it takes to make AVR nullable-type friendly will come in handy. \n\n**Nullable types are special-case generic types**\n\nNullable work only with [value types](http://msdn.microsoft.com/en-us/library/s1ax56ch(v=vs.120).aspx) and \"value type\" means variables of a numeric type. The full list of AVR value types [is shown here.](http://devnet.asna.com/documentation/help_files/avr81/avr2005_web/avrconFrameworkDataTypesComparison.htm)  Reference types (class instances and the \\*String data type, for example) are implicitly nullable by simply and directly assigning null to the variable. C# lets you define a nullable type by appending a question mark at the end of the type name (VB.NET uses of nullable types is similar to C#’s). For example, these three lines of C# declare a nullable long integer, a nullable DateTime, and a nullable Boolean.\n\n```\n    int? i;\n    DateTime? d;\n    Bool? b;\n```\n\nAlas, AVR doesn’t have the syntactical sugar to make declaring nullable types as concisely as C# does. The key to understanding AVR’s use of nullable types is to realize that under the covers, .NET, nullable types are implemented as a _generic type_ with a lightweight _immutable_ wrapper around it. There are a couple of five dollar words in that previous sentence. If you are familiar with them skip ahead to the _Nullable types with AVR section_. \n\n_Generic type:_ a generic type in the .NET Framework is one where a variable’s type is determined at compile time. AVR offers basic support for generics and you may be used to using them with the [System.Collections.Generic.List of (\\*Of T)](http://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx) (or its cousins in the System.Collections.Generic namespace). For example, this AVR declaration:\n\n```\nDclFld Customers Type(System.Generics.CollectionList(*Of Customer)) New()\n```\n\ndeclares a strongly typed list of the Customer class (a class you created). The type the Customers list contains, Customer, is determined at compile time. We’ll see in a moment how generic types relate to nullable types. \n\n_Immutable:_ [an immutable variable](http://en.wikipedia.org/wiki/Immutable_object) is a variable whose value doesn’t change during the life of the variable. Huh? A variable that can’t change sounds like a constant, doesn’t it? Well, yes. In this case, the confusion is driven partly by the oxymoronic phrase \"immutable variable\" and the pedantically correct, but misleading \"whose value doesn’t change.\" In .NET (and in many other languages as well), string variables are immutable. Consider this example of an immutable variable in AVR (because strings are implicitly immutable):\n\n```\nDclFld s Type(*String)\ns = \"Neil Young\"\n```\n\nYou could probably win a cold beer with this bet: \"I’ll betcha you can’t change the value of `s` as I’ve defined it in the two lines above.\" A colleague takes the bet and adds a third line:\n\n```\nDclFld s Type(*String)\ns = \"Neil Young\"\ns = \"Frank Sampedro\n```\n\nand then uses the debugger to prove that she did indeed change the value of `s`. Or did she? Technically speaking, when she assigned \"Frank Sampedro\" to `s`, she didn’t cause the value of `s` to change, rather, she caused the old variable `s` to be destroyed and a new string variable `s` to be created with the new value (the garbage collector dispatches the space consumed by the previous value). Strictly speaking, she owes you a beer! (The notion of immutability is actually much more substantial than this silly example makes it seem. To read more about immutability and its implications, read about [function programming and how immutability is used to isolate program state](http://en.wikipedia.org/wiki/Functional_programming) or about .NET’s [new immutable collections](http://msdn.microsoft.com/en-us/library/dn385366(v=vs.110).aspx).)\n\nWhen you do this in C#\n\n```\nint? i;\ni = 55;\ni = 65; \n```\n\nit appears as though the third line changed the value of the nullable variable `i`. While logically that is what happened, under the covers what really happened is that the original `i` was destroyed and a new one, with the new value 65 was created. The C# compiler’s syntactical sugar for nullable types hides away this new object creation. Alas, AVR doesn’t have that sugar—but there is a simple work-around. The key to using nullable types in AVR is to understand that each assignment to a nullable variable really creates a new instance of that variable.\n\n> The important thing to remember with AVR is that to assign a new value to a nullable type, you _always_ need to create a new instance of the nullable type.\n\n**Nullable types with AVR** The following two lines declare a nullable long integer and then assign it a value of 8. \n\n```\nDclFld x Type(System.Nullable(*Of *Integer4)) \nx = *New System.Nullable(*Of *Integer4)(8)\n```\n\nTo assign the nullable `x` a different value, you need to instance it again. \n\n```\nx = *New System.Nullable(*Of *Integer4)(16)\n```\n\nAfter executing the line above, `x's` value is now 16. It’s worth repeating: The important thing to remember with AVR is that to assign a new value to a nullable type, you _always_ need to create a new instance of the nullable type. **Nullable type considerations** Recall that nullable types always represent value types (which essentially means variables with numeric values). A nullable type changes a value type’s typical default value. For example, after this declaration:\n\n```\nDclFld y Type( *Integer4 ) \n```\n\n`y` has a default value of zero. However, after this nullable integer declaration:\n\n```\nDclFld x Type(System.Nullable(*Of *Integer4))\n```\n\n`x` has a default value of null, or `*Nothing` in AVR parlance. All nullable types have a null default value. This imposes special considerations to avoid assignment errors. For example, the following code: \n\n```\nDclFld x Type(System.Nullable(*Of *Integer4)) \nDclFld y Type(*Integer4) \n\ny = x\n```\n\ncauses a “Cannot convert type ‘System.Nullable’ to type ‘\\*Integer Len(4)” compile-time error. To avoid this problem, all nullable types provide a `Value` property. You should always use the `Value` property when assigning a nullable type. Alas, there is one other gotcha. For example, this code:\n\n```\nDclFld x Type(System.Nullable(*Of *Integer4)) \nDclFld y Type(*Integer4) \n\ny = x.value\n```\n\ncauses a runtime error. Can you spot the problem? The default value of `x` is null, and you can’t assign null to an integer. This generates a “Nullable object must have a value” error. You can avoid this error by wrapping the assignment in a Try/Catch, but nullable types offer more concise protection for this error: \n\n```\nDclFld x Type(System.Nullable(*Of *Integer4)) \nDclFld y Type(*Integer4) \n\nIf (x.HasValue)\n    y = x.value\nEndIf\n```\n\nIt’s usually always best to defensively wrap an assignment from a nullable type using the nullable’s type’s `HasValue()` property. Nullable types also offer one other assignment alternative: \n\n```\nDclFld x Type(System.Nullable(*Of *Integer4)) \nDclFld y Type(*Integer4) \n\ny = x.GetValueOrDefault()\n```\n\nA nullable type’s `GetValueOrDefault()` method can be used to assign the value of the nullable type, or if it doesn’t have one, its underlying type’s default value. After the assignment above, `y` would be zero.  **Making AVR nullable assignments more palatable**  We’re close to exceeding our gulp factor for nullables, but let’s smooth out one last little wrinkle as best we can. The assignment of new nullables to change a nullable’s value is clumsy in AVR. C# and VB both do it quite gracefully. Using a `*TimeStamp` nullable (just to switch things up) with AVR, the assignment of a new date value has to look like this:\n\n```\nDclFld d Type(System.Nullable(*Of *TimeStamp)) \n\nd = *New System.Nullable(*Of *TimeStamp)(1977,05,25) \n...\n...\nd = *New System.Nullable(*Of *TimeStamp)(1959,06,02)\n```\n\nWhere the values in the last set of parentheses (ie, the `(1977, 05, 25)` or the `(1959, 06 ,02)` are the values passed to the nullable’s underlying base type (in this case, a `DateTime` or `*TimeStamp` type). With a helper function, the assignment is done this way:\n\n```\nDclFld d Type(System.Nullable(*Of *TimeStamp)) \n\nd = NullableDateTime(*New DateTime(1977, 05, 25))\n...\n...\nd = NullableDateTime(*New DateTime(1959, 06, 02))\n```\n\nThis isn’t as clean as I wish it could be, but for my money it’s cleaner and a little more direct. Helper functions for Booleans, and DateTime, and long integers are provided below:\n\n```\nBegFunc NullableInteger Type(System.Nullable(*Of *Integer4))  \n    DclSrParm NewValue Type(*Integer4) \n\n    LeaveSr *New System.Nullable(*Of *Integer4)(NewValue)\nEndFunc \n\nBegFunc NullableBoolean Type(System.Nullable(*Of *Boolean)) \n    DclSrParm NewValue Type(*Boolean) \n\n    LeaveSr *New System.Nullable(*Of *Boolean)(NewValue)\nEndFunc \n\nBegFunc NullableDateTime Type(System.Nullable(*Of System.DateTime))\n    DclSrParm NewValue Type(System.DateTime)\n\n    LeaveSr *New System.Nullable(*Of System.DateTime)(NewValue)\nEndFunc\n```\n"
        }
    },
    {
        "dirent": {
            "name": "import-ole-print-file.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Importing AVR Classic COM print files to .NET Framework print files",
                "description": "This article describes a command-line provided by ASNA Visual RPG that imports COM print files into .NET print files. Visual RPG 16 is the last version of Visual RPG to include this utility.",
                "tags": [
                    "datagate",
                    "visual-rpg"
                ],
                "date_updated": "2024-08-29T20:32:30.000Z",
                "date_published": "2024-08-29T20:34:00.000Z",
                "date_created": "2024-08-29T20:32:30.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Callout from \"$components/text-decorators/Callout.svelte\"\n</script>\n\nAVR Classic's print files were 32-bit OLE COM objects. These print files are not compatible with Visual RPG's .NET Framework-based print files. AVR Classic 32-bit print files need an explicit conversion to work with AVR for .NET Framework. \n\nAVR 14 and 15 provides point-and-click facilities in the DataGate Explorer to import 32-bit print files into .NET Framework print files. With AVR 16 The point-and-click OLE print file import facility is discontinued and replaced by a command line utility. Both of these import processes are explained below. \n\nEffective with AVR 17 a 32-bit OLE print import will no longer be available. AVR 17 requires Visual Studio 2022 it imposes significant COM conflicts when attempting to convert 32-bit print files.\n\n\n<Callout\n    image=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/icon-images/string-on-finger.webp\"\n    font_size=\"1.2rem\"\n    font_style=\"italic\"\n>\n    Visual RPG 16 is the last version to offer any kind of 32-bit COM print file import facility. \n</Callout>\n\n<Callout\n    icon=\"fa-light fa-lightbulb\"\n    font_size=\"1.2rem\"\n    font_style=\"italic\"\n>\n    Visual RPG 16 is the last version to offer any kind of 32-bit COM print file import facility. \n</Callout>\n\n\n\nTo import 32-bit print files in AVR 14, 15, or 16, follow the instructions below. For any of the instructions below, your PC must have both your version of AVR Classic (either the dev or deployment package) and the target version of Visual RPG for .NET installed.\n\n## AVR for .NET Framework 14 and 15 targets\n\nVisual RPG for .NET Framework versions 14 and 15 included an AVR 32-bit print file converter accessed through the DataGate Explorer in Visual Studio. To convert a 32-bit print file to a .NET Framework print file in AVR 14 and 15:\n\n* create a Print File Definition Project in Visual Studio\n* Find the 32-bit print file in the DataGate Explorer and right-click it to a display a context menu (shown below in Figure 1. ) \n* Use the \"Convert & Copy OLE Print FileDef Source to Project\" menu option to convert the print file.\n* You can optionally drag and drop the 32-bit print file to an opened print file definition project in the Solution Explorer. \n\n![OLE print file context file menu](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/vs2025-ole-print-file-context-menu.webp)\n\n<small>Figure 1. AVR for .NET Framework 14 and 15's print file context menu</small> \n\n## AVR for .NET Framework 16 target\n\nAVR for .NET Framework 16 doesn't have the DataGate Explorer context menu that AVR 14 and 15 do. Rather, a command line utility is provided with AVR 16. That utility is named:\n\n```\nOlePrintFileToNetPrintFile.exe\n```\n\nand it is available at the path below. Each part of the path is shown on its own line for clarity. \n\n```\nC:\\\\Program Files (x86)\\\\\n    Microsoft Visual Studio\\\\\n    2019\\\\\n    Professional\\\\\n    Common7\\\\\n    IDE\\\\\n    Extensions\\\\\n    ASNA\\\\\n    Client Core Assemblies\\\\\n    16.0\\\\\n    OlePrintFileToNetPrintFile.exe\n```\n\nThe full name of the EXE can also be seen inside Visual Studio. Use Visual Studio's top-level Tools menu to see the full EXE name (shown in Figure 2 below):\n\n```\nTools>Options>DataGate>Printing\n```\n\n![Visual Studio 2022 print file conversion EXE location](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tools-options-datagate-printing-option.webp)\n\n<small>Figure 2. Using Visual Studio's Tools>Options... menu to see the utility path</small>\n\nThe full EXE name is the OLE upgrade program path setting shown on the right.\n\nThe command line utility needs three or four arguments to work:\n\n* _rdb_  - source DataGate Database Name\n* _src_ - 32-bit print file name (in the format libary/object name)\n* _wrd_ - destination DataGate Database Name (omit this argument if the target Database name is the same as the source DataGate Database name)\n* dest - converted .NET Framework print file (in the format libary/object name) \n\nFor example, to convert the 32-bit print file named `custrpt` in the `examples` library of the `*Public/MyDB` Database Name to a .NET Framework print file named `custrptdotnet` also in the `examples` library of the `*Public/MyDB` Database Name, use this command line:\n\n```\n...OlePrintFileToNetPrintFile.exe /rdb \"*Public/MyDB\" /src \"examples/custrpt\" \n    /dest \"examples/custrptdotnet\"\n```\n\nIn the command line above, the full path of the `OlePrintFileTo.NetPrintFile.exe`  utility is omitted for clarity and the command shown on two lines for clarity. You should include the full path to the to the utility and put all arguments on one line."
        }
    },
    {
        "dirent": {
            "name": "multiple-dg-instances-dbgsvcprf.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "The DG8SVCPRF user profile and multiple DataGate with IBM i instances",
                "description": "This article explains considerations the DG8SVCPRF user profile when you have multiple instances of DataGate for IBM i installed.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T21:14:30.000Z",
                "date_created": "1970-01-01T00:00:00.000Z",
                "pinned": false
            },
            "content": "\nThe following information applies to all GA releases of DataGate for IBM i (DG) from v15 through the current (v17).\n\n**When multiple DG instances are installed, can each instance have its own service *USRPRF (other than DG8SVCPRF)?**\n\nNo. `DG8SVCPRF` cannot be configured per-instance.  All instances of DG must share the same `*USRPRF` object, and it must be named `DG8SVCPRF`.\n\n**When a second DG instance is installed, is DG8SVCPRF deleted and recreated?**\n\nNo. If `DG8SVCPRF` exists (whether or not any DG instance is already installed), it is used as the service `*USRPRF` for the new instance. If `DG8SVCPRF` does not exist, the installer creates it via the `CRTUSRPRF` command.  In either case, the installer ensures `DG8SVCPRF` is assigned certain required attributes (more info below).\n\n**When a new DG instance is installed, is a new *JOBD created?**\n\nOnly if the installation library does not already contain a `*JOBD` object named `DG8SVCJOBD`, one is created there.  It is created via the `CRTDUPOBJ` command, which specifies the well-known system object `QDFTJOBD *JOBD`, residing in the `QGPL` library, as the `OBJ` source object parameter.  Whether or not the installer creates `DG8SVCJOBD`, it ensures the `*JOBD` has certain required attributes.  It invokes the `CHGJOBD` command, specifying the `JOBMSGQFL(*WRAP)` and `QLWMLTTHD(*NO)` parameters, and sends an `*ESCAPE` message if the command fails.  It also invokes the `CHGOBJOWN` command, specifying the `NEWOWN(QDFTOWN)` parameter, and sends an `*ESCAPE` message if the command fails.  \n\n**When a second DG instance is installed, is its *JOBD always associated with DG8SVCPRF?**\n\nYes. The installer ensures the `DG8SVCJOBD *JOBD` in the installation library is associated with `DG8SVCPRF` via the CHGUSRPRF command.  Whether or not `DG8SVCPRF` is created, the installer ensures the `*USRPRF` has this and other required attributes (see below).\n\n**What other attributes are assigned to DG8SVCPRF at installation time?**\n\nThe `CRTUSRPRF` command, if invoked by the installer (see above), is passed these parameters: \n* `PASSWORD(*NONE)` \n* `STATUS(*DISABLED)` \n* `USRCLS(*USER)`\n* `INLMNU(*SIGNOFF)`\n\nEven if the `DG8SVCPRF` is not created by the installer, the `CHGUSRPRF` command is always invoked on `DG8SVCPRF` with these parameters:\n\n* `STATUS(*DISABLED)`\n* `INLMNU(*SIGNOFF)` \n* `SPCAUT(*JOBCTL)` \n* `JOBD(&InstlLib/DG8SVCJOBD)` \n\nwhere `&InstlLib` is the target installation library.\n\n**The DG8SVCPRF `Status` should always be `*DISABLED`**\n\nThe DG8SVCPRF profile's `Status` should always be disabled to eliminate the possibility of someone using it to sign into an interactive session on the IBM i. Disabled IBM i user profiles _can_ submit jobs."
        }
    },
    {
        "dirent": {
            "name": "print-to-pdf-windows.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Print to PDF with Visual RPG and Windows",
                "description": "This articles shows how to use the Microsoft Print to PDF driver with ASNA Visual RPG and a Windows application.",
                "tags": [
                    "printing",
                    "visual-rpg"
                ],
                "date_updated": "2025-02-04T23:44:26.000Z",
                "date_published": "2025-02-04T23:47:00.000Z",
                "date_created": "2025-02-04T23:44:26.000Z",
                "pinned": false
            },
            "content": "\n<script>\nimport Image from \"$components/text-decorators/Image.svelte\";\nimport Callout from \"$components/text-decorators/Callout.svelte\"\n\nimport { page } from '$app/stores';\n\nconst locale = ($page.url.pathname.startsWith('/downloads')) ? \n     $page.pathname.url.slice(-2) : \n     $page.url.pathname.slice(1,3);\n\n</script>\n\n[View Source](https://github.com/ASNA/print-to-pdf-windows)\n\n[Download](https://github.com/ASNA/print-to-pdf-windows/archive/refs/heads/main.zip)\n\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/newsletter/enable-windows-pdf-driver.png\"\nalt=\"Enable the Microsoft PDF print driver as a Windows feature\"\nwidth=\"350px\" alignment=\"float-right\" hide_caption=false\n/>\n\nUntil Windows 10 and Windows Server 2016 came along, you needed to use a third-party PDF driver to print to PDF with Web applications. There are free PDF drivers available, but these low-end drivers aren't multi-threaded and they don't work with Web applications.\n\nEven for Windows apps, the low-end drivers are a hassle. If they allow you to specify the PDF file name, that task usually requires a registry hack&mdash;and that hack is iffy with Windows 11 increased levels of registration security.\n\nAlas, for several years now Microsoft has packaged a PDF print driver with both Windows and Windows Servers. The driver is a Windows feature and needs to be installed with the \"Windows features\" dialog (available through Windows \"Add or remove programs\" dialog). Make sure it is enabled before continuing. This intrinsic Windows print driver eliminates the need for third-party drivers such as those available from ActivePDF and Amyuni commercial drivers.\n\n\n<Callout\n    icon=\"fa-sharp fa-solid fa-circle-exclamation\"\n    font_size=\"1.2rem\"\n    font_style=\"italic\"\n>\n    See this article <a href=\"https://www.asna.com/{locale}/kb/windows-native-pdf-driver\">for using the Microsoft PDF driver</a> with a Web application.\n</Callout>\n\n\n## Isolating print code\n\nThis example includes a class that prints an ASNA Print File to either a physical printer or the \"Microsoft Print to PDF\" print driver in a Windows application. \n\nThere are special considerations for using the MS PDF driver with a \nWeb application. [See this ariticle for using the MS PDF driver \nwith an AVR web app.](https://www.asna.com/en/kb/windows-native-pdf-driver)\n\nI like to isolate printer code in a class for each print file. In this example, the \n`CustomerReport` does that. You don't have to use a class to use the techniques \nshown in this example. You can copy code from the class and copy it inline \ninto your code. That said, one of these days you'll be very grateful then if you \ntake the time to separate this code initially! \n \nUse the `CustomerReport` constructor that requires two arguments to print to a physical \nprinter or use the constructor that requires three arguements to print\nto a PDF file. \n                                                                                          \nTo print to a physical printer:\n\n```\nDclFld cr Type(CustomerReport) \t\nDclFld PrinterName Type(*String) \nDclFld UsePrintSetup Type(*Boolean) \n\nPrinterName = \"HP LaserJet 1020 (redirected 2)\"\nUsePrintSetup = *True \n\n// If UsePrintSetup is *True then printer setup is shown.\ncr = *NEW CustomerReport(PrinterName, UsePrintSetUp) \ncr.Print()\n\nTry \n    cr.Print()\n    MsgBox String.Format(\"File printed\") \nCatch Type(Exception) Name(ex)\n    MsgBox String.Format(\"ERROR :\" + ex.Message) \nEndTry \n```   \n\nTo print to a PDF file with the MS native PDF print driver:\n\n```\nDclFld cr Type(CustomerReport) \t\nDclFld PrinterName Type(*String) \n\ncr = *NEW CustomerReport(PrinterName) \n\nDclFld PrinterName Type(*String) \nDclFld PDFOutputFolder Type(*String) \nDclFld PDFFileName Type(*String) \n\nPrinterName = \"Microsoft Print to PDF\"\nPDFOutputFolder = \"C:\\\\Users\\\\thumb\\\\Documents\\\\projects\\\\avr\\\\pdf-files\"\n\n// Existing PDF files are overwritten! \nPDFFileName = \"test.pdf\"\n\nDclFld cr Type(CustomerReport) \t\n\t\t\ncr = *NEW CustomerReport(PrinterName, PDFOutputFolder, PDFFileName) \nTry \n    cr.Print()\n    MsgBox String.Format(\"File {0} created in {1}\", PDFFileName, +\n        PDFOutputFolder) \nCatch Type(Exception) Name(ex)\n    MsgBox String.Format(\"ERROR :\" + ex.Message) \nEndTry \n```   \n\n<a href=\"https://github.com/ASNA/print-to-pdf-windows/blob/main/CustomerReport.vr\">Click here to see the code for the CustomerReport class.</a>\n\n<p></p>\n\nWhen printing to the MS native PDF driver, the printer name\nmust be:\n\n```\nMicrosoft Print to PDF\n```\n\nIf you have trouble with this code, use MS Word to save a sample document \nthe MS PDF driver to ensure the driver is available. That will help confirm the driver is working.\n\nYou cannot show the printer setup in a Web app. The entire printer configuration must specified programmatically for Web apps. "
        }
    },
    {
        "dirent": {
            "name": "get-datagate-library-name.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to determine DataGate for IBM i's library and version info",
                "description": "How to confirm the library that your DataGate for IBM i instance uses. ",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2023-12-29T10:54:25.000Z",
                "date_updated": "2023-12-29T18:13:09.000Z",
                "date_created": "2023-12-29T18:13:09.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Image from '$components/text-decorators/Image.svelte'\n</script>\n\n\n## Question\n\nHow can I determine what version and build of ASNA DataGate for IBM i, and what its library name is, my system is using?\n\n## Answer\n\nASNA DataGate for IBM i is an IBM i host service that serves IBM i data to ASNA clients such as ASNA Visual RPG, Wings, and Mobile RPG. These instructions show you what version(s) of DataGate are running on your system.\n\nThe data area named `reldate` in your DataGate for IBM i library shows the DataGate version and build number. \nIf you installed DataGate to its default library, which is `DG8_xxx` (where `xxx` is your DataGate for IBM i version number) use this command to see the `reldate` data area:\n\n`DSPDTAARA DG8_160/RELDATE`\n\nThis shows your DataGate for IBM version and number number (in the red box below) as shown in the figure below:\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/current-version.png\" alt=\"DataGate version and build number shown in red box.\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nIf you don't know the DataGate library on your IBM i, then use the steps below to determine what version of DataGate is currently running on your system:\n\n**Step 1.**           First, use WRKACTJOB and find the DG8SVC jobs. For each instance of DataGate for IBM i, there is one DB8SVC job where the Function column is \"CMD-DG8SVC.\" Two of those jobs are shown in the screenshot below. This indicates there are two separate instances of DataGate running on this IBM i. In most installations, there is only one version of DataGate running. If you do see more than one DG8SVC job where the Function column is \"CMD-DG8SVC\" do steps 2 and 3 for each of those jobs.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/dg8-cmd-dg8svc.png\" alt=\"Show active DG IBM i jobs\" width=\"600\" alignment=\"center\" caption=\"Figure 2a.\"/>\n\nIf you know what subsystem DataGate is running in, you can also use WRKSBSJOB to find the DG8SVC jobs. For example, if DataGate is running from QINTER, this command\n\n`WRKSBSJOB QINTER`\n\nlists only the jobs initiated from that subsystem.\n\n**Step 2.** To show what library your DataGate for IBM i instance resides in, select a DG8SVC/CMD-DG8SVC job and use option 5 to work with that job. Then use option 10 to display its job log. This shows the library from which the DG8SVC job was launched (as shown below).  Note that if you have multiple instances of DataGate installed you may need to check more than one DG8SVC/CMD-DG8SVC job.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/current-lib.png\" alt=\"Show DataGate library name\" width=\"600\" alignment=\"start\" caption=\"Figure 2b.\"/>\n\nBy default, a DataGate library is named DG8\\_xxx where xxx = is the DataGate version number. However, some customers rename that library while installing DataGate so rather than assuming what the DataGate library is, it's better to use this Step 2 to know what it is for sure.\n\n**Step 3.** Knowing DataGate's library name, display the DataGate version with\n\n`DSPDTAARA [library]/RELDATE`\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/current-version.png\" alt=\"Show DataGate library in RELDATE data area\" width=\"600\" alignment=\"center\" caption=\"Fig 2c.\"/>\n\nThe contents of the `RELDATE` data area show the DataGate version number. In the screenshot above you can see that this version is DataGate 16.0.8.0. \n\nBonus info: This data area shows the TCP/IP port to which DataGate is bound. The TCP/IP port is the first set of numbers after the subsystem (shown in the blue rectangle above). In this case, DataGate is bound to port 5160."
        }
    },
    {
        "dirent": {
            "name": "datagate-for-ibm-i-end-user-jobs.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How do I find ASNA DataGate for IBM i end-user jobs?",
                "description": "How to find active DataGate for IBM i end user jobs. ",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-01-05T12:35:56.000Z",
                "date_updated": "2024-01-05T19:03:23.000Z",
                "date_created": "2024-01-05T19:03:23.000Z",
                "pinned": false
            },
            "content": "<script>\n    import Image from '$components/text-decorators/Image.svelte'\n</script>\n\n\nTo find all ASNA DataGate for IBM i active end-user jobs use the IBM i WRKACTJOB (or WRKSBSJOB) command and look for DG8\\_NET .NET jobs. The green rectangle in the screenshot below shows DataGate for IBM i active end-user jobs. End user jobs are the DG8\\_NET jobs.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/dg-user-jobs-1.png\" alt=\"Seeing DataGate end-user jobs with WRKACTJOB\" width=\"600\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nNote: All DataGate end-user jobs must be ended before ending the DataGate server. As shown above, end-user jobs are the DG8\\_NET jobs. Do not end DataGate server if any DG8\\_NET jobs are present. Those jobs need to be ended before you end DataGate server--otherwise you could have trouble restarting DataGate.\n\n## To see what version of DataGate a DG8\\_NET job is running\n\n- Use Option 5 to work with the job\n- Use Option 11 to see the call stack\n- Scroll through the list and you'll see the active DG library listed\n\nHere are a couple of other things to remember about DataGate end-user jobs:\n\n- DataGate end-user jobs (DG8\\_NET jobs) do not end when DataGate is ended-they continue to run. DataGate does not reach out and end end-user jobs on its own.\n- When you look at an active end-user job with WRKACTDJOB (or other says such as WRKSBSJOB), the user shown is the user identified in the database name. In the screenshot above the multiple WEBDEMO1 users are a pretty good clue that this is a Web app where all users are using the same database name.\n- If DataGate end-user jobs are running when DataGate restarts, your licensed user counts may be wrong. When DataGate ends, so does its license manager. When the license manager goes down it loses the count of seats. Then when it comes back up, there's likely to be an over-count at recovery. For example, suppose you are running something that is using two DG400 jobs from your PC. Before the license manager goes down, that counts as one seat. When it comes back on a restart, the license manager can't tell what job is which seat, so it counts your jobs as two seats. To resolve this, affected users need to end their jobs and restart them.\n- Ending DataGate versions earlier than 14.x with running jobs often causes problems restarting DataGate. DataGate won't restart until those jobs are ended because of an \"error binding socket\" issue.\n- As you can see, while DataGate can be ended with active end-user jobs, the best practice is to not do that. Generally, you'll want to make sure all users are logged and their jobs have ended before ending DataGate.\n\n"
        }
    },
    {
        "dirent": {
            "name": "change-datagate-subsystem.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to put ASNA DataGate for IBM i in its own subsystem",
                "description": "This article how to create a dedicated subssystem for an existing existing DataGate on an IBM i installation.",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-03-19T12:35:56.000Z",
                "date_updated": "2024-03-19T19:03:23.000Z",
                "date_created": "2024-03-19T19:03:23.000Z",
                "pinned": false
            },
            "content": "\nThis article shows how to create a dedicated subsystem for an existing DataGate for IBM i installation. \n\n> This is not an end-user task and doing it incorrectly can at the least disable DataGate and at the worst disable your IBM i. \n\n> Before attempting to do this on your IBM i please perform a system backup of your current configuration and familiarize yourself with each command. If you're not familiar with changing your IBM i configuration please coordinate with your System Administrator. We strongly recommend doing this on a dedicated system with no other current users. It may also be helpful to consult your system's documentation for more information regarding subsystems and job performance. \n\n## Step 1. End DataGate on your IBM i\n\nBefore you perform this step make sure there are no [end-user DataGate jobs](/en/kb/datagate-for-ibm-i-end-user-jobs) running on your IBM i.\n\n```\n<DataGate_Library>/ENDDG8SVR\n```\n## Step 2. Create a new subsystem description\n\nThe following command uses parameters values that most closely match the attributes of the `QINTER` subsystem. You may want to use other parameters to suit the application. Here, the new subsystem description has been named `ASNADG` and has been placed in the installation library:\n\n```\nCRTSBSD SBSD(<DataGate/Library>/ASNADG) + \n    POOLS((1 \\*BASE) (2 \\*INTERACT)) + \n    TEXT('ASNA Datagate subsystem')\n```    \n\nIn this article, `<DataGate/Library>` refers to the library into which DataGate is installed and the new subsystem name is `ASNADG`. Change that to the subsystem name you want. See [this article to determine what library DataGate is installed in on your system](/en/kb/get-datagate-library-name).\n\n## Step 3. Remove the default DataGate job queue entries from `QINTER`\n\n```\nRMVJOBQE SBSD(QINTER) JOBQ(<DataGate_Library>/DG8_SVC)\n```\n\nand \n\n```\nRMVJOBQE SBSD(QINTER) JOBQ(<DataGate_Library>/DATAGATE) \n```\n   \n## Step 4. Create job queue entries in the new subsystem description\n\n```\nADDJOBQE SBSD(<DataGate_Library>/ASNADG) +\n    JOBQ(<DataGate_Library>/DG8_SVC) +\n    MAXACT(*NOMAX) SEQNBR(11)\n```\n\nand \n\n```\nADDJOBQE SBSD(<DataGate_Library>/ASNADG) + \n    JOBQ(<DataGate_Library>/DATAGATE) +\n    MAXACT(*NOMAX) SEQNBR(12) \n```    \n\n## Step 5. Create a \\*CLS object\n\nOnce again, parameters like those found in the `QINTER` subsystem are used here. The class is given the same name as the subsystem description and is placed in the same library:\n\n```\nCRTCLS CLS(<DataGate_Library>/ASNADG) RUNPTY(20)\n```\n## Step 6. Create a new routing entry\n\nCreate a routing entry in the new subsystem and attach the class created in the previous step (with the CLS parameter). The command parameters here also resemble `QINTER's` configuration:\n\n```\nADDRTGE SBSD(<DataGate_Library>/ASNADG) +\n    SEQNBR(9999) +\n    CMPVAL(*ANY) +\n    PGM(QSYS/QCMD) +\n    CLS(*SBSD) +\n    MAXACT(*NOMAX) +\n    POOLID(2)\n```\n\n## Step 7. Start the subsystem\n\nYou may also want to add this command to `QSTRUP` or whatever script that runs at IBM i startup (its IPL). After this has been executed, the ASNADG subsystem should show up in a `WRKACTJOB` display (with no jobs):\n\n```\nSTRSBS SBSD(<DataGate_Library>/ASNADG)\n```    \n    \n## Step 8. Start DataGate for IBM i \n\n```\n<DataGate\\_Library>STRDG8SVR\n```\n\nIf the [usual DataGate server jobs](/en/kb/understanding-datagate-for-ibm-i-service-jobs) don't show up in a `WRKACTJOB` display there is a problem with the configuration. There will likely be a job log for the failed `SBMJOB` command used to start the DataGate server. `WRKSPLF DG8SVCPRF` usually indicates what the problem is.\n\n"
        }
    },
    {
        "dirent": {
            "name": "generic-collections-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using Generic Dictionaries With AVR",
                "description": "This article shows how to use .NET Framework's generic collections with ASNA Visual RPG for .NET Framework.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T20:02:36.000Z",
                "date_created": "2024-01-11T20:02:36.000Z",
                "pinned": false
            },
            "content": ".NET has had generic data types since .NET 2.0. However, many AVR coders aren’t aware of these powerful data structures and how much time they can save. In this article we’ll take a look at using generic dictionaries in AVR for .NET. Old school RPG programmers will recognize [dictionaries](http://en.wikipedia.org/wiki/Dictionary_%28data_structure%29) as the distant cousin of green-screen RPG’s alternating tables–except much better!\n\nBefore we dig into generic data types, let’s review the [Hashtable](http://msdn.microsoft.com/en-us/library/aahzb21x%28v=vs.100%29) from the System.Collections namespace. Prior to .NET acquiring generic data structures, the Hashtable was the primary go-to data structure to use for implementing a dictionary. The Hashtable provides two “columns,” a key and a corresponding value. These values are not strongly typed–they are \\*Object type values. Thus, you can use any data type as a key and any data type as a value. While at first this sounds handy, this loose typing causes some extra work and some potential problems at runtime. If you come to AVR for .NET from AVR Classic, the Hashtable is similar to AVR Classic’s collections.\n\nLine 4, in Figure 1a below, shows some of the friction this loose typing causes. In this case we’re accumulating an integer value and associating it with the string value “1994.” While it seems like it should be as easy as assigning a zero to that key value, it’s not. In AVR, a literal zero is actually a System.Decimal type–not the integer type it appears to be. It’s necessary to use the cumbersome casting of the literal zero to get an integer zero associated with the “1994″ key. The general frustration of casting in .NET is usually familiar to most AVR coders.\n\nThe casting friction continues in Figure 1b’s line 6, where once again the current value associated with “1994″ must be cast to an integer before it can be incremented. Another problem with the loose typing of the System.Collections.Hashtable is that you can assign any type to the key or the value at anytime. It’s up to the programmer to ensure she’s assigning correct data types to the Hashtable. If a mistake is made, the compiler won’t catch it but you’ll get a nasty error at runtime.\n\n```\nDclFld ht Type( System.Collections.HashTable ) New()\nDclFld i  Type( *Integer4 ) \n\nht.Add( \"1994\", ( 0 *As *Integer4 ) ) \n\nht[ \"1994\" ] = ( ht.Item[ \"1994\" ] *As *Integer4 ) + 12\n\ni = ht[ \"1994\" ] *As *Integer4\n```\n\nFigure 1b below shows how a [System.Collections.Generic.Dictionary](http://msdn.microsoft.com/en-us/library/xfhwa508%28v=vs.80%29) eliminates the casting friction. When this Dictionary is declared, you must explicitly declare its key and value types. The declaration of generic types in AVR uses [the VB-like Of syntax](http://msdn.microsoft.com/en-us/library/w256ka79%28v=vs.80%29.aspx) (as opposed to the angle bracket style of C#). Read this declaration as saying, “Declare a dictionary with string key and a corresponding integer value.” Strings are usually used as key types, but you may have good reasons to use other types for keys as well. You can also use any type for the value “column,” in this case I used an integer.\n\n```\nDclFld d  Type( Dictionary( *Of String, *Integer4 ) )  New()\nDclFld i  Type( *Integer4 ) \n\nd.Add( \"1994\", 0 ) \n\nd[ \"1994\" ] = d.Item[ \"1994\" ] + 12\n\ni = d[ \"1994\" ]\n```\n\n### A bigger example\n\nThis console application example below in Figure 2 shows the System.Collections.Generic.Dictionary in a slightly broader context. In this case you can see how a key value can be conditionally added using the ContainsKey() method.\n\nThere are many generic collections in the [System.Collections.Generic](http://msdn.microsoft.com/en-us/library/0sbxh9x2%28v=vs.80%29) namespace. That namespace provides the [KeyValuePair](http://msdn.microsoft.com/en-us/library/8e2wb99w%28v=vs.80%29.aspx) class which can be used for traversal of most of the generic collections. You can see the KeyValuePair type in action in the For/Each loop in lines 33-35 of Figure 2 below.\n\n```\nUsing System\nUsing System.Collections\nUsing System.Collections.Generic\nUsing System.Text\n\nBegClass Program\n\n    BegSr Main Shared(*Yes) Access(*Public) Attributes(System.STAThread())\n        DclSrParm args Type(*String) Rank(1)\n\n        DclFld Totals  Type( Dictionary( *Of String, *Integer4 ) )  New()\n        DclFld kv      Type( KeyValuePair( *Of *String, *Integer4 ) )\n\n            If ( NOT Totals.ContainsKey( \"1994\" ) )\n            Totals.Add( \"1994\", 0 )\n        EndIf\n\n        Totals[ \"1994\" ] = Totals[ \"1994\" ] + 34\n        Totals[ \"1994\" ] = Totals[ \"1994\" ] + 12\n        Totals[ \"1994\" ] = Totals[ \"1994\" ] +  4\n\n            If ( NOT Totals.ContainsKey( \"2012\" ) )\n            Totals.Add( \"2012\", 0 )\n        EndIf\n\n        Totals[ \"2012\" ] = Totals[ \"2012\" ] +  34\n        Totals[ \"2012\" ] = Totals[ \"2012\" ] +  12\n        Totals[ \"2012\" ] = Totals[ \"2012\" ] + 104\n\n        Console.WriteLine( \"1994 = \" + Totals[ \"1994\" ].ToString() )  \n        Console.WriteLine( \"2012 = \" + Totals[ \"2012\" ].ToString() ) \n\n        ForEach kv Collection( Totals ) \n            Console.WriteLine( kv.Key + \" = \" + kv.Value.ToString() ) \n        EndFor \n\n        Console.WriteLine( \"Press any key to continue...\" )\n        Console.ReadKey()\n    EndSr\n\nEndClass\n```\n\nGeneric collections are a very powerful addition to your AVR kitbag. Explore them when you get time. They will save you some time and make your code safer and easier to read.\n"
        }
    },
    {
        "dirent": {
            "name": "regex-part1.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "An introduction to regular expressions with ASNA Visual RPG",
                "description": "This is part 1 of 2 about using regular expressions with ASNA Visual RPG",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T20:52:33.000Z",
                "date_created": "2024-01-09T20:52:33.000Z",
                "pinned": false
            },
            "content": "\n\nRegular expressions (regex) provide a pattern matching scheme you can use to search and manipulate strings. Although regex has been around for almost 50 years, it is often either completely ignored or relegated to the “will learn later” pile by many programmers. Regex is indeed borderline witchcraft that at first glance looks like it was culled from the script of [Plan 9 from Outer Space](https://www.youtube.com/watch?v=Ln7WF78PolA). (It wasn’t!).\n\nThere is an old programming adage that goes: “One time I had a problem so I tried to solve it with regular expressions. Now I have two problems.” If you’re not careful, that old saying sums up regex well. If you get in a hurry or try to over-complicate things, regex will get you in more trouble than cheating on your taxes. But with a little effort and practice, knowing how and when to use a regular expression to solve a problem will make your code better, easier to read (really!), and easier to maintain (also really!).\n\nSo put your tray tables in their upright and locked positions and let’s take regular expressions for a spin in ASNA Visual RPG.\n\n### What are regular expressions?\n\nRegular expressions are a way to search, replace, and manipulate string values. Regular expression syntax provides a succinct grammar for identifying parts of a string. This concise grammar can be a bit overwhelming at first, but with a little effort it’s not as bad at is initially seems—especially for basic regular expressions. And, remember, the trade-off for a regular expression’s awkwardness is that it’s doing what would otherwise lots of logic and conditional testing.\n\nRegular expressions can be used directly in at least four places with AVR for .NET:\n\n1.  In AVR language to work with your own strings\n2.  In the Visual Studio’s editor to perform search and replace\n3.  With the regular expression validator for ASP.NET\n4.  In JavaScript for browser-based development\n\nRegular expressions are generally a cross-platform facility, however there are two families of regular expression engines: PCRE (Perl Compatible Regular Expressions) and Posix (Portable Operating System Interface). .NET’s regex engine is a PCRE derivative, as are PHP, PERL, and JavaScript regex engines. While there are some minor differences across different implementations, generally any PCRE-based regex tutorial or online regex testing site will work with AVR and .NET.\n\nThroughout this article, you’ll see several “Try this pattern online” buttons. Those buttons link to specific exercises on the excellent [Regular Expression online playground](https://regex101.com). It provides a superb way to experiment with regular expressions. There are a couple of examples below that iterate over a regex result and those don’t work well in the online tester. To test them, copy and paste the code in an AVR project. Other online references include:\n\n[MS Regex quick reference](https://msdn.microsoft.com/en-us/library/az24scfc%28v=vs.110%29.aspx)\n\n[.NET Framework Regular expressions](https://msdn.microsoft.com/en-us/library/hs600312%28v=vs.110%29.aspx)\n\n### A simple regex match\n\nThe .NET namespace [System.Text.RegularExpressions](https://msdn.microsoft.com/en-us/library/system.text.regularexpressions%28v=vs.110%29.aspx) provides a variety of classes to perform regex work in AVR. This article uses several of those classes. All of the following code assumes\n\n```\nUsing Sytem.Text.RegularExpressions\n```\n\nis at the top of your class. Regular expressions attempt a match at an input string against a given regex pattern. Let’s assume that we have two variables declared:\n\n```\nDclFld Source Type(*String)\nDclFld Re Type(*String) \n```\n\n`Source` is to contain the searched string and `Re` is to contain the regular expression. Let’s start with something very simple using the [`Regex class's Match() method`](https://msdn.microsoft.com/en-us/library/twcw2f1c%28v=vs.110%29.aspx). (Don’t get confused, this `Match()` method returns an instance of the [`Match`](https://msdn.microsoft.com/en-us/library/system.text.regularexpressions.match%28v=vs.110%29.aspx) class.)\n\n```\nDclFld m Type(Match) \n```\n\nWith the necessary declarations, here is a very simple regex example:\n\n```\nSource = 'Hello, World'\nRe = 'll'\n\nm = Regex.Match(Source, Re)\nIf m.Success\n    // Occurrence found.\nElse\n    // Occurrence not found.\nEndIf\n```\n\n[Try this pattern online](https://regex101.com/r/tN7gQ4/2) \n\nThe example above looks for a match in the `Source` field to the `Re` field. Checking the value of the `Match` class the `Match()` method returned reports the success of the match. In this case, `Hello, World` contains `ll` so `m.Success` is true.\n\nIn addition to its `Success` property, the `Match` object that `Match()` returns the additional information about the match including the starting location of the match, its length, and its value. If you don’t need the `Match` instance, you can use this shorthand for the `Match()` method:\n\n```\nIf (Regex.Match(Source, Re).Success)\n    // Occurrence found.\nElse \n    // Occurrence not found.\nEndIf\n```\n\nAs currently written, this match is case-sensitive. Using an optional third argument to the `Match()` method removes the match case-sensitivity (you’ll later see another way to impose case insenstivity on regular expressions).\n\n```\nSource = 'Hello, World'\nRe = 'LL'\n\nm = Regex.Match(Source, Re, RegexOptions.IgnoreCase)\n```\n\nThe match above succeeds because the `RegexOptions.IgnoreCase` argument was provided. In subsequent `Match()` method examples, the code to execute when the match succeeds is omitted.\n\n### Some basic Regex special characters\n\nMastering regular expressions requires you to master a lot of arcane special-case patterns. At first, this gobbledy-goop is indeed overwhelming. But, one bite at a time, it starts to make sense. This next example introduces some regex special characters. These are characters, that unless escaped, have special meaning to regular expressions. Let’s start with regex _anchors_. Although [this page](https://msdn.microsoft.com/en-us/library/az24scfc%28v=vs.110%29.aspx#atomic_zerowidth_assertions) shows eight of them, the first two, `^` and `$`, are all you need to know for now. `^` anchors a match at the beginning of a string, and `$` matches a search at the end of the string. An example or two explains anchors best.\n\n```\nSource = 'Hello, World'\nRe = '^ll'\nm = Regex.Match(Source, Re)\n```\n\nThe match above fails because it looks for `ll` at the beginning of the string.\n\n```\nSource = 'Hello, World'\nRe = '^He'\nm = Regex.Match(Source, Re)\n```\n\nThe match above succeeds because it looks for `He` at the beginning of the string.\n\n```\nSource = 'Hello, World'\nRe = 'll$'\nm = Regex.Match(Source, Re)\n```\n\nThe match above fails because it looks for `ll` at the end of the string.\n\n```\nSource = 'Hello, World'\nRe = 'orld$'\nm = Regex.Match(Source, Re)\n```\n\nThe match above succeeds because it looks for `orld` at the end of the string.\n\nTo search a string for one of the special case anchor characters, use the `\\` escape character.\n\n```\nSource = 'x = 6^2'\nRe = '\\^'\nm = Regex.Match(Source, Re)\n```\n\nThe match above succeeds because the `\\` escape character changes what would have otherwise been the `^` anchor character to an absolute character to match. See if you can determine what this match is doing:\n\n```\nSource = '^I love wolverines'\nRe = '^\\^'\nm = Regex.Match(Source, Re)\n```\n\n[Try this pattern online](https://regex101.com/r/pG1vT5/1) \n\nThe match above succeeds because it looks for a string that starts with `^`. Crazy, huh. Comprehending regular expressions takes a little practice. Don’t get discouraged. What if you need to search for `\\`? escape the escaper!\n\n```\nSource = '\\\\mycomputer\\document'\nRe = '^\\\\\\\\'\nm = Regex.Match(Source, Re)\n```\n\nThe match above succeeds by looking for a string that beings with two `\\` characters, by escaping the escape character.\n\nTo make regular expressions easier to use you might be inclined to use a little white space to make the regex pattern a little more readable:\n\n```\nSource = '^I love wolverines'\nRe = '^ \\^'\nm = Regex.Match(Source, Re)\n```\n\nHowever, that just broke the match. Now, the regex is looking for a string that starts with a space and then a `^` character. A single space is just that–a search for a single space. You have to be as careful with white space as you are with any other character in your regular expressions. Two other regex special character are `(` and `)`. The are used to group expressions. Although we’ll later see how grouping expressions can lead to some very sophisticated matching, for now, let’s use grouping just to improve regex readability.\n\n```\nSource = '^I love wolverines'\nRe = '^(\\^)'\nm = Regex.Match(Source, Re)\n```\n\nGrouping the second `\\^` pattern makes this regular expression a little easier to read. You can almost think of parentheses as adding punctuation to regular expressions. This article series uses regex grouping for readability quite often. To search for the absolute `(` or `)` characters, escape them with a backslash character (`\\`).\n\n```\nSource = '(I can''t get no) Satisfaction'\nRe = '\\)'\nm = Regex.Match(Source, Re)\n```\n\nThe match above succeeds in finding the closing `)` by escaping it. Note the repeating single quote marks in the match above. It could have also been written as:\n\n```\nSource = \"(I can't get no) Satisfaction\"\nRe = '\\)'\nm = Regex.Match(Source, Re)\n```\n\nThat single quote/double quote issue is an  AVR issue, not a regular expression issue.\n\n### That’s all for now\n\nIn the next installment we’ll take a look at regular expression character classes and qualifiers.\n"
        }
    },
    {
        "dirent": {
            "name": "open-query-file.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using Open Query File with ASNA Visual RPG",
                "description": "Open Query File is an older IBM i feature that provides some SQL-like operations to RPG's record level access. This aricle shows how to use Open Query File with ASNA Visual RPG.",
                "tags": [
                    "datagate-ibm-i",
                    "visual-rpg"
                ],
                "date_published": "2023-12-28T18:20:19.000Z",
                "date_updated": "2023-12-28T18:20:19.000Z",
                "date_created": "2023-12-28T18:20:19.000Z",
                "pinned": false
            },
            "content": "\n[<i class=\"fa-brands fa-github\"></i> See this project on GitHub](https://github.com/ASNA/AVR-Open-Query-File)\n\nFinding records where a field contains a given value is an awkward thing to do with RPG's record-level access. In either green-screen RPG or ASNA Visual RPG (AVR), the ugly solution is simple, loop over every record in the file checking each field as you go. This works, but have something nearby to keep you occupied while you wait.\n\nIntermediate to advanced coders may turn to embedded SQL with green-screen RPG or use ADO.NET with AVR. This is a good solution, but requires troublesome setup and configuration for the .NET managed data provider-and SQL knowledge.\n\n## The Open Query File alternative\n\nHowever, a good alternative does lurk in the form of AVR's support of Open Query File. The IBM i's Open Query File (OQF) is a rich and deep set of features. On the IBM i side of things you can do lots with OQF. However, IBM i programmers have pretty much relegated OQF to the sidelines with the advent of IBM i's superior SQL-based options. AVR provides support for a subset of OQF facilities which generally encompass OQF's QRYSLT and KEYFLD keywords. Don't expect to be able to do with AVR all that you can do with ILE RPG using OQF, but even with limited power, using OQF with AVR can provide some excellent results. As always, test, test, test. If you do something cool with IBM i's OQF and AVR, please let us know. Read more about IBM i's           [Open Query File here](https://www-01.ibm.com/support/knowledgecenter/ssw_ibm_i_72/cl/opnqryf.htm)           .\n\nOpen Query File is pretty smart and does a good job brute-forcing its way through files, even when queries are specified that don't have a corresponding previously-created access path. That said, test your queries carefully. Throw a sloppy enough query at OQF and you might make smoke come out of your IBM i.\n\nDataGate does support OQF on DataGate for Windows (AKA the local ASNA database) and DataGate for SQL Server but results limited to simple select values.\n\n> Note that DataGate does not support updating Open Query Files.\n\n## Get to it!\n\nThis simple example shows how to extract records from a file searching the customer name for a given string anywhere in the customer name. The input is an indexed logical file keyed on customer name and customer number. A code narrative follows the code below.\n\n> The use of                `\n>                     qsystrntbl\n>                `                is unique to DataGate on the IBM i and does not work with DataGate for SQL Server or DataGate for Windows and Servers.\n\n```\nBegClass Test\n\n    DclDB pgmDB DBName( \"*Public/Cypress\" )\n\n    DclDiskFile  Cust +\n        Type( *Input) +\n        Org( *Indexed) +\n        Prefix( Cust_) +\n        File( \"Examples/CMastNewL1\") +\n        DB( pgmDB) +\n        ImpOpen( *No )\n\n\n    BegSr Run Access(*Public)        \n        DclFld QueryMask  Type(*String) \n        DclFld QueryValue Type(*String) \n        DclFld Query      Type(*String) \n\n        Connect pgmDB \n\n        Cust.QryKeyFlds = \"CMCustNo *ASCEND\"\n        QueryValue = \"CANADA\"\n        \n        QueryMask = \"%XLATE(CMNAME qsystrntbl) *CT '{0}'\"\n        Query = String.Format(QueryMask, QueryValue)         \n\n        Cust.QrySelect = Query\n\n        Open Cust \n\n        Read Cust \n        DoWhile NOT Cust.IsEof\n            Console.WriteLine(Cust_CMName)\n            Read Cust \n        EndDo \n\n        Close *All\n        Disconnect pgmDB         \n    EndSr\nEndClass\n```\n**Lines 1 - 9.**\n\nDeclare the database object and the disk file. The           `\n               ImpOpen(*No)\n          `           requires the file must be explicitly opened in the code. This is an OQF requirement.\n\n**Line 18.**\n\nSpecify the fields to include in the query output and optionally their sorting sequence by assigning them to the           `\n               Cust\n          `           file's QryKeyFields property.\n\n**Line 19.**\n\nThe           `\n               QueryValue\n          `           field is the query value that, although hard coded here, would normally be provided by the end user at runtime. In this case, we're looking for all customer names that contain 'AND SONS'.\n\n**Lines 21 - 22.**\n\nThe           `\n               QueryMask\n          `           field provides the base value to be passed as AVR's OQF's QrySelect value. The           `\n               String\n          `           class's static           `\n               Format\n          `           method interpolates the           `\n               QueryValue\n          `           with the           `\n               QueryMask\n          `           field. This results in the           `\n               Query\n          `           field having the value:\n\n```\n%XLATE(CMNAME qsystrntbl) *CT 'AND SONS'\n```\nThis query is using some IBM i Open Query File magic that I learned way back in my formative years. Break it into three pieces to understand it:\n\n1. `\n                    %XLATE(CMNAME qsystrntbl)\n               `\n               passes the\n               `\n                    CMNAME\n               `\n               field to the\n               `\n                    %XLATE\n               `\n               function which uses the qsystrntbl IBM i translation table to return the uppercase value of the CMNAME field. See Example #2\n               [near the bottom of this page for more on\n                    `\n                         %XLATE\n                    `\n                    and\n                    `\n                         qsystrntbl\n                    `\n                    .](https://www-01.ibm.com/support/knowledgecenter/ssw_ibm_i_72/cl/opnqryf.htm)\n2. `\n                    *CT\n               `\n               is Open Query File's\n               `\n                    Contains\n               `\n               operator. It looks for the occurrence of the query value anywhere in the\n               `\n                    CMNAME\n               `\n               field value.\n3. `\n                    'AND SONS'\n               `\n               is the query value. Because Step 1's converted the\n               `\n                    CMNames\n               `\n               value to uppercase using the\n               `\n                    ToUpper()\n               `\n               method during the string interpolation ensures the query is case insensitive.\n\nUnlike SQL, you can use fields from the input file in the query even if they aren't specified in the           `\n               QryKeyFlds\n          `           property.\n\n**Line 24.**\n\nAssign the resolved           `\n               Query\n          `           field to the           `\n               Cust\n          `           file's           `\n               QrySelect\n          `           property.\n\n**Line 26.**\n\nOQF is in play because the           `\n               Cust\n          `           file's           `\n               QryKeyFlds\n          `           and           `\n               QrySelect\n          `           properties have values. When OQF is in play, opening           `\n               Cust\n          `           doesn't open the underlying physical or logical file, but rather opens the result set returned by the query. The query occurs, on the server side, immediately after opening the file.\n\nThe rest of the code is pretty obvious. Loop over the result set and do something with it. Remember that the only fields available are those specified by the           `\n               QryKeyFlds\n          `           value.\n\n## Rounding out your programming kitbag\n\nThis isn't a technique you'll use everywhere, but it's the kind of technique that when you do need it you'll be very glad it's in your AVR programming kit bag."
        }
    },
    {
        "dirent": {
            "name": "read-write-json-with-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Read and Write Json with AVR for .NET",
                "description": "This article explains now to read and write JSON data with ASNA Visual RPG for .NET.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T05:29:39.000Z",
                "date_created": "2024-01-10T05:29:39.000Z",
                "pinned": false
            },
            "content": "Json is a data interchange format. It is especially popular for transmitting data between a browser client and a Web server, but is also often used for other things such configuration files ([Visual Studio Code](https://code.visualstudio.com/) and [Sublime Text](https://www.sublimetext.com/) for example) and even database storage ([such as MongoDB](https://www.mongodb.com/)). This article takes a look at reading and writing Json with ASNA Visual RPG (AVR).\n\nDouglas Crockford surfaced Json in 2001. If you've never heard Crockford speak, go watch [Discovering JavaScript Object Notation with Douglas Crockford](https://www.youtube.com/watch?v=kc8BAR7SHJI) and [Douglas Crockford: The JSON Saga](https://www.youtube.com/watch?v=-C-JoyNuQJs). The videos are particularly interesting in how Crockford got Json to be taken seriously as a \"standard.\" By the way, because Crockford pronounces Json as ‘Jason' (as in [Jason and the Argonauts](https://www.youtube.com/watch?v=__Z4f6rEWvM)) that's what I do. But if you prefer, you can also pronounce Json as ‘[jay-sawn'](https://www.youtube.com/watch?v=_NFkzw6oFtQ) (which sounds affected and highfalutin to me!).\n\n‘Json' is is an acronym that stands for JavaScript Object Notation. Json can be thought of as a way to define data structures in JavaScript and this object notation is built into JavaScript natively. Json is very popular because, as opposed to XML, it requires no parsing in browser clients. Here is a very simple Json structure that defines two value pairs with, one with a `name` key and one with `group` key–the former with a value of  `Neil Young` and the later with a value of `Buffalo Springfield`.\n\n```\n{\"name\":\"Neil Young\", \"group\":\"Buffalo Springfield\"}\n```\nThe [full Json spec](http://www.json.org/) explains all of the details, but Json's rules are pretty simple–especially if you know JavaScript. Json is essentially one or more key/value pairs (if you're familiar with Python dictionaries, Json will look very familiar). To use the example above in JavaScript, the following JavaScript:\n\n<pre>\nj =  &#123;\"name\":\"Neil Young\", \"group\":\"Buffalo Springfield\"&rbrace;;\n</pre>\n\nemits \"Neil Young\" to the console. Because there is effectively no parsing with Json, Json quickly replaced XML as Ajax's standard data format. As Json all but made XML obsolete with Ajax, AJAX lost its uppercase name and quit being an acronym for \"Asynchronous JavaScript and XML\" and simply became Ajax, the general name of a technique to push data between a client and a server. \n\nThe Json below is a little more sophisticated–but even at that, it's still just key/value pairs. White space is insignificant to Json and following could also be written on one line or without indention.\n```\n{\n  \"CPU\": \"Intel\",\n  \"Cores\": 8,\n  \"Drives\": [\n    \"DVD read/writer\",\n    \"1TB Sata 7200\",\n    \"250GB SSD\"\n  ],\n  \"Manufacturer\": {\n    \"Name\": \"Bob's Drives\",\n    \"Street\": \"331 Jefferson\",\n    \"City\": \"Gas City\",\n    \"State\": \"IN\",\n    \"ZipCode\": \"78216\"\n  }\n}\n```\nFigure 1. Json structure with simple value pairs and array and nested object value pairs.\n\n## Using Json with .NET\n\nWhile .NET has some Json-related code baked into it, .NET Frameworks's intrinsic Json-related classes pale in comparison to the [Json.NET open source project](http://www.newtonsoft.com/json). Json.NET is the most popular .NET package on nuget with nearly 35 million downloads. 35,000,000 million! Json.NET does more with Json than most mortals would ever care about, but its core features of reading and writing Json stand out (and probably provide the reason for most of those 35m downloads). This article takes a look at two ways to read and two ways to write Json with Json.NET.\n\nFirst, you'll need to [download Json.NET](http://www.newtonsoft.com/json). After doing that, you'll need to set a reference to the one of the several .NET versions of the Newtonsoft.Json.DLL provided. Check your project's properties to ensure what version of .NET it's using and then set a reference to the corresponding Json.NET DLL (shown below). After that, you're ready to code.\n\n\n![Showing the .NET Framework version needed](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/projectproperties-1.png)\nFigure 2. AVR project properties showing .NET framework version in use.\n\nThis article shows two ways shown to write and read Json. The first write/read pair uses brute force to access the Json. These methods are procedural and potentially error prone, but are often appropriate for small, ad hoc Json work. Take care using this procedural style of Json processing. \n\nThe second write/read pair is far more declarative (pushing the hard work needed to work with Json to Json .NET's object serialization/deserialization smarts). There is surprisingly little code for this second pair of techniques, but they require the existence of data classes. While this might seem annoying, a little setup with data classes paves the way for more obvious and direct coding.\n\nAll four of the following examples work with the Json shown in Figure 1.\n\n## Write Json with JsonTextWriter\n\nIf you need to produce ad hoc Json and find yourself using the StringBuilder or string literals and string concatenation, that's an indication you need Json.NET's [JsonTextWriter](http://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_JsonTextWriter.htm) object. This solution is ideally suited for creating small chunks of Json. Building Json with a specialized Json writer ensures you'll end up with valid Json–if the code compiles the Json it produces will be valid (it might not be the correct Json, but it will be valid valid, syntax-checked Json). Compare this to string concatenation or StringBuilder append-driven techniques. With those techniques, it's easy to make silly Json syntax mistakes.\n\n<pre>\nDclFld sb Type(System.Text.StringBuilder) New()\n    DclFld sw Type(System.IO.StringWriter) \n\n    sw = *New System.IO.StringWriter(sb) \n    BegUsing writer Type(NewtonSoft.Json.JsonTextWriter) Value(*New NewtonSoft.Json.JsonTextWriter(sw))\n        writer.Formatting = NewtonSoft.Json.Formatting.Indented\n        writer.WriteStartObject()\n            writer.WritePropertyName(\"CPU\")\n            writer.WriteValue(\"Intel\")\n            writer.WritePropertyName(\"Cores\")\n            writer.WriteValue(8i)\n            writer.WritePropertyName(\"Drives\")\n        \n            writer.WriteStartArray()\n                writer.WriteValue(\"DVD read/writer\")\n                writer.WriteValue(\"1TB Sata 7200\")\n                writer.WriteValue(\"250GB SSD\")\n            writer.WriteEndArray()\n        \n            writer.WritePropertyName(\"Manufacturer\")\n        \n            writer.WriteStartObject()\n                writer.WritePropertyName(\"Name\")\n                writer.WriteValue(\"Bob's Drives\") \n                writer.WritePropertyName(\"Street\")\n                writer.WriteValue(\"331 Jefferson\") \n                writer.WritePropertyName(\"City\")\n                writer.WriteValue(\"Gas City\") \n                writer.WritePropertyName(\"State\")\n                writer.WriteValue(\"IN\") \n                writer.WritePropertyName(\"ZipCode\")\n                writer.WriteValue(78216I) \n            writer.WriteEndObject()\n        writer.WriteEndObject()\n    EndUsing \n\n    System.IO.File.WriteAllText(\"c:\\users\\roger\\documents\\new-test.json\", sb.ToString())\n</pre>    \n\n**Figure 3a. Writing Json with Json.NET's JsonTextWriter**\n\nThe quite nearly self-explanatory code above produces the Json shown in Figure 1. When using the `JsonTextWriter` you must be sure to pair methods that signal Json construct's start and end boundaries. Writing code like this is one of the very rare times when I use contra code indention conventions. In this code, the indention doesn't indicate nested logic, but rather nested data. You don't have to indent code like this, but when you're building a nested Json document, it helps keep things clear and start/ends matched.\n\nIn Figure 3a's code, the Json is built up in .NET's [System.Text.StringBuilder class](https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.100).aspx). Using the StringBuilder's ToString() method provides easy access to the Json this technique produces.\n\nWhite space is insignificant to Json. For development/debugging work, it's good to set Json formatting to indented (see line 7 in Figure 3a). For production work you'll probably want to use:\n\n```\nwriter.Formatting = NewtonSoft.Json.Formatting.None\n```\n\n## Read Json with Json.NET's JObject\n\nJson.NET makes ad hoc reading of Json easy with its [JObject](http://www.newtonsoft.com/json/help/html/t_newtonsoft_json_linq_jobject.htm). This object makes a Json document look and feel like a specialized nested dictionary. The code below in Figure 3b shows how to use the JObject. It assumes a Json document is available in a string variable. This can be the result of a Web request or having read a text file containing a valid Json document. In line 12, Figure 3b fetching an entire Json document is made easy with .NET's File class's [ReadAllText()](https://msdn.microsoft.com/en-us/library/system.io.file.readalltext(v=vs.100).aspx) method.\n\nJObject returns an object with LINQ-capable queries. AVR can't exploit all of LINQ's query capabilities, but it's easy to do basic Json reading and simple queries with Json.NET's JObject and AVR.\n\n<pre>\nDclFld Cores Type(*Integer4) \nDclFld CPU Type(*String) \nDclFld Drives Type(NewtonSoft.Json.Linq.JArray) \nDclFld Drive Type(*String) \nDclFld i Type(*Integer4) \nDclFld Json Type(*String) \nDclFld JsonObject Type(NewtonSoft.Json.Linq.JObject)\nDclFld Street Type(*String) \nDclFld ZipCode Type(*Integer4) \n\n// Get raw Json.         \nJson = System.IO.File.ReadAllText('c:\\users\\roger\\documents\\test.json') \nJsonObject = NewtonSoft.Json.Linq.JObject.Parse(Json) \n\nCPU = JsonObject['CPU'].ToString()\nCores = Convert.ToInt32(JsonObject['Cores']) \nDrives = JsonObject['Drives'] *As NewtonSoft.Json.Linq.JArray\nCPU = Drives[0I].ToString() // Note coercion of 0 literal to long integer.\n\n// Note you can't use ForEach with JArray--you gotta split em manually as above. \nFor Index(i = 0) To(Drives.Count - 1)\n        Drive = Drives[i].ToString() \n        Console.WriteLine(Drive)             \nEndFor \n\nStreet = JsonObject['Manufacturer']['Street'].ToString()\nZipCode = Convert.ToInt32(JsonObject['Manufacturer']['ZipCode'])\n</pre>\n\n\nFigure 3b. Reading Json with Json.NET's JObject\n\nData read with the JObject isn't strongly typed; it's up to you to cast it appropriately. For example, in line 16 in Figure 3a the `CPU` value is cast to a string and in the line 17 the `Cores` value is cast to a long integer.\n\nIf a key value is an array, line 19 shows how to cast a key value as an array. Once an array is cast, you can fetch a value out of it directly, as shown in line 21 or you can traverse the array with a For loop as shown in lines. Json.NET's JObject has some [sophisticated query capabilities](http://www.newtonsoft.com/json/help/html/t_newtonsoft_json_linq_jobject.htm) that are beyond the scope of this article.\n\nLine 21 in Figure 3b contains an interesting little AVR feature (that is unrelated directly to reading Json). Take a look at the oddly-placed `I` in the array index below:\n\n```\n    CPU = Drives[0I].ToString() \n```    \n\nA literal numeric value, with or without decimal places specified, is assumed to a System.Decimal. Without the `I` in the code above, a compiler error occurs because JObject's numeric array indices must be long integers. The `I` in the line above is what AVR calls a numeric literal, and it coerces the 0 literal specified to be an integer. In most cases, this is never an issue because the index specified would have been provided with a variable of type long integer. However, the ability to coerce a constant sometimes has value–as shown here. [Read more about all of AVR's literals here.](https://docs.asna.com/documentation/Help170/AVR/_HTML/Literals.htm)\n\n### Using object serialization/deserialization to write and read Json\n\nThe previous methods of writing and reading Json are a little clumsy and ad hoc. While they certainly work, there is substantial error potential imposed by the two methods' lack of discipline and formality. For all but the simplest of Json tasks, they are very good ways to work with Json. Let's move on to a more disciplined and controllable way to work with Json: object serialization and deserialization.\n\nThese techniques are declarative and require substantially less code, but you do need [POCO objects](http://stackoverflow.com/questions/3392580/a-better-explanation-of-poco) (plain old CRL objects) for them to work. The two objects below in Figures 4a and 4b define .NET POCO objects that directly relate to the Json shown in Figure 1. Using classes like that imposes formality because the Json associated with these classes must match the given schema _exactly_.\n\nThere isn't anything too remarkable about these classes. They have public read/write properties and when the `DriveDefinition` class is instanced its constructor ensures the nest Manufacturer property gets set to a new instance of `PartManufacturer` class.\n\nClasses needed for Json serialization/deserialization techniques:\n\n```\nBegClass DriveDefinition\n    DclProp CPU Type(*String) Access(*Public) \n    DclProp Cores Type(*Integer4)  Access(*Public) \n    DclProp Drives Type(*String) Rank(1)  Access(*Public) \n    DclProp Manufacturer Type(PartManufacturer) Access(*Public)\n\n    BegConstructor Access(*Public) \n        *This.Manufacturer = *New PartManufacturer()         \n    EndConstructor\nEndClass \n```\nFigure 4a. A DriveDefinition class in AVR for .NET.\n\n```\nBegClass PartManufacturer\n    DclProp Name Type(*String)  Access(*Public) \n    DclProp Street Type(*String)  Access(*Public) \n    DclProp City Type(*String)  Access(*Public) \n    DclProp State Type(*String)  Access(*Public) \n    DclProp ZipCode Type(*String)  Access(*Public) \nEndClass\n```\n\nFigure 4b. A PartManufacturer class in AVR for .NET.\n\n## Write Json with object serialization\n\nThe code below in Figure 5a shows how to write the resulting Json from an instance of the `DriveDefinition` class. After creating a new instance of the class it's a simple matter of passing the class instance, and optionally the formatting option, to Json.NET's [`JsonConvert.SerializeObject()`](http://www.newtonsoft.com/json/help/html/Overload_Newtonsoft_Json_JsonConvert_SerializeObject.htm) method to get the corresponding Json (which, with this code would be the same as the Json in Figure 1).\n\n<pre>\nDclFld Drive Type(DriveDefinition) New() \nDclFld Json Type(*String) \n\nDrive.CPU = \"Intel\"\nDrive.Cores = 8 \nDrive.Drives = *New *String[] {\"DVD read/writer\", \"1TB Sata 7200\", \"250GB SSD\"}\nDrive.Manufacturer.Name = \"Bob's Drives\"\nDrive.Manufacturer.Street = \"331 Jefferson\"\nDrive.Manufacturer.City = \"Gas City\"\nDrive.Manufacturer.State = \"IN\"\nDrive.Manufacturer.ZipCode = 78216\n\nJson = NewtonSoft.Json.JsonConvert.SerializeObject(Drive, NewtonSoft.Json.Formatting.Indented) \nSystem.IO.File.WriteAllText(\"c:\\users\\roger\\documents\\new-test2.json\", Json)\n</pre>\n\n**Figure 5a. Serializing a .NET object to Json.**\n\nTo test the Json created, this example uses `.NET's File.WriteAllText()` method to persist the Json to an ASCII file on disk.\n\nIf are you aren't fully familiar with AVR's array handling, a potentially jarring part of the Figure 5a may be line 6 where the Drives array is populated. See this article to read more about [AVR's ranked array shorthand](/en/kb/arrays-visual-rpg-ranked) for populating an array.\n\n## Read Json with object deserialization\n\nReading Json with Json.NET's deserialization is very easy with its [`JsonConvert.Deserialize`](http://www.newtonsoft.com/json/help/html/Overload_Newtonsoft_Json_JsonConvert_DeserializeObject.htm) object–it only takes one line of code to transform a Json string into an instance of its corresponding .NET POCO class.\n\n<pre>\nDclFld Json Type(*String) \nDclFld d Type(DriveDefinition)\nDclFld DriveManufacturerName Type(*String)\n\n// Get raw Json.         \nJson = System.IO.File.ReadAllText('c:\\users\\roger\\documents\\test.json') \n// Reconstitute object.\nd = NewtonSoft.Json.JsonConvert.DeserializeObject(Json, *TypeOf(DriveDefinition)) *As DriveDefinition \n// Fetch desired properties through the DriveDefinition class instance returned.\nDriveManufacturer = d.Manufacturer.Name\n</pre>\n\n**Figure 5b. Deserializing a .NET object to Json.**\n\nOnce deserialized, the typed `d` class instance properties are all easily available. Line 10 shows how to fetch the Manufacturer's `Name` property and all of the class instances other properties are also similarly available.\n\n`Try/Catch` can (and should!) be used with the `Deserialize()` object to ensure the Json schema passed to the method correctly matches the specified object.\n\n### Summary\n\nWith Json.NET, it's really easy to write and read Json with AVR. For all but the simplest cases, spend the extra time to create POCO classes to define your Json documents and use the `Serialize()` and `Deserialize()` methods. That extra time spent creating those classes pays off nicely by needing far less procedural code and providing far more error handling.\n\n(One more Json (ok, Jason) -related thing: if you don't have the time or the desire to watch the entire 1963 version of Jason and the Argonauts, at least be sure to check out the [famous skeleton fight](https://www.youtube.com/watch?v=pF_Fi7x93PY). It's [Ray Harryhausen's](https://en.wikipedia.org/wiki/Ray_Harryhausen) stop animation at its best. That Jason, like JavaScript's Json, is pretty awesome!)"
        }
    },
    {
        "dirent": {
            "name": "css-scope.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Up your CSS game with CSS scoping",
                "description": "This article explains how to use the spankin' new CSS @scope feature to very effectively scope your CSS to specific elements",
                "tags": [
                    "css",
                    "front-end"
                ],
                "date_published": "2025-12-02T00:00:00.000Z",
                "date_updated": "2025-12-02T00:00:00.000Z",
                "date_created": "2025-12-02T00:00:00.000Z",
                "pinned": false
            },
            "content": "\nThis article explains how to use the spankin' new CSS @scope feature to very effectively scope your CSS to specific elements. CSS has really been on a roll for quite a while now adding new and very useful features. Over the last few years CSS has acquired: \n\n- [custom properties](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Properties/--*)\n- [CSS layers](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/At-rules/@layer) \n- [nesting](https://developer.mozilla.org/en-US/docs/Web/CSS/Guides/Nesting) \n- [container queries](https://developer.mozilla.org/en-US/docs/Web/CSS/Guides/Containment/Container_queries)\n- [:has() selector](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Selectors/:has) \n- [:is() selector](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Selectors/:is)\n- [color-mix](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Values/color_value/color-mix) \n- [clamp](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Values/clamp) \n\nThese are all very helpful and important features. They all should be in a modern web developer's kit bag. A powerful new [CSS scoping feature](https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/At-rules/@scope) is now available with baseline browser support (which means supported by all modern browsers). This new scoping feature makes it much easier to impose component-based organization on your CSS.  \n\nThis article provides a quick look at CSS scoping. For more in-depth CSS scoping information see: \n\n* [CSS Tricks scoping article](https://css-tricks.com/almanac/rules/s/scope/)\n\n* [Kevin Powell YouTube video on CSS scope](https://www.youtube.com/watch?v=PkFuytYVqI8&t=628s&pp=ygUKY3NzIEBzY29wZQ%3D%3D)\n\n> FireFox delivered CSS scoping with its version 146.0 which was released on December 9th, 2025. FireFox had been dragging its feet on scoping and this release is what make CSS scoping full baseline (and predictable)  across all modern browsers.  \n\n![CSS @scope support](https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/scope-css-support.png)\n\n<small>Figure 1. CSS @scope support</small>\n\n[Read the full Can I Use article for CSS @scope.](https://caniuse.com/?search=css+%40scope)\n\n\n## The old way\n\nLet's say you have this HTML:\n\n```\n<div class=\"component1\">\n   <h1>Headline component 1</h1>\n   <p>Paragraph for component 1</p>\n</div>\n\n<div class=\"component2\">\n   <h1>Headline component 2</h1>\n   <p>Paragraph for component 2</p>\n</div>\n\n<div class=\"component3\">\n   <h1>Headline component 3</h1>\n   <p>Paragraph for component 3</p>\n</div> \n``` \n\nthat you want to render like this: \n\n![](https://asna-assets.nyc3.digitaloceanspaces.com/newsletter/scoping-in-action.png)\n\nWith old-school CSS, a way to style to those three elements is:\n\n```\ndiv.component1 {\n   background-color: lightblue;\n   padding: 1rem; \n}   \n\ndiv.component1 h1 {\n   color: blue;\n}\n\ndiv.component2 {\n   background-color: orange;\n   padding: 1rem; \n}\n\ndiv.component2 h1 {\n   color: red;\n}\n\ndiv.component3 {\n   background-color: green;\n   padding: 1rem;\n}   \n\ndiv.component3 h1 {\n   color: purple;\n}\n```\n\nThere isn't anything wrong with the CSS above. CSS written like it probably styles 90% of the Internet. However, while CSS like this may be easy to maintain initially, it's lack of structure coupled with CSS's global nature can lead to tangled, hard-to-manage CSS. It's likely that over time other CSS will be added somewhere else, perhaps even in another CSS file, that causes hard-to-find, confounding conflicts. \n\n## Is nesting the answer?\n\nCSS nesting has been baseline-available now for two years. I've used it heavily to help write more colocated and rational CSS. \n\n```\ndiv.component1 {\n   background-color: lightblue;\n   padding: 1rem; \n\n   & h1 {\n      color: blue;\n   }\n}\n\ndiv.component2 {\n   background-color: orange;\n   padding: 1rem; \n\n   & h1 {\n      color: red;\n   }\n}\n\ndiv.component3 {\n   background-color: green;\n   padding: 1rem;\n\n   & h1 {\n      color: purple;      \n   }\n}\n```\n\nCSS nesting imposes a more ogranized structure. With just a little discipline you can reasonably assume that all of the CSS that applies to `div.component1` can be found nested under the corresponding selector. \n\nThe problem with nesting is that it can lead to snarly and convoluted deeply indented sub-nesting. CSS nesting gets pretty hard to read if you nest more than two or three levels deep. \n\n> As an aside, the August 2023 baseline version of CSS nesting required the `&` prefix. However, in December 2023 the `&` became optional.\n \n\n## CSS scoping \n\nCSS scoping is defined with the `@scope` keyword. The CSS below produces the same results as the preceding CSS, but with a more prescribed method of identifying and organizing the CSS. \n\n```\n@scope (div.component1) {\n   :scope {\n      background-color: lightblue;\n      padding: 1rem; \n   }      \n\n   h1 {\n      color: blue;\n   }     \n   \n}\n\n@scope (div.component2) {\n   :scope {\n      background-color: orange;\n      padding: 1rem; \n   }         \n\n   h1 {\n      color: red;\n   }   \n}\n\n@scope (div.component3) {\n   :scope {\n      background-color: green;\n      padding: 1rem;\n   }      \n\n   h1 {\n      color: purple;\n   }   \n}\n```\n \nThis article's overly simple example \"component\":\n\n```\n<div class=\"component1\">\n   <h1>Headline component 1</h1>\n   <p>Paragraph for component 1</p>\n</div>\n```\n\ndoesn't really show off CSS scoping, but you should get the idea. In some ways, this scoping feature is little like CSS nesting. However, scoping throws a tighter band around its host component and doesn't require convoluted nesting. \n\n## A tiny CSS scoping gotcha\n\nCSS's `@scope` also introduces the new `:scope` pseudo class selector. It selects the `@scoped` root element--which in this case is the scoped parent `div` tag.\n\nScoping doesn't defeat CSS's baked-in specificity rules. Consider the following CSS and guess what it renders as the background color of the `div.component1`. \n\n```\ndiv.component1 {\n   background-color: red;\n}\n\n@scope (div.component1) {\n   :scope {\n      background-color: lightblue;\n      padding: 1rem; \n   }      \n\n   h1 {\n      color: blue;\n   }        \n}\n```\n\nThe rendered result is sneaky. The rendered background color is `red`. Why? Because the specificity of both selectors (`div.component1`) seems to match, it's logical to guess the background color would be `lightblue`. That would have been my bet on the answer.\n\nWhy isn't the background color `red`. Because the specificity of `div.component1` is [0,1,1](https://polypane.app/css-specificity-calculator/?selector=div.component) but the specificity of the `:scope` selector is [0,1,0](https://polypane.app/css-specificity-calculator/?selector=%253Ascope). \n\n> To calculate CSS specificity, the count of ID, class, and type selectors are concatenated and then compared. In the example above, the first value `011` and the second is `010`, so the first wins. See the link below for more info CSS specificity.\n\nIt's probably an edge case, but you need to include `div' along with the `:scope` selector to make the specificity of the two selectors equal. \n\nWith the CSS below, with both selectors having the same specificity, the second one wins and the background color is light blue.  \n\n```\ndiv.component1 {\n   background-color: red;\n}\n\n@scope (div.component1) {\n   div:scope {\n      background-color: lightblue;\n      padding: 1rem; \n   }      \n\n   h1 {\n      color: blue;\n   }        \n}\n```\n\nFully understanding CSS specificity is an important skill for writing great CSS. [Read more about calculating and understanding CSS specificity](https://developer.mozilla.org/en-US/docs/Web/CSS/Guides/Cascade/Specificity) and use this [online specificity calculator](https://polypane.app/css-specificity-calculator) to test your knowledge.\n\n\nSee this [CodePen for a working copy](https://codepen.io/rogerpence/pen/VYaqMgz) of the CSS scoping code above.\n\n## That's not all, folks!\n\nThere is another part of `@scope` that provides \"donut\" scoping. It allows for protecting \"islands\" within a scope from being affected by the scoping rules. Donut scoping is beyond the scope (see what I did there?) of this article. This [CSS Tricks article](https://css-tricks.com/almanac/rules/s/scope/) provides a superb discussion of donut scoping. \n\n## All in \n\nI'm all in on CSS scoping. It provides a CSS missing piece that makes creating effective and well-organized design systems possible. "
        }
    },
    {
        "dirent": {
            "name": "css-custom-properties.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "A guide to using CSS custom Properties",
                "description": "How to use CSS custom properties.",
                "tags": [
                    "css",
                    "front-end"
                ],
                "date_published": "2025-10-02T00:00:00.000Z",
                "date_updated": "2025-10-02T00:00:00.000Z",
                "date_created": "2025-10-02T00:00:00.000Z",
                "pinned": false
            },
            "content": "\nCSS custom properties are essentially variables you can declare in your CSS. They can dramatically reduce redundancy and increase flexibility in your CSS files. All of the major browsers now fully support CSS custom properties. Let's take a closer look.\n\n## Declaring variables\n\nCSS custom properties are declared in a .CSS file and associated with a scope. The scope is either global, which makes the variables available to all other CSS selectors in your app, or scoped to a specific CSS selector, which makes the variables available only for that selector.\n\n### Global CSS properties\n\nFor example, the following declares a global CSS property:\n\n```\n:root {\n    --background-color: #004477;\n}\n```\n\nAny other CSS in your project can use this property like this:\n\n```\n.button {\n    ...\n    background-color: var(--background-color);\n    ...\n}\n```\n\n### Scoped CSS properties\n\nIn this case, the custom property is declared under the `:root`, which means the `--background-color` variable is available anywhere in the CSS.  \n\nDeclaring a scoped property is similar:\n\n```\n.button {\n    --background-color: #004477;\n}\n```\n\nThe property above applies to elements only with the `.button` CSS class applied:\n\n```\n.button {\n    ...\n    background-color: var(--background-color);\n    ...\n}\n```\n\nThe scoped property could have also been declared without separating the variable definition from the `.button` class rules like this:\n\n```\n.button {\n    --background-color: #004477;\n    ...\n    background-color: var(--background-color);\n    ...\n}\n```\n\nUsually, though, it's best to declare all of your CSS custom properties in one place (often in a separate CSS file dedicated to declaring variables) and then apply them to other CSS rules as needed.\n\nEven in CSS, global variables can lead to lots of unexpected side consequences. While there are good reasons to use global CSS customer properties, scoping your variable declarations to their intended targets when you can makes managing CSS customer properties easier.\n\n### Declare a CSS property with a default value\n\nWhen applying a CSS custom property, you can also specifiy a default value.\n\n```\n.button {\n    ...\n    background-color: var(--background-color, red);\n    ...\n}\n```\n\nIn the example above, if `--background-color` hasn't been defined, the default color is `red`.\n\n\n## Putting CSS custom properties to work\n\nConsider a CSS file with the following rules (where the elipsises are other values as needed.)\n\n```\n.button {\n    ...\n    background-color: #004477;\n    ...\n}\n\n.standard-border {\n    ...\n    border: 1x solid #004477;\n    ..\n}\n\n.menu-text-color {\n    ...\n    color: #004477;\n    ...\n}\n```\n\nThe intent here is to have established a primary color and have it be used consistently through the site. However, if you ever need to change this primary color, then you have to use search and replace to carefully swap out the colors. With CSS custom properties, you could do this:\n\n```\n:root {\n    --primary-color: #004477;\n}\n\n.button {\n    ...\n    background-color: var(--primary-color);\n    ...\n}\n\n.standard-border {\n    ...\n    border: 1x solid var(--primary-color);\n    ...\n}\n\n.menu-text-color {\n    ...\n    color: var(--primary-color);\n    ...\n}\n```\n\nChanging the definition of `--primary-color`, quickly swaps out the primary color throughout the entire site.\n\n## CSS custom property considerations\n\n- The double dashes (--) that prefix CSS custom property variables is required.\n- Unlike other parts of CSS, CSS custom properties are *case sensitive*. It's probably best to stick with all lower-case naming.\n- With the exception of IE 11, [virtually every major browser fully supports CSS custom properties.](https://caniuse.com/#search=css custom properties) Don't wait for IE 11 to catch up (it won't). Relegate its use to legacy needs and get your users upgraded to a better browser!\n- CSS custom properties are interpreted at runtime and fully obey [CSS cascading rules.](https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Cascade_and_inheritance)\n- CSS customer property names can quickly spiral out of control. Give some thought to effective CSS property naming conventions.\n- If the same property name is declared globally and as a scoped property, the scoped property applies (to its given scope).\n\n## CSS custom properties and JavaScript\n\n\nThere is a simple JavaScript interface to get and set CSS custom property values.\n\n> It takes a special case for this JavaScript interface to truly be useful. The couple of times I've used it, I ultimately created a bigger problem than the one being solved. Unless you're very careful, you can cause more indirection than its worth. Use it with care.\n\n### Set a global property value\n\n```\nlet root = document.documentElement;\nroot.style.setProperty('--page-background-color', 'azure');\n```\n\n`document.documentElement` is the `:root` selector.\n\n### Get a global property value\n\n```\nroot = getComputedStyle(document.documentElement);\nconsole.log(root.getPropertyValue('--page-background-color'));\n```\n\n### Set a scoped property value\n\nThe scoped selector used here must match the selector used to define the scoped property.\n\n```\nroot = document.querySelector('.message');\nroot.style.setProperty('--background-color', 'purple');    \n```\n\n### Get a scoped property value\n\n```\nroot = getComputedStyle(document.querySelector('.message'));\nconsole.log(root.getPropertyValue('--text-color'));\n```\n\n## Further reading:\n\n- [Mozilla docs](https://developer.mozilla.org/en-US/docs/Web/CSS/--*)\n- [Locally scoped CSS variabels](https://una.im/local-css-vars/)\n- [The hidden power of CSS custom properties](https://medium.com/@coders.stop/the-hidden-power-of-css-custom-properties-9-techniques-most-designers-miss-2d6dedf2b15a)\n- [A practical guide to CSS custom variables](https://www.sitepoint.com/practical-guide-css-variables-custom-properties/)\n- [Using CSS custom properties to define responsive breakpoints](https://css-tricks.com/responsive-designs-and-css-custom-properties-defining-variables-and-breakpoints/)\n- [7 uses for CSS custom properties](https://css-irl.info/7-uses-for-css-custom-properties/)"
        }
    },
    {
        "dirent": {
            "name": "datagate-connection-pooling.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Increase web app performance with DataGate connection pooling",
                "description": "DataGate’s connection pooling is a way to reuse existing server-side jobs for ASP.NET web apps. This article explains how to use DG's connection pooling.",
                "tags": [
                    "asp-net",
                    "datagate-ibm-i",
                    "visual-rpg"
                ],
                "date_published": "2024-01-05T12:35:56.000Z",
                "date_updated": "2024-01-05T19:45:21.000Z",
                "date_created": "2024-01-05T19:45:21.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Image from '$components/text-decorators/Image.svelte'\n</script>\n\nDataGate's connection pooling is a way to reuse existing server-side jobs for ASP.NET web apps. This is especially important on the IBM i, where creating a new IBM i job is relatively time-consuming. With connection pooling, a user can get a web page up in a matter of milliseconds, without connection pooling it could take up to a few seconds for a user to be seeing a page.\n\n> Note that while this DataGate feature is called \"connection pooling\" it is an IBM i job that provides the database connection to be pooled. In this article, a \"pooled job\" is the same thing as a \"pooled connection.\"\n\nConnection pooling applies to traditional ASP.NET web applications, it does not apply to Wings, Mobile RPG, or Windows applications. In these cases, any one user has an implicit ongoing IBM i job. While connection pooling has the most performance impact on web apps using the IBM i, DataGate connection pooling also applies to DataGate for SQL Server. You won't notice a dramatic performance improvement with SQL Server, but even at that DataGate connection pooling SQL Server helps minimize SQL Server processes.\n\nAVR ASP.NET web applications present a web application to a user one page at a time. Think of any one page as a user's unit of work. When a user hits a page an IBM i job is acquired for the duration of that page. When that page ends the user is done with the IBM i job for that unit of work. Connection pooling provides relief for the IBM i server to continually spin up a new IBM i job every time a web page needs one.\n\n## How to configure DataGate connection pooling\n\nConnection pooling is generally enabled for a Database Name. To do this:\n\n1. Open Visual Studio and click View-&gt;DataGate Explorer.\n2. In the Database Names tree node, right-click the Database Name for which you want to enable connection pooling and click \"Edit Properties.\"\n3. In the dialog displayed (shown immediately below) click the \"Pool Connections\" checkbox and provide an Idle Timeout in Minutes value.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/enabling-connection-pooling.png\" alt=\"Configuring connection pooling\" width=\"300\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nThe idle timeout provides the time (in minutes) that a pooled connection persists before it is closed. More detail on this is provided later in this article.\n\n## Why use DataGate job pooling?\n\nBefore configuring DataGate for connection pooling, let's consider what connection pooling is and why it is important for AVR ASP.NET web apps. To show how connection pooling works, let's consider an imaginary group of six IBM i jobs. In reality, the number of IBM i jobs available to an ASP.NET web app is much greater than six, but six is enough to understand how connection pooling works. We'll discuss connection pooling considering three users, Eric, Ginger, and Jack.\n\nThe illustration that follows assumes that all users are using exactly the same database name with exactly the same user profile and password. After explaining basic connection pooling, other database name considerations are discussed.\n\n## No DataGate IBM i jobs active\n\nThis shows the web app is not active (it has no sessions active and nothing in memory) and it has no DataGate jobs associated with it. This is typically the state of a web app early in the morning before anyone first uses that day.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/no-jobs.png\" alt=\"No ASP.NET-related DataGate jobs running on the IBM i.\" width=\"200\" alignment=\"center\" caption=\"Figure 2.\"/>\n\n## Eric requests a page\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/one-new-job.png\" alt=\"Eric starts using the web app.\" width=\"200\" alignment=\"center\" caption=\"Figure 3.\"/>\n\nEric got to work first and fires up the web app to check a customer's balance. This causes DataGate to start a new job on the IBM i, as shown above in Figure 3.\n\n## The IBM i job Eric's page used is now pooled\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/one-pooled-job.png\" alt=\"One pooled IBM&nbsp;i job.\" width=\"200\" alignment=\"center\" caption=\"Figure 4.\"/>\n\nWhen Eric's page ends, the AVR code disconnects his job. This typically happens in the`Page_Unload` event with this code (where DBDG is the name of the active AVR DclDB object):\n\n```\nBegSr Page_Unload Access(*Private) Event(*This.Unload)\n    DclSrParm sender Type(*Object)\n    DclSrParm e Type(System.EventArgs)\n\n    Close *All\n    Disconnect DGDB\nEndSr\n```\nIf the DclDB's database connection is using pooled connections, the AVR Disconnect operation tells DataGate not to end the associated IBM i job but rather assign it to a list DataGate maintains of pooled jobs. When you configure connection pooling, you assign an idle timeout value (in minutes) to keep pooled jobs alive. Each time a pooled job is active, its idle timeout value is renewed. If a pooled job isn't called upon before its idle timeout value expires, it ends. (The idle timeout value is typically set to the same value as the ASP.NET session timeout value-but the two values don't have to be the same).\n\nIt is important to close all files before disconnecting a pooled job. In some cases, if you fail to close files first before disconnecting you may leave pending record locks or cause other resource contention with files left open.\n\n> Pooled DataGate jobs consume virtually no resources on the IBM i.\n\n## Orphaned job IBM i jobs\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/one-orphan-job.png\" alt=\"An orphan DataGate IBM i job.\" width=\"200\" alignment=\"center\" caption=\"Figure 5a.\"/>\n\nNot disconnecting DclDB objects before the ASPX page goes out of scope results in orphaned IBM i jobs. (\"out of scope\" means before the page ends; the Page\\_Unload event is your last chance to disconnect a DclDB object before the page goes out of scope). You usually won't look at WRKUSRJOB or WRKACTJOB in time to see a single orphaned job; rather you'll see many of them. Each time a page is requested that doesn't disconnect the DclDB object, another orphaned job is created.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/all-oprhan-jobs.png\" alt=\"Lots of orphaned jobs.\" width=\"200\" alignment=\"center\" caption=\"Figure 5b.\"/>\n\nOrphaned jobs are often found simply by accident. Consider a 12-page web app that has 11 well-behaved pages that appropriately disconnect the DclDB object. However, on one page the disconnect was forgotten. That one page generates an orphaned job each time it's used.\n\nDisconnecting the DclDB is the action that pools a job into idle, pooled status. If you don't disconnect properly, orphaned jobs aren't pooled and don't end until you either explicitly end them on the IBM i or when the ASP.NET session associated with the orphaned job expires.\n\nOrphaned jobs don't generally cause much trouble, but it's sloppy to have them hanging and with a little programming diligence they aren't necessary. It's also possible to have           *many*           orphaned jobs. Even if their physical presence isn't doing anything particularly harmful, their presence is at the very least highly disconcerting. To avoid orphaned IBM i jobs, take great care to disconnect           *every*           DclDB object before a page goes out of scope. (See           Using the Singleton DB Pattern to avoid orphaned IBM i jobs           for more information).\n\n## Testing for orphaned jobs before your deploy your ASP.NET application\n\nHere is a good way to test for orphaned jobs before you deploy the ASP.NET web to production:\n\n1. Deploy the app to a test server (or, if you can't do that, run it from inside Visual Studio).\n2. Ensure that connection is enabled for the DclDB connection.\n3. Ensure you are the only person using the app.\n4. Start a new instance of the web app and use every page in every way possible.\n5. Check WRKACTJOB or WRKUSRJOB frequently on the IBM i as you are testing the app. You should\n               *never*\n               see more than one job appear as you are using the app. If you do, you've got a job leak-you forgot to disconnect in at least one place.\n\n> It's critical that for this test there should only be one user using the web app. It's really hard to ensure one user on a deployed web app so this test is best done in a controlled environment like a test server or even running the app from within Visual Studio.\n\nRead about an ASNA DataGate logging configuration option           that may be helpful in identifying the cause of orphan jobs.\n\n## Eric and Ginger both request web pages within milliseconds of each other\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/one-new-one-pactive.png\" alt=\"One new job (the green one) and one pooled job (the blue one) running.\" width=\"200\" alignment=\"center\" caption=\"Figure 6.\"/>\n\nAt the same time (or quite nearly) Eric clicks a button to see another page of the web app, Ginger also requests a page. This causes the previously-pooled job to be assigned to either Eric or Ginger and a new IBM i job is created for whoever didn't get the pooled job. One of the two users will see the web page quicker than the other (because one is using a pooled job and one is waiting on a new job to spin up).\n\nWith ASP.NET stateless web apps, pages come and go very quickly-often measured in milliseconds. It's possible that Eric and Ginger could do lots of work with ease using the same pooled job. They would both have to submit page requests at nearly the exact same time to cause the scenario shown in Figure 5. That is unlikely, but especially with two users, it could (and does) happen.\n\nIt's important to note that Eric won't necessarily get the job he originally caused to be started. In traditional, shared database name connections, jobs aren't considered \"owned\" by any one user, rather they are considered shared resources available to any user. (See the Database Name considerations section below for more on this).\n\n## There are now two pooled IBM i jobs\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/two-pooled.png\" alt=\"After Eric and Ginger’s pages end, there are two pooled jobs.\" width=\"200\" alignment=\"center\" caption=\"Figure 7.\"/>\n\nOnce Eric and Ginger's pages end (assuming both disconnected the DclDB object) there are now two pooled jobs on the IBM i. This means that as long as Eric and Ginger are the only two using the web app, both are assured instantaneous page displays using pooled jobs. Neither will have to wait for an IBM i job.\n\n## Eric, Ginger, and Jack each request web pages within milliseconds of each other\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/two-pactive-one-active.png\" alt=\"One new job (the green one) and two pooled jobs (the blue one) running.\" width=\"200\" alignment=\"center\" caption=\"Figure 8.\"/>\n\n## There are now three pooled IBM i jobs\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/three-pooled.png\" alt=\"After Eric, Ginger, and Jack's pages end, there are three pooled jobs.\" width=\"200\" alignment=\"center\" caption=\"Figure 9.\"/>\n\nAt the same time (or quite nearly), Eric, Ginger, and Jack all three request a page of the web app. The two previously-pooled are assigned to the first two requests and a third new IBM i job is created for the other request. Once again, it isn't determinate which users get the two pooled jobs. It's quite possible it could be Jack. No one of the three users, who are all using an app that uses the same database name, has a claim for a specific job.\n\nAs you can imagine, it's not likely that our three users would each request a page within a millisecond of each other. But again, it could, and probably will happen. The more pooled jobs acquired, the less likely it is that new jobs are needed. Depending on the type of work being done with the web app, it's not unreasonable to expect that 10 to 25 users could work all morning with just one pooled job. As the density of keystrokes increases, the need for more pooled jobs also increases. While the figures for this article show a maximum of six pooled jobs, that was an arbitrarily selected number for illustration purposes. In the real world, the only limit to the number of jobs that DataGate can start is the workload capacity of the IBM i.\n\nBy the time ten jobs are pooled, you can expect the rate at which new jobs are pooled to dramatically reduce. For a busy office with 100 users doing moderately intensive work, it's quite reasonable to expect to see less than ten pooled jobs. The value of this job scheme is that it is essentially self-scaling on the way up; if a job is needed, another can be created and then it gets added to the pool.\n\nThis scheme also scales itself on the way down as well. As periods of inactivity increase, the job pool shrinks as needed. After a pooled job's associated timeout value expires DataGate ends the job. Consider an app that is run during normal business hours (few are, but play along!). Assuming the pooled job timeout is 20 minutes, in 20 minutes (or so) all pooled jobs will have ended.\n\n## Connection pooling and security regulations\n\nDataGate uses the DataGate Database Name and its user ID (and other Database Name properties) to uniquely identify jobs for connection pooling. Typically, web apps use a single Database Name with a single set of user credentials for all users. For example, you might have a Database Name called \"IBMProduction\" associated with the IBM i user `WebUser` and `WebUser's`     IBM i password. In this scenario, all users will share IBM i jobs associated with WebUser`.\n\nFor many small and medium-sized business websites, the single database name model still works fine, but larger businesses working under more strict security regulations may not be able to use a single database name. An alternative scheme for these larger uses is to create three database names that effectively provide different user classes. For example:\n\n1. Create one Database Name for read-only users. This Database Name could be \"ROUSER\" (for a read-only user). This would be associated with an IBM i user account that is granted only read-only access to critical IBM i resources.\n\n2. Create a second Database Name for read/write basic users. This Database Name could be \"RWUSER\" (for a read-write user). This would be associated with an IBM i user account that is granted read-write access to some IBM i resources but not especially sensitive objects.\n\n3. Create a third Database Name for super users. This Database Name could be \"SUUSER\" (for superuser). This would be associated with an IBM i user account that has read/write access for all IBM i objects.\n\nConnection pooling would then work across each \"class\" of user. Read-only users would use the pooled read-only jobs, read-write users would use the pooled limited read-write jobs, and super users would use the pooled unlimited access jobs. This scheme would increase the amount of IBM i pooled jobs, but still provide good use of IBM i resources and provide very good performance.\n\nOn some occasions, you may need to override the IBM i user profile and password for a very sensitive website task. This is easy to do and while it limits some of the benefits of connection pooling, it still provides the best experience that a specific user has because that user always gets her specific pooled job back. For example, in the code below, the web app prompts for an IBM i user profile and password. These values are used to override the user and password of the read-only user database name. When it connects, the permissions associated with the credentials apply.\n\n```\n    DclDb SpecialUser DBName(ROUSER)  \n\n    SpecialUser.User = UserName\n    SpecialUser.Password = UserPassword\n\n    Connect SpecialUser\n    // Open files\n    // Do lots of work\n    Close *All\n    Disconnect SpecialUser\n```\nThis user's job is pooled for only for that user. So once the job is opened for that use, it is pooled for the user while the user is active.\n\nIf your business is governed by strict security regulations (such as those imposed by Sarbanes/Oxley in the US) be sure to check with your security auditors for what they recommend as best practices regarding website user login.\n\n## DataGate connection pooling best practices\n\n- Use connection pooling for AVR for .NET ASP.NET websites. It doesn't help with Wings, Mobile RPG, or AVR Windows applications.\n- Use connection pooling with websites using either DataGate for IBM i or DataGate for SQL Server.\n- Every database connection (the DclDB object) that gets connected must be explicitly disconnected before the page goes out of scope (the last possible place to disconnect is the Page\\_Unload event).\n- Be especially aware of database connections in AVR classes used from the ASPX page's code behind. Database connections must also be disconnected in adjunct classes before the class goes out of scope-otherwise, you're spawning orphan jobs. For more on this topic,                     see this article about the singleton DB pattern                     .\n- Be sure to close all files associated with a connection before disconnecting. The easy way to do this is using                     `\n                         Close *ALL\n                    `                     ; don't try to keep track of what files are or are not opened. Just close all of them.\n- Analyze your AVR for .NET web apps careful for IBM i job usage before you deploy them. It's much easier to check for orphaned IBM i jobs in a controlled, single-user environment.\n- If your business is governed by strict security regulations (such as those imposed by Sarbanes/Oxley in the US) be sure to check with your security auditors for what they recommend as best practices regarding website user login.\n"
        }
    },
    {
        "dirent": {
            "name": "product-key-replacement-policy.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "ASNA Product Key Replacement Policy",
                "description": "This new ASNA Product Key Replacement Policy goes into effect on September 1, 2025. It affects customers with and without a current maintenance support plan.",
                "tags": [
                    "license-keys"
                ],
                "date_published": "2025-07-01T23:31:20.000Z",
                "date_updated": "2025-07-01T23:31:20.000Z",
                "date_created": "2025-07-01T23:31:20.000Z",
                "pinned": false
            },
            "content": "\n<script>\nimport ContactUs from '$components/all-locales/all-pages/ContactUs.svelte';\n</script>\n\nThe following new Product Key Replacement Policy goes into effect on\nNovember 1st, 2025.\n\n**For customers who have an active Product Maintenance support plan**\n\n-   For generally available or retired products, replacement keys are\n    available at no charge.\n\n**For customers without an active Product Maintenance support plan**\n\n-   For generally available products, replacement keys are available for\n    a fee. The fee amount depends on the product. The fee varies based\n    on the product and number of seats licensed. Email us at\n    <codes@asna.com> for the fees for your products/seats.\n\n-   For retired products, replacements keys are not available. For\n    retired products, the product needs to be repurchased to acquire a\n    key.\n\n**Generally available and retired products**\n\n-   The list of generally available products can be seen under the\n    \"Generally Available Products\" heading on <a href=\"https://www.asna.com/downloads/en\">this page.\n\n-   Any products not listed under the \"Generally Available Products\" (as\n    mentioned above) are retired products.\n\n**Special Product Maintenance Amnesty offer available through November\n1st, 2025**\n\nRepurchasing product maintenance after a maintenance plan has lapsed is\ngenerally not available. However, if you've let your maintenance lapse,\nyou can avoid needing to repurchase a product to get a maintenance plan\nwith our special Product Maintenance Amnesty program through November\n1st, 2025.\n\n<ContactUs formTitle=\"Ask us a question about the Maintenance Amnesty special offer\" \n               formSource=\"sent from /en/kb/product-key-replacement-policy\" \n               formText=\"click this link to ask us a question\" \n               formStyle=\"link\"> \n</ContactUs>\n\nabout the Maintenance Amnesty special offer or email us at amnesty@asna.com.\n\n\nWhile tech support is not available with a maintenance plan for retired\nproducts, having that plan for retired products does ensure you are\nalways able to get keys at no charge.\n"
        }
    },
    {
        "dirent": {
            "name": "datagate-connection-tester.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Testing DataGate connections with ASP.NET",
                "description": "This article provides a single-file Visual RPG ASP.NET that tests DataGate connections for Web apps.",
                "tags": [
                    "datagate",
                    "asp-net"
                ],
                "date_published": "2025-07-11T12:35:56.000Z",
                "date_updated": "2025-07-11T19:03:23.000Z",
                "date_created": "1970-01-01T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\n    import Image from '$components/text-decorators/Image.svelte'\n</script>\n\n\n[Get the source from GitHub here](https://github.com/ASNA/test-datagate-connection-in-aspx)\n\nBefore you deploy a Visual RPG (AVR) ASP.NET Web application for production use, it's a good idea to ensure the DataGate connection is working on the Web Server. You can do that with the [DataGate Monitor](/en/kb/datagate-monitor), but that doesn't confirm that ASP.NET is working and that AVR is working with ASP.NET; nor does it test that the WebPak license is valid. \n\nThis article provides a single-file ASPX page that tests DataGate connections, as well as ASP.NET and AVR interoperability for Visual RPG ASP.NET Web applications and WebPak licensing. \n\nPut the single `test-dg.aspx`ile in your Website or virtual directory and direct your browser it. There are no other compilation or deployment steps--its code is compiled at runtime when the file is displayed in the browser. \n\n`test-dg.aspx` does 100% of its work with a single file; there is no code behind. The file has AVR server side code, JavaScript client code, HTML, and the CSS. The file is compiled at runtime by ASP.NET. You can drop the file as-is into the root of an empty virtual directory or Web site root.\n\nThis test page works with DataGate for IBM i, DataGate for SQL Server, and DataGate for Windows and Servers (aka, the local ASNA database).\n\nTesting connection attributes with this page can help ensure that the attributes you use with your DataGate Database Name will work with your deployed ASNA Visual RPG application. \n\nUsing this test file before you deploy your Visual RPG Web application:\n\n- Confirms ASP.NET is installed and worked\n- Confirms that AVR is installed working\n- Confirms that you can connect to your target server successfully\n- Using the read option, it confirms that the user specified has permission to the file read and it confirms that your WebPak license is valid.\n\nThe error messages provided help troubleshoot connection errors. \n\nFigures 1 and 2 below show the test page in action. \n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/assets/articles/test-dg-connection-success.png\" alt=\"Success connecting with DataGate for IBM i\" width=\"550\" alignment=\"center\" caption=\"Figure 1. Success connecting to DataGate for IBM i.\"/>\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/assets/articles/test-dg-connection-error.png\" alt=\"Failure connecting with DataGate for IBM i\" width=\"550\" alignment=\"center\" caption=\"Figure 2. Failure connecting to DataGate for IBM i.\"/>\n\n## Optional test to read a record \n\nWhen provided, the bottom three inputs (Library, File, Field name) attempt to read a record from the file info provided. This read test is necessary to test that the WebPak license is valid. The WebPak licensed isn't checked at connection time, it's checked when DataGate does some kind of file IO (eg, read, write, update, or delete). The read test also ensures the user profile used in the DataGate name has permissions to the file.\n\n## Using the DataGate ASP.NET Connection Tester\n\nPut the `test-dg.aspx` file in the root of where your project is hosted on IIS. Point your browser to that test page. For example, if the domain for your IIS instance is \n\n```\ntest.mycompany.com\n``` \n\nThen use \n\n```\ntest.mycompany.com/test-dg.aspx\n```\n\nin your browser. \n\nGenerally, you should use the `test-dg.aspx` in the root of an IIS site or virtual directory before you first deploy your app. However, can also add `test-dg.aspx` to deployed sites as long as they were not deployed with the \"Precompile during publishing\" option (shown in Figure 3 below). \n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/assets/articles/test-dg-connection-precompiled.png\" alt=\"Failure connecting with DataGate for IBM i\" width=\"550\" alignment=\"center\" caption=\"Figure 3. `test-dg.aspx` can't be added directly to projects deployed with the 'precompile during publishing' option.\"/>\n\nFor using the connection tester with precompiled projects, you need to either:\n\n- Add the `test-db.asp` file to the root your project and redeploy it\n- Temporarily remove the contents of the IIS site or virtual directory, test the connection, then restore the contents.\n\n\n## Attribute-specific details\n\n### DataGate for IBM i\n- User: IBM i user\n- Password: IBM i user password\n- Server: IBM i IP address or name\n- DB Label: Can be any text value or empty\n- Port: Default value is 5042. [How to confirm the IBM i's TCP/IP port assignment](https://www.asna.com/en/kb/confirm-datagate-port)\n\n### DataGate for SQL Server \n- User: *Domain or SQL Server user \n- Password: Empty if *Domain or SQL Server user password\n- Server: SQL Server instance name\n- DB Label: Must be 'SQL'\n- Port: Must be 5042\n\n### DataGate for Windows and Servers\n- User: Must be *Domain\n- Password: Must be empty\n- Server: Must be '*Local'\n- DB Label: Must be the assigned Database Label (see the section below)\n- Port: Must be 5042\n\n\n"
        }
    },
    {
        "dirent": {
            "name": "print-to-pdf.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Printing to PDF with ASNA Visual RPG for .NET and Amyuni",
                "description": "How to use the Amyuni PDF Converter to print to PDF in ASNA Visual RPG applications.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2015-12-14T00:00:00.000Z",
                "date_updated": "2015-12-14T00:00:00.000Z",
                "date_created": "2015-12-14T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\nimport Image from \"$components/text-decorators/Image.svelte\";\nimport Callout from \"$components/text-decorators/Callout.svelte\"\n\n\nimport { page } from '$app/stores';\n\nconst locale = ($page.url.pathname.startsWith('/downloads')) ? \n     $page.pathname.url.slice(-2) : \n     $page.url.pathname.slice(1,3);\n</script>\n\n\n> This article was published in 2014. It may not now reflect the best way to use the Amyuni driver with AVR. \n\n<Callout\n    icon=\"fa-sharp fa-solid fa-circle-exclamation\"\n    font_size=\"1.2rem\"\n    font_style=\"italic\"\n>\nMicrosoft now provides a native PDF print driver and you may no longer need the Amyuni driver. See this article <a href=\"https://www.asna.com/{locale}/kb/print-to-pdf-windows\">for more information.</a>\n\n</Callout>\n\nDistributing reports as PDF files is a very common practice in the enterprise. ASNA’s DataGate print files are designed to print to one of your installed Windows printers. Printing to PDF with AVR is therefore a pretty simple task of using a PDF print driver and then printing to that virtual printer. These drivers redirect print file output to a PDF file.\n\nFor use with fat client Windows programs, you may get by with low-end, or even free, PDF print drivers. There are many of these available. However, in every case, these low-end drivers are single-threaded and not for use in the multi-threaded world of IIS. Alas, then, these drivers do not work with AVR ASP.NET Web apps. A hallmark of low-end PDF drivers is their inability to easily specify unique file names for multiple concurrent users. For most enterprise use, we recommend you try to avoid the very low-end (sometimes free) PDF drivers.\n\nFor years, our go-to recommendation has been the ActivePDF driver. We have a lot of customers using ActivePDF and while its while quality and reliability are good, tech support is spotty. ActivePDF’s single instance server license list price is $1050 and that is competitive. However, we’ve heard from a few customers that ActivePDF, in certain production environments, can cost a lot more than that.\n\nWe’ve also heard of users slogging through the arduous process (at least the last time I tried) of trying to make the Adobe PDF server product work and we occasionally hear from users who swear that one of the single-threaded drivers is working for them in Web apps. We’ve tried over the last several years to find an alternative to ActivePDF but it has been the kingpin PDF driver for us for a long time. It’s edge has been its multi-theading capabilities.\n\nThe other day, a longtime friend of ASNA’s, Forrest Forbus (that’s right, figured out how to make the Amyuni PDF Converter Application Server Edition (that I’ll mercifully call the Amyuni PDF driver for the rest of this article) work with his AVR for .NET ASP.NET Web application. Forrest very graciously offered to share his code with me. (Forrest’s generosity reminded me of my mother. She always thought it was a sin for anyone to keep a recipe a secret. Why keep all the good stuff to yourself!. My mother would certainly approve of Forrest’s natural inclination to share his code.) The code provided here is a refactored version of Forrest’s code that echoes his exact approach. Even I refactored Forrest’s code to be a little more general purpose, make no mistake, most of the good ideas and good code you see were lifted directly from Forrest’s work. Thank you, Forrest.\n\n## The Amyuni PDF Converter Application Server Edition\n\nThe specific Amyuni used here is its [PDF Converter Application Server Edition](https://www.amyuni.com/en/server-products/pdf-converter-application-server-edition/learn-more) . Licensing varies, so check with Amyuni to be sure, but for a Web app on a single IP address the driver is $1038 (as of 14 Dec 2015). Normally a developer license is required for $529, but the folks at Amyuni will generously waive that fee for the first developer seat for ASNA customers. Annual maintenance runs about $240. The Amyuni tech support and sales teams were superb to work with getting this all figured out.\n\nPrint drivers are inherently COM-based, so the Amyuni PDF driver is also COM-based. However, .NET graciously consumes COM objects and that a you’re using a COM component is all but transparent. While Amyuni will have a .NET-based wrapper available for its PDF driver next year, Forrest’s work renders that mostly a moot point.\n\n## Get the code\n\nOur approach to printing to PDF with the Amyuni PDF printer driver is to provide a wrapper AVR for .NET class library. That project, with annotated code and a zip file download, is available by clicking the blue button immediately below. Don’t forget you’ll need to get at least a trial copy of the [Amyuni PDF Convert Application Server Edition](https://www.amyuni.com/en/server-products/pdf-converter-application-server-edition/learn-more), too.\n\n[Get the AVR for .NET Amyuni PDF class library here](https://github.com/ASNA/ASNA.AmyuniPDF)\n\nWe also have an AVR for .NET ASP.NET PDF example that shows how to use the class library. That project, with annotated code and a zip file download, is available by clicking the blue button immediately below.\n\n[Get the AVR for .NET ASP.NET PDF example app here](https://github.com/ASNA/AVR-ASP.NET-Amyuni)\n"
        }
    },
    {
        "dirent": {
            "name": "security-update.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "ASNA Security Update FAQ",
                "description": "This is an important security notification regarding a vulnerability discovered in two ASNA Windows Services: ASNA Assist and ASNA Registrar. We have resolved this vulnerability with updated versions of all supported ASNA products.",
                "tags": [
                    "datagate-ibm-i",
                    "mobile-rpg",
                    "wings",
                    "datagate",
                    "visual-rpg",
                    "announcement"
                ],
                "date_published": "2025-07-01T23:31:20.000Z",
                "date_updated": "2025-07-01T23:31:20.000Z",
                "date_created": "2025-07-01T23:31:20.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import ContactUs from '$components/all-locales/all-pages/ContactUs.svelte';\n</script>\n\n\nThis is an _IMPORTANT SECURITY UPDATE_. Action is required to avoid an ASNA Windows Services vulnerability.\n\nThis is an important security notification regarding a vulnerability discovered in two ASNA Windows Services: ASNA Assist and ASNA Registrar. We have resolved this vulnerability with updated versions of all supported ASNA products.\n\n\n## Action required\n\nNew product versions are available for download today. We strongly recommend avoiding any chance of threat by upgrading the affected products as soon as possible.\n\n[Download updated products here](https://www.asna.com/downloads/en). \n\n[Read about product requirements here](https://www.asna.com/en/support/product-requirements).\n\n## ASNA Vulnerability FAQ\n\n**_What is the vulnerability?_**\n\nThe issue is related to .NET remoting, which we’ve used for years for backwards compatibility with some of our older products. This vulnerability was published by [www.cve.org](https://www.cve.org/) as CVE-2025-43713 and [its CVE record is available here](https://www.cve.org/CVERecord?id=CVE-2025-43713).\n\n**_How quickly should I address this issue?_**\n\n**_Immediately_**. While this vulnerability has existed for some time without reported exploitation, its existence is now confirmed. Under specific conditions, it could allow unauthorized access to a Windows machine. We strongly recommend you upgrade the ASNA products you use as soon as you can.\n\n**_How was this vulnerability discovered?_**\n\nThe ASNA Assist and ASNA Registrar services have been in use for years and have never had a reported breach. However, the issue was recently reported after a customer’s deep security audit revealed the vulnerability. \nWhat, exactly, is the threat? \n\nThe vulnerability exists only on the network where Windows machines are running the affected ASNA Assist or ASNA Registrar services.\nThe threat is present only when these vulnerable services are running and an untrusted user has Windows network access (e.g., via a malicious intruder or a disgruntled employee).\n\n**_What products are affected?_**\n\nThis vulnerability affects only our Windows-based products. DataGate for IBM i is not affected. Our Visual RPG (for .NET and Classic), Wings, Mobile RPG, and DataGate for SQL Server are affected by this vulnerability and need to be updated. \n\n**_How do I address this issue?_**\n\nWe've resolved this vulnerability with refreshed versions of all supported products. These new versions are available for download today. We strongly recommend that you avoid any chance of threat by upgrading the affected products as soon as possible.\n\n**_I am using a retired version of one of your products, how does this affect me?_**\n\nYou’ll need to upgrade to a supported product version protected from vulnerability. Patches will not be provided for older retired products.\n\n**_Do I need to recompile my projects?_**\n\nYou do not need to recompile using generally available products. With retired Visual RPG for .NET projects you probably won't need to recompile. If you are upgrading from an long-retired product (AVR 4.x or AVR 5.0, for example), you may need to recompile your projects before using a newer deployment. \n\n**_Are there any short-term workarounds?_**\n\nFor some fat-client Windows applications, you can temporarily limit exposure. This involves enabling the ASNA Assist and ASNA Registrar services only for brief periods (e.g., to install a license key with the ASNA Registration Assistant) and then immediately disabling the services again.\n\nASP.NET Web applications, Web services, and Visual RPG rely more consistently on these ASNA services, making this workaround unsuitable or impractical for those environments.\n\nThis work-around is not a permanent solution and still carries risk. We strongly recommend avoiding any chance of threat by upgrading the affected products.\n\n\n<div style=\"height: 30px;border-bottom: 1px solid gray;\">&nbsp;</div>\n<div style=\"height: 30px;\">&nbsp;</div>\n \n\nIf you have any questions, please <ContactUs formTitle=\"Ask us a question about the July 2025 security update\" \n               formSource=\"sent from /en/kb/security-update\"            formText=\"click this link\" \n               formStyle=\"link\"/> or email us at support@asna.com. You can \nalso call us in the US at 800-984-4847 or in Europe at +34 902 365 787.\n\nASNA acknowledges and thanks Jonas Vestberg of Reversec Labs for his assistance reporting and resolving this issue.\n"
        }
    },
    {
        "dirent": {
            "name": "regex-part2.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using regular expression character classes and quantifiers",
                "description": "This is part 2 of 2 about using regular expressions with ASNA Visual RPG",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T20:58:37.000Z",
                "date_created": "2024-01-09T20:58:37.000Z",
                "pinned": false
            },
            "content": "\n\n[Part 1 of this series](/en/kb/regex-part1) introduced you to using regular expressions with ASNA Visual RPG (AVR). This article digs into more detail on how to define specific character searches,\n\n## Regex character classes and quantifiers\n\nRegex character classes provide a way to match any one of a set of characters. Let’s first consider user-defined character classes. First, though, a simple match for ‘get’.\n\nThe search below searches the Source string for ‘get’.\n\n```\n    Source = \"(I can't get no) Satisfaction\"\n    Re = 'get'\n    m = Regex.Match(Source, Re)\n    DoWhile m.Success\n        Console.WriteLine(m.Index.ToString() + ':' + m.Value)\n        m = m.NextMatch() \n    EndDo \n```\n\nIt reports finding one occurrence that starts at position 8. Take a look at what appears to be the nearly identical match below. Notice its regular expression is surrounded with brackets.\n\n```\nSource = \"(I can't get no) Satisfaction\"\nRe = '[get]'\nm = Regex.Match(Source, Re)\nDoWhile m.Success\n    Console.WriteLine(m.Index.ToString() + ':' + m.Value)\n    m = m.NextMatch() \nEndDo \n```\n\nThe brackets tell the regex engine that this is a character class match that matches any occurrence of `g`, `e`, or `t`–in any order. A character class is an implicit OR statement. This one is specifying any `g`, any `e`, and any `t`. This pattern reports six matches and their values at positions 6, 8, 9, 10, 18, and 24. To negate a character class, start the character class with an `^` symbol. For example, this match:\n\n```\nSource = \"(I can't get no) Satisfaction\"\nRe = '[^aeiou]'\nm = Regex.Match(Source, Re)\nDoWhile m.Success\n    Console.WriteLine(m.Index.ToString() + ':' + m.Value)\n    m = m.NextMatch() \nEndDo \n```\n\nReports the value and position of each character that isn’t a vowel. Note the overloaded use of `^`. When `^` starts a character set inside brackets it negates them; otherwise it anchors the search at the beginning of the string. You can also specify ranges with character classes. For example, the match below:\n\n```\nSource = \"(I can't get no) Satisfaction\"\nRe = '[a-m]'\nm = Regex.Match(Source, Re)\nDoWhile m.Success\n    Console.WriteLine(m.Index.ToString() + ':' + m.Value)\n    m = m.NextMatch() \nEndDo \n```\nReports the position and value of any character within the inclusive range of characters from `a` through `m`.\n\nThere are also several built-in character classes. Four that you’ll use frequently are:\n\n|Class|Description|\n|--- |--- |\n|`\\s`|matches any white-space character (ie, space, tab, linefeed, etc)|\n|`\\S`|matches any non-white-space character|\n|`\\d`|matches any decimal digit (ie, 0 through 9)|\n|`\\D`|matches any character except a decimal digit|\n|`.|matches any single character except a new line (\\n)|\n\n\nBe sure to watch your case-sensitivity with regex special characters. Here are several frequently-used regex quantifiers (but there are several more):\n\n|Quantifier|Description|\n|--- |--- |\n|`*`|matches the previous element zero or more times|\n|`+`|matches the previous element one or more times|\n|`?`|matches the previous element zero or one time|\n|`{n}`|matches the previous element exactly n times|\n|`{n}`|matches the previous element at least n times|\n|`{n, m}`|matches the previous element at least n times but no more than m times|\n\n\n\nLet’s take a look at some examples that put regex classes and quantifiers to work.\n\n## US Social Security number\n\nFirst, we’ll consider a US social security number, which is always in the format `nnn-nn-nnnn` , where n is a single digit.\n\n```\nSource = '345-15-4978'\nRe = '\\d'\nm = Regex.Match(Source, Re) \n```\n\nThis produces a match because `Source` contains a digit. That pattern isn’t specific enough, let’s try something better.\n\n```\nSource = '345-15-4978'\nRe = '\\d\\d\\d-\\d\\d-\\d\\d\\d\\d'\nm = Regex.Match(Source, Re) \n```\n\nThis match works. It looks for three digits, a dash, two digits, a dash, and then four digits. It’s a little verbose, to tighten it up further the pattern could also be (and probably should be) written like this:\n\n```\nSource = '345-15-4978'\nRe = '\\d{3}-\\d{2}-\\d{4}'\nm = Regex.Match(Source, Re) \n```\n\nThat seems like it might be the best pattern for the job, doesn’t it? However, consider the match below. Does it return success?\n\n```\nSource = 'Neil 345-15-4978 Young'\nRe = '\\d{3}-\\d{2}-\\d{4}'\nm = Regex.Match(Source, Re) \n```\n\nBe careful. This returns success because the pattern is in the string. The best pattern for a US social security number is probably:\n\n```\nSource = '345-15-4978'\nRe = '^\\d{3}-\\d{2}-\\d{4}$'\nm = Regex.Match(Source, Re) \n```\n\nIn this case, we’ve added the `^` character and `$` character to anchor the search at the beginning and ending of the input string. This forces the search pattern to be the entire value being matched. In many (perhaps most) cases, it’s necessary to add the `^` and `$` anchors for the most reliable results. This example is a reliable pattern with which to test a US social security number, however, we can improve it by grouping its major patterns.\n\n```\nSource = '345-15-4978'\nRe = '^(\\d{3})-(\\d{2})-(\\d{4})$'\nm = Regex.Match(Source, Re)\n```\n\nAdding the groups above doesn’t change the pattern functionally, but improves its human comprehension.\n\n[Try this pattern online](https://regex101.com/r/dW1lG7/1) \n\n## Using regular expressions with URLs\n\nURLs are great playgrounds for regular expressions. Alas, attempting to use URLs with regular expressions reveals what you’ve probably been thinking all along: “This regex stuff is cool, but I’m betting it can get you in big trouble.” That’s true. It’s possible to get carried away, very carried away, with regular expressions. [This page shows at least 12 regular expressions](https://mathiasbynens.be/demo/url-regex) to parse a URL. One of them is 1,347 characters long!\n\nLet’s be clear about regular expression usage. If, after learning basic regex syntax, using a regular expression makes the problem harder to solve than an old-timey brute force method, you’re doing something wrong. The qualifier “after learning basic regex syntax” is important. Without a little study and effort, regex won’t make anything easier. But with basic regex skills under your belt, the declarative, concise nature of regular expressions is usually a much better approach than pretzel logic full of `substring()` and `indexOf()`. Give regex a chance–but don’t go off the deep end!\n\nWith the sermon over, let’s see what parsing a _simple_ URL can teach us. The next several examples will only show the `Source` and `Re` for clarity. What follows below is intended to explain regular expressions and not intended to be the definitive way to define a URL with a regex (I don’t think there is one!). Consider the example below. Does it match?\n\n```\nSource = 'https://www.asna.com'\nRe = '^http'\n```\n\nIt does. But how could we provide a pattern that matches URLs that start with either `http` or `https`?\n\n```\nSource = 'https://www.asna.com'\nRe = '^https?' \n```\n\nThe `s?` added to the pattern above makes the pattern specify the string start with `http` followed by an optional `s`. In this case, we’re using the `?` quantifier to specify zero or one time. Let’s add the slashes and the colon to make the first part of our regex include the full protocol specification:\n\n```\nSource = 'https://www.asna.com'\nRe = '^https?://' \n```\n\nThe pattern above successfully matches the full protocol, but forward classes are one of regular expressions’ cross platform weaknesses. Some implementations of regex (Javascript and PHP, for example) don’t like unescaped forward slashes. I’d generally write the regex above like the one shown below:\n\n```\nSource = 'https://www.asna.com'\nRe = '^https?:\\/\\/' \n```\n\nThis makes the pattern start to look a little goofy, but if you write AVR _and_ JavaScript committing to escaping regex forward slashes will keep you out of trouble. Let’s add one more bit of clarity to our pattern:\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)' \n```\n\nThis doesn’t change the pattern for the regex engine, but adding the parentheses contributes to readability and, as we’ll find, makes it possible later to easily identify and capture the enclosed match. Let’s take the subdomain, which is optional. Does the following pattern work?\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)www?' \n```\n\nNope. At first glance, it looks like it might, but this illustrates the specificity demanded by regex. The pattern above doesn’t look for an optional `www` but rather checks to see if the domain is `ww` or `www`. In this case, we need to group the match:\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)(www)?' \n```\n\nThe question mark is a quantifier that promises to match zero or one of the previous elements. The parentheses around `www` define it as the previous element. There is one more thing to do for the domain name. Let’s fully group it.\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)' \n```\n\nAs before, when we grouped the protocol, these parentheses don’t change the search pattern but help provide readability. They make more clear the fact that the `?` applies just to the `(www`). And, again, they are going to later let the domain name be easily extracted. Now we need to add the dot between the subdomain name and the domain name. Does the pattern below do that? (Hint: What does the regex dot (or a period) character class specify?)\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?).' \n```\n\nAlas, the pattern above doesn’t look for a dot, but rather \\*any\\* character. To look for a literal dot, we need to escape it (and we’ll also group it), as shown below:\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)(\\.)' \n```\n\nNow we need to add the domain name, which can contain numbers, letters, dashes, and be between 2 and 63 characters long. To tackle this one we’ll create our own character class.\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)(\\.)[\\da-z\\.-]'\n```\n\nOur character class, the last group in brackets, specifies:\n\n\n|Regex|Description|\n|--- |--- |\n|`\\d`|Any Digit|\n|`a-z`|Any lower-case character|\n|`–`|A dash|\n\nThis character class works but doesn’t apply length constraints nor is it grouped. The example below does that:\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)(\\.)([\\da-z\\.-]{2,63})'\n```\n\nThe pattern above adds the `{n, m}` qualifier to allow domain name lengths of 2 through 63 characters. It also groups the domain name with parentheses. We’re almost done. Let’s add the dot to come after the domain name and before the top-level domain name (just like we did for the dot separating the subdomain and domain names).\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)(\\.)([\\da-z\\.-]{2,62})(\\.)'\n```\n\nWith the dot added, we only need add the pattern for the top-level domain name. I found varying rules on the Internet as to the maximum length of a top-level domain name–but apparently, the longest in existence is 24 characters, so we’ll use that constraint.\n\n```\nSource = 'https://www.asna.com'\nRe = '(^https?:\\/\\/)((www)?)(\\.)([\\da-z\\.-]{2,62})(\\.)([a-z]{2,24})$'\n```\n\nThe top-level domain is defined by the \\[a-z\\]{2,24} pattern–which looks for a two to 24 length string with the letters `a` through `z` in it. This pattern is grouped with parentheses and then the end-of-string anchor `$` is added to ensure there aren’t any spurious trailing characters.\n\n[Try this pattern online](https://regex101.com/r/lG9yL7/3)\n\n"
        }
    },
    {
        "dirent": {
            "name": "send-email-with-avr.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to send email with ASNA Visual RPG",
                "description": "This article shows how to use ASNA Visual RPG with the .NET Framework to send emails.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T20:08:44.000Z",
                "date_created": "2024-01-11T20:08:44.000Z",
                "pinned": false
            },
            "content": "\n[The full source for this article is available here.](https://github.com/ASNA/send-email-with-avr)\n\nIt is very easy to send email with ASNA Visual RPG. The core enablers are baked into the .NET Framework in these two namespaces:\n\n*   System.Net.Mail.SmtpClient\n*   System.Net.Mail.MailMessage\n\n> The [documentation](https://learn.microsoft.com/en-us/dotnet/api/system.net.mail.smtpclient?view=netframework-4.8.1) for the `System.Net.Mail.SmtpClient` class says that because this class \"doesn’t support many modern protocols\" it is deprecated and that you should use the [Nuget MailKit](https://github.com/jstedfast/MailKit) package to send emails. However, the `System.Net.Mail.SmtpClient` has worked fine for me for a long time with the SMTP services I use. It appears to be obsolete only when used with Xamarin. [Read more about this issue here](https://stackoverflow.com/questions/43517434/is-system-net-mail-smtpclient-obsolete-in-4-7#:~:text=It%20is%20not%20obsolete%20in,obsolete%20in%20Mono%20and%20Xamarin.).\n\nThe code is [at this GitHub repo](https://github.com/ASNA/send-email-with-avr/tree/main) and provides everything you need to be sending emails quickly. You can also read [the fully annotated code here.](https://asna.github.io/send-email-with-avr/master-index.html)\n\nSMTP configuration\n------------------\n\nThe project needs an `App.config` file that provides your SMTP server configuration details. An `App.config.sample` file is included to use as a base for your tailored `App.config` file.\n\nIt needs:\n\n*   The name or IP address or your SMTP server\n*   The SMTP port (which is almost always 587)\n*   The SMTP user\n*   The SMTP user password\n*   The email \"from\" address\n\nThe `App.config.sample` file:\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<configuration>\n  <appSettings>\n    <add key=\"smtp-server\" value=\"SMTP IP address or name/>\n    <add key=\"smtp-port\"  value=\"587\"/>\n      <!--\n      Port 465 is deprecated and most SMTP servers require using\n      port 587 to send eamil with TLS.\n      -->\n    <add key=\"smtp-user\" value=\"smtp user\"/>\n    <add key=\"smtp-password\" value=\"smtp password\"/>\n    <add key=\"from-address\" value=\"email from address\"/>\n\n  </appSettings>  \n</configuration>\n```\n\nCopy the `App.config.sample` file to `App.config` and fill in your SMTP provider details.\n\n> This project was compiled with AVR 15x. This project be opened and used with higher versions of AVR. You can’t open this project with an earlier version of AVR, but if you copy and pasted the code as-in to older versions I am pretty sure it works at least down to AVR 12.x.\n\nSend an email\n-------------\n\nThis repo provides a reusable `Emailer` class that you can use to send emails through an SMTP server with ASNA Visual RPG. The project code on GitHub includes a more detailed example, but the short version of sending email with the `Emailer` class looks like this:\n\n```\nDclFld em Type(Emailer) New()\n\nem.ToAdd(rp@asna.com)\nem.Subject \"This is the email subject\"\nem.Body = \"This is the email body\"\n\nem.Send()\n```\n\nThe `Emailer` class has been used successfully with several email providers including [Office 365](https://incisivesupport.com/support/index.php?/Knowledgebase/Article/View/send-email-microsoft365), [GMail](https://kinsta.com/blog/gmail-smtp-server/), and [Zoho](https://www.zoho.com/mail/help/zoho-smtp.html). If you use two-factor authentication with your SMTP provider, check its documentation. Generally, with two-factor authentication you’ll need to generate a special-case password.\n"
        }
    },
    {
        "dirent": {
            "name": "singleton-db-pattern.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to limit IBM i jobs for ASP.NET apps with the singleton DB pattern",
                "description": "This article provides a potential way to identify orphan IBM i jobs as a result of Database connection leaks in ASP.NET Web applications.",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T20:25:19.000Z",
                "date_created": "2024-01-09T20:25:19.000Z",
                "pinned": false
            },
            "content": "\nA very important consideration for AVR for .NET ASP.NET websites is managing IBM i jobs. This article discusses how to ensure that an AVR for .NET website doesn’t create more IBM i jobs than necessary. This is very important. Without fully understanding the relationship between a DclDB object and its corresponding IBM i job, it’s easy to write a web app that creates _many_ unnecessary IBM i jobs.\n\n> This article shows how to avoid unnecessary IBM i jobs by using the `singleton DB pattern.` Using that pattern, you establish a single IBM i job in the top-level parent page and then make that connection available to any class instances the parent page uses.\n\nDuring any one user’s use of your AVR web app, there should only be one IBM i job in play for that user. You can easily test this during development. Start your web app in Visual Studio and use the IBM i’s `WRKUSRJOB` to see the IBM i jobs for the user specified in the DataGate database name. If you ever see more than one job while you are the single user of the web app, you’ve got an IBM i job leak that should be plugged!\n\nThis article assumes familiarity with DataGate connection pooling and the concept of orphan IBM i jobs. [See this article for more detail on those topics](/en/kb/datagate-connection-pooling) . [This article](/en/kb/use-sql-to-find-asp-net-orphan-jobs) also provides related help finding the cause of orphaned, or unnecessary, IBM i jobs.\n\nFigure 1a below shows a simple code-behind for an ASPX page. This code-behind declares a database object named `DGDB1` and correctly connects and disconnects that database object before the page goes out of scope. The code-behind has one file named `File1` and it also instances a secondary class named `MyClass` (instanced as `myc` ). You don’t see the code-behind doing anything but opening and closing `File1` ; in the real world, there were be other chunks of code that do something with that file. This code-behind’s `Page_Load` is also a bit unrealistic. These abstractions are used to keep the code short.\n\n> `Close *ALL` closes all files opened in the class where the `Close *All` is used; it doesn’t close files opened in other classes. Every class must issue its own `Close *All` .\n\n```\nBegClass Index Partial(*Yes) Access(*Public) +\n                Extends(System.Web.UI.Page)\n\n    DclDB DGDB1 DBName(\"*Public/Cypress\")\n    DclDiskFile  File1 DB(DGBD1)...\n\n    BegSr Page_Load Access(*Private) Event(*This.Load)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        DclFld myc Type(MyClass) New()\n\n        Connect DGDB1\n        Open File1 \n\n        myc.DoWork()\n    EndSr\n\n    BegSr Page_Unload Access(*Private) Event(*This.Unload)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        Close *All\n        Disconnect DGDB1\n    EndSr    \nEndClass\n```\n\nFigure 1a. A code-behind fragment instancing and using a method in a secondary class.\n\nThe `MyClass` that Figure 1a uses is shown below in Figure 1b.\n\n```\nBegClass MyClass Access(*Public)\n\n    DclDB DGDB2 DBName(\"*Public/Cypress\")\n    DclDiskFile File2 DB(DGDB2)...\n\n    BegSr DoWork Access(*Public)\n        Connect DGDB2\n        Open File2\n\n        // Do some work here... \n\n        Close *All\n        Disconnect DGDB2\n    EndSr\n\nEndClass\n```\n\nFigure 1b. The secondary class used by Figure 1a.\n\nThe class in Figure 1b declares its own database object named DGDB2 and it connects DGDB2, open files, does work, closes files, and then disconnects DGDB2. While this follows ASNA best practices to avoid orphan IBM i jobs, it results in an unnecessary job. Why?\n\nThe code-behind has declared and connected one database connection, which results in an IBM i job, and the code in `MyClass` (Figure 1b) is doing the same thing. Each time you connect to a database object (a  `DclDB` object) an IBM i job is created (or pulled from a pooled job). Figure 1c below illustrates this.\n\n![Diagram of one user and two jobs](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/singleton-db-pattern-01.png)\n\nFigure 1c. An IBM i job diagram for the code in Figures 1a and 1b.\n\nChecking `WRKUSRJOB` while the `DoWork` routine in the `MyClass` code is running would confirm two IBM i jobs running.\n\n![Confirm jobs with WRKUSRJOB](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/singlepattern-twojobs.png)\n\nFigure 1d. Using WRKUSRJOB to confirm that two jobs are associated with Figure 1a and 1b’s code.\n\nIt could be argued that this second job isn’t that big of a deal. With DataGate’s effective connection pooling, and with a small number of classes, that’s probably correct. While the scenario shown here does create an extra job, that job gets pooled–which makes it quickly available the next time the web app needs a job. However, for large AVR websites, you often have _many_ secondary classes with many jobs. It only takes a little effort to channel all secondary class database activity through the same job as the code-behind is using.\n\n#### Avoid unnecessary jobs with the Singleton DB Pattern\n\nUse the _Singleton DB Pattern_ to limit any one code-behind and _all_ of its secondary classes to using one IBM i job. Don’t let this somewhat highbrow name be offputting. Naming the solution to this multiple-job challenge simply provides a name for the solution–and provides a vocabulary we can use while discussing the issue ( [like all software patterns do](https://en.wikipedia.org/wiki/Software_design_pattern) ). Implementing the Singleton DB Pattern is less off-putting than its tuxedo-wearing name.\n\nThe enabler for the Singleton DB Pattern is .NET’s ability to pass an object by reference–in this case the database object. That is, the code-behind will pass, by reference, its database object to any secondary classes. These classes then will use that parent’s database connection (and its underlying IBM i job). Let’s take a closer look.\n\n> AVR for .NET does default to passing parameters by value. However, in .NET (as with Java, JavaScript, and many other languages), reference type values (for example, those variables that reference a class instance) are passed by reference. This may seem a little confusing if you’re new to .NET. The value of a reference types is effectively a pointer in memory to referenced object. So when a reference type gets passed by value you are essentially passing the memory address of its referenced object. In this article’s case, the memory address of a database object is being passed around. [Read more about value types and reference types here.](https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types)\n\nThe revised code-behind that implements the Singleton DB Pattern is shown below in Figure 2a.\n\n```\nBegClass Index Partial(*Yes) Access(*Public) +\n                Extends(System.Web.UI.Page)\n\n    DclDB DGDB1 DBName(\"*Public/Cypress\")\n    DclDiskFile  File1 DB(DGBD1)...\n\n    BegSr Page_Load Access(*Private) Event(*This.Load)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        DclFld myc Type(MyClass) New(DGDB1)\n\n        Connect DGDB1\n        Open File1 \n\n        myc.DoWork()\n    EndSr\n\n    BegSr Page_Unload Access(*Private) Event(*This.Unload)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        Close *All\n        Disconnect DGDB1\n    EndSr\n\nEndClass\n```\n\nFigure 2a. A code-behind fragment instancing and using a method in a secondary class.\n\nThis code in Figure 2a is nearly identical to the previous code-behind with one important change: It passes its `DGDB1` database connection to `MyClass's` constructor, `MyClass` , with this line of code.\n\n```\nDclFld myc Type(MyClass) New(DGDB1)\n```\n\nThe revised code for MyClass is shown below in Figure 2b. There are a few more changes in this code. While they are minor changes, they cause a dramatic improvement in job management.\n\n```\nBegClass MyClass Access(*Public)\n\n    DclDB DGDB2 DBName(\"*Public/Cypress\")\n    DclDiskFile File2 DB(DGDB2)...\n\n    BegConstructor Access(*Public)\n        DclSrParm DBDG1 Type(ASNA.VisualRPG.Runtime.Database)\n\n        DGDB2 = DGDB1\n\n        Connect DGDB2 \n    EndConstructor \n\n    BegSr DoWork Access(*Public)\n        Open File2\n\n        // Do some work here... \n\n        Close *All\n    EndSr\n\nEndClass\n```\n\nFigure 2b. The secondary class used by Figure 1a.\n\nIn the code above in Figure 2b, you’ll notice that `MyClass's` constructor is now explicitly defined. It receives one parameter: an AVR database object. The real magic here is the next line:\n\n```\nDGDB2 = DGDB1\n```\n\nThe constructor gets called before anything else occurs in `MyClass` ; this ensures that the very first thing that happens in `MyClass` is that its database object ( `DGDB2` ) is now referencing the database object passed in the constructor ( `DGDB1` ). This is effectively a runtime swap of the database object in `MyClass` . After this assignment, the `DGDB1` and `DBDG2` variables are referencing the exact same object in memory at runtime. (Note that at compile time, `DBDG2` itself is implicitly connected in `MyClass` to resolve any declared files.)\n\n> Because the value of reference types is a memory address, `DGDB2 = DGDB1` is making both variables point to the class instance referenced by `DGDB1` .\n\nYou’ll also notice this line immediately after the database assignment:\n\n```\nConnect DGDB2\n```\n\nThis ensures that if the code-behind didn’t connect `DGDB1` that it gets connected for `MyClass's` use. To further illustrate that `DGDB1` and `DGDB2` are now referencing the same database object in memory, this line could also be:\n\n```\nConnect DGDB1\n```\n\nBecause at this point both variables are referencing the exact same object. Let that soak in. It is a critical point. It’s very important to do the connect _after_ the database assignment ( `DBDG2 = DBDG1` ). Otherwise, you’ll cause an orphan IBM i job.\n\n> AVR for .NET doesn’t raise an error if `Connect` is issued against an already-connected database object. You can safely issue the `Connect` operation without regard for whether the database object is already connected.\n\nYou’ll also notice that there isn’t a\n\n```\nDisconnect DGDB2 \n```\n\nin `MyClass` . Remember that `MyClass` is effectively borrowing the code-behind’s database connection. The Singleton DB Pattern grants the secondary class permission to use that database connection, but secondary classes _do not_ have permission to disconnect database connections. That’s the parent’s job (in the case, the code behind in Figure 2a).\n\n> The Singleton DB Pattern imposes a strict assumption that when object A passes a database connection to object B that object B will not make _any_ changes to the state of the database connection. It’s like loaning your car to a friend. She can use it, but under no circumstances can she change it! Don’t bring it back with scratched paint and Taco Cabana trash in it!\n\nSecondary classes should always have a\n\n```\nClose *ALL\n```\n\nto close all files opened in the secondary class before the secondary class goes out of scope. There is a convention in .NET that says if a class has a `Close` method, that method should be called before that class goes out of scope. For this reason, you’ll often see a method like this in classes that implement the Singleton DB Pattern if the code doesn’t inherently close the files (as Figure 2b does).\n\n```\nBegSr Close Access(*Public) \n    Close *All \nEndSr    \n```\n> If a class (any class, not just those obeying the Singleton DB Pattern) has a `Close` method it is the programmer’s responsibility to call that method before the class goes out of scope.\n\nFigure 2c below shows the code-behind and the secondary `MyClass` in action and how they both share the same IBM i job.\n\n![Diagram of shared job](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/singleton-db-pattern-02.png)\n\nFigure 2c. An IBM i job diagram for the code in Figures 2a and 2b.\n\nIf you were to use `WRKUSRJOB` while `MyClass` is doing some work, you would now see only one job, as shown below in Figure 2d.\n\n![Using WRKUSRJOB to confirm only one job](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/singlepattern-onejob.png)\n\nFigure 2d. Using `WRKUSRJOB` to confirm that only one job is associated with Figure 2a and 2b’s code.\n\n#### Notes on the Singleton DB Pattern\n\n*   The parent class should provide a DB object even if it doesn’t have any disk files or make any program calls. This DB object is for use assigning the top-level DB to its secondary classes.\n    \n*   Secondary classes should always have a constructor that accepts a database object as a parameter. This database object should always be assigned to the secondary class’s intrinsic database object.\n    \n*   Secondary classes should always connect their database objects after they’ve been assigned in the constructor. This ensures the assigned database is connected.\n    \n*   Secondary classes should _never_ disconnect a DB connection or change any other attribute of its state. That’s a job for the parent (or owner) of the database object. A secondary class is simply borrowing the connection. The parent class owning the DB object, again usually the page, needs to issue the disconnect. \n    \n*   If a secondary class has a Close method, the parent class should always call that method before the secondary class goes out of scope.\n    \n*   If a secondary class itself needs to declare another secondary class, it simply repeats the pattern, passing a reference to its DB object to the other secondary class. You can pass the database object around as deep as necessary–just remember that none of those \"borrowers\" should ever disconnect the database object.\n    \n*   The Singleton DB Pattern works equally well with either Windows or browser-based ASP.NET applications.\n    \n*   While you could engineer a variation on the Singleton DB Pattern with a `Shared(*Yes)` database connection for Windows applications (although we discourage that), _under no circumstances_ should you attempt to use a `Shared(*Yes)` database object with ASP.NET web applications. Shared database connections in a web app result in one job for _all_ of the users of the web application. That is bad, bad, bad!\n    \n\n> As a general rule, it’s best to only use `Shared(*Yes)` in web apps for nothing but [pure functions](https://www.sitepoint.com/functional-programming-pure-functions/) or constants.\n\n#### Summary\n\nThe Singleton DB Pattern is very effective in limiting IBM i jobs in complex AVR web apps. Use it as you’re building (or adding to) AVR web apps. Also be sure to check frequently during the development stage to ensure your app is always using only one IBM i job."
        }
    },
    {
        "dirent": {
            "name": "spool-file-viewer.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using the Wings/Mobile RPG spool file viewer",
                "description": "ASNA Wings and Mobile RPG includes a very handy spool file viewer. It lets you view, delete, or download spool files as PDFs.",
                "tags": [
                    "mobile-rpg",
                    "wings"
                ],
                "date_published": "2024-01-11T11:57:34.000Z",
                "date_updated": "2024-01-11T21:08:16.000Z",
                "date_created": "2024-01-11T21:08:16.000Z",
                "pinned": false
            },
            "content": "ASNA WingsRPG and Mobile RPG includes a very handy spool file viewer. It lets you view, delete, or download spool files as PDFs.\n\nThis video provides an overview of the ASNA Wings/Mobile RPG Spool File Viewer. The article that follows the video explains how to install the Spool File Viewer.\n\n![Pressing F4 invokes the Spool File Viewer](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/firefox_yklyV1YRlT.png)\n\nPressing F4 invokes the Spool File Viewer\n\n![A list of spool files](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/firefox_CjPQJ29qPZ.png)\n\nA list of spool files\n\n![the contents of a single spool file](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/firefox_2rHazrpzVr.png)\n\nShowing the contents of a single spool file.\n\n## To install the Spool File Viewer library on your IBM i\n\n**Step 1. Download the Spool File Viewer**\n\nDownload The Spool File Viewer from [our downloads page](/downloads/en). Gee version that corresponds to your version of Wings or Mobile RPG. \n\n**Step 2. Unzip the downloaded file to the folder of your choice.**\n\nFor this article, that was unzipped to the\n\n<pre>\nc:\\users\\roger\\downloads\\spool_file_viewer_1.0.42.1\n</pre>\n\nfolder.\n\n**Step 3. Open a DOS command box on your PC**\n\nOpen a DOS command box and change its current directory to the folder where you unzipped the downloaded file. This directory should have a directory named `AsnaSplf10` and three files:\n\n*   Readme.txt\n*   Copyright.txt\n*   SPLF10SAVF\n\nThe `AsnaSplf10` directory gets added to any Wings/Mobile RPG project with which you want to use the Spool File Viewer. The `SPLF10SAVF` is a savefile that provides a small IBM i library that needs to be installed on your IBM i. More information on both of these follows.\n\n**Step 4. Create a target savefile on the IBM i**\n\n    CRTSAVF QGPL/ASNASPLF \n    \n\n**Step 5. Upload the savefile**\n\nFrom the DOS box you opened in Step 3, issue these commands\n\n*   Type `ftp <server name> or <ip address>` and press enter.\n*   Enter user name and password when prompted\n*   Type `binary` and press enter\n*   Type `put splf10savf qgpl/asnasplf` and press enter\n*   Type `bye` and press enter\n\nThese steps populate the save file you created in step 4.\n\n**Step 6. Restore the library the save file provided**\n\n```\nRSTLIB SAVLIB(SPLF10LIB) DEV(*SAV) SAVF(QGPL/ASNASPLF) RSTLIB(ASNASPLF10)\n```\n\nThis puts the `ASNASPLF10` library on your IBM i. It has four objects:\n\n*   A `LISTSPLF` \\*PGM object and \\*CMD object\n*   A `VIEWSPLF` \\*PGM object and \\*CMD object\n\nYou’ll use the `LISTSPLF` CMD object to launch the spool file list view. Although you’re not likely to use it directly, the `VIEWSPLF` command object launches a single spool file viewer. These commands launch the respective program object.\n\nIt is strongly recommended that you always use the commands to launch the spool file lister and spool file viewer. Using these command interfaces protects your code against any changes that may occur in the two program objects.\n\n> The ASNASPLF10 library must be in the library list.\n\nThe ASNA `LISTSPLF` command:\n\n![The ASNA LISTSPLF command](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_CTUtJaGIGe.png)\n\nThe ASNA `VIEWSPLF` command:\n\n![The ASNA i VIEWSPLF command](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_whYU1NBlUk.png)\n\nThese screen images are shown here to display each command parameter. However, remember that these commands cannot be run from a green-screen. They depend on ASNA Wings or Mobile RPG for their display output–they will not work from the command line.\n\n## A very important step!\n\nWith the ASNASPLF10 library installed, it is very important that you change the LISTSPLF and VIEWSPLF commands to reference your DataGate library. To do so, use the CHGCMD as shown below: \n\n```\nCHGCMD CMD(ASNASPLF10/LISTSPLF) CURLIB(your DataGate library) \n```\nand \n\n```\nCHGCMD CMD(ASNASPLF10/VIEWSPLF) CURLIB(your DataGate library)\n```\n\nwhere `your DataGate library` is the name of your DataGate library. If you’re not sure of what your DataGate library name is, [see this article for help.](/en/kb/get-datagate-library-name) Anytime you change your DataGate library, you’ll need to use CHGCMD as shown here for the LISTSPLF and VIEWSPLF commands to ensure they are referencing the correct DataGate library.\n\n## To use the spool file viewer in your ASNA Wings or Mobile Project.\n\n**Step 1.** Add the `AsnaSplf10` folder (provided in the Spool File Viewer download) and its contents to the root of your Wings or Mobile RPG project. This provides the browser-based display files necessary for listing and viewing spool files. \n\n**Step 2**. Modify your RPG program to launch the spool file lister. To launch the Spool File Viewer you need to use the `LISTSPLF` command in the ASNASPLF10 library. RPG can’t issue commands directly, but that’s easy to do through RPG’s Command Exec interface. To do this first delete two variables:\n\n*   A character field named SPOOLF with the qualified LISTSPLF command\n*   A 15,5 packed value named SPOOLFLEN to provide the length of SPOOLF\n\nShown with fixed-RPG D specs, this code is:\n\n```\nD SPOOLF          S             19A   INZ('ASNASPLF10/LISTSPLF')  \nD SPOOLFLEN       S             15P 5                             \n\n...\n```    \n\nUse this RPG code to issue the LISTSPLF command through RPG’s Command Exec interface:\n\n```\nC                   EVAL      SPOOLFLEN = %LEN(SPOOLF)    \nC                   CALL      'QCMDEXC'                      \nC                   PARM                    SPOOLF           \nC                   PARM                    SPOOLFLEN        \n```    \n\nThe code above is typically launched as a result of a function key being pressed. By default the spool viewer shows spool files for the current user. However, don’t forget that the ASNASPLF10 library must be in the library list.\n"
        }
    },
    {
        "dirent": {
            "name": "stretch-session-timeout.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to stretch ASP.NET session timeout",
                "description": "This article shows how to stretch ASP.NET session timeout. This technique is good for Wings and Monarch to limit aborted session length.",
                "tags": [
                    "asp-net",
                    "datagate-ibm-i",
                    "mobile-rpg",
                    "monarch",
                    "wings"
                ],
                "date_published": "2024-01-09T00:43:06.000Z",
                "date_updated": "2024-01-09T06:47:21.000Z",
                "date_created": "2024-01-09T06:47:21.000Z",
                "pinned": false
            },
            "content": "\n\nMost AVR-driven ASP.NET Websites use the Session object to save the state of some variables. For example, a customer number may be stashed in a Session variable like this:\n\n    Session['custom-number'] = 673\n    \n\nwhen the user requests a page (the same page or another page), that value is available for your logic to fetch and do something with. For example, let's assume the user clicks a button to take the app to a new page and that page's logic needs the current customer number. That number could be fetched in the code-behind like this:\n\n```\nCustNo =  Int32.Parse(Session['customer-number']) \n```\n\n(As an aside, session variables must also be converted to a specific type before assigning them to a typed variable)\n\n### How long is that customer number available?\n\nThat customer number is available for as long as the Session object is active. Session life is dictated by the ASP.NET Session timeout value. Each time a postback occurs the timeout clock starts anew. The default timeout value is 20 minutes, or [you can explicitly set it to a given value in the web.config file.](https://msdn.microsoft.com/en-us/library/h6bb9cz9(VS.71).aspx) For example, this web.config setting sets session timeout to 60 minutes:\n\n```\n<sessionState timeout=\"60\"/>\n```\n\nThe `timeout` value must be provided in minutes. As long as the user causes a postback to the server within the timeout value, the session is persisted and therefore the customer number in the session variable is persisted. Assuming a default 20-minute session timeout, if the user leaves a page idle for an 18-minute coffee break, the value is persisted and the app continues normally. However, if the user leaves a page idle during a 22-minute coffee break, the next time the user attempts a postback (by clicking an app button or some other interaction with the app) the customer number is no longer available (which most likely manifests itself with the notorious \"Object reference not set to an instance of an object\" error message and the app stops working.\n\nIn some cases, session timeout more than 20 minutes long is desirable. Consider an app in use on a shop room floor. An engineer may be going back and forth between the assembly line and the app many times during the day. In that case, the customer must persist for more than 20 minutes. I've heard of 8 or even 12-hour session timeouts to avoid timeout issues in a case like this.\n\nThe problem with very long session timeouts is that the session timeout also often dictates when application \"clean up\" operations are performed. This is especially true with an application modernized with ASNA Wings, ASNA Monarch, or a custom mobile app written with ASNA Mobile RPG. In those cases, the associated IBM i job will not end until the session ends. Beyond those examples, though, you may have clean-up processes of your own triggered by `Session_End` event handler (as defined in the `global.asax` file).\n\nThe important thing to remember is that the user session doesn't end on the server until the session timeout value has expired. Any server-side operations based on session timeout occurring don't occur when the browser closes, but rather when the session times out. The server has no knowledge of the user simply closing the browser. That client-side action imposes no control on session time-out. As a general rule, once the user is done with the app (ie, when the user closes the browser), you want your clean-up operations to perform as soon as possible.\n\n### Stretching session timeout\n\nAn alternative to a hard-coded session timeout is stretching the session. There isn't a session-stretching mechanism built into .NET, but it's pretty easy to roll your own—and it requires no JavaScript. Using this technique, a user's session won't ever timeout under regular activity. However, after the user closes the browser or the browser tab in use, that user's session expires in three minutes.\n\n**Step 1.** The key to this technique is using the much maligned HTML `iFrame` tag. If your app uses master pages, add this code to the master pages' markup under the body `tag` (if you aren't using master pages, you'll need to add this code to _every_ page's markup):\n\n```\n<iframe src=\"<%=Page.ResolveClientUrl(\"~/StretchSession.aspx\")%>\"width=\"0\" height=\"0\" style=\"display:none;\">\n```\n   \nThe `iframe` tag has an inline style tag with `display:none`. Without this style, the `iframe` displays an odd little mark on the page.\n\n**Step 2.** In the `web.config`, set the session timeout to three minutes:\n\n```\n      <system.web>\n        <sessionState timeout=\"3\"/>\n        <compilation debug=\"true\" targetFramework=\"4.5\"/>\n      </system.web>\n```      \n\nThe timeout value you're setting here controls how quickly the session times out of the server when the user closes the browser. As long as the user has the app running in a browser, its session will be stretched indefinitely. Depending on your on your needs, you may make this value greater than three minutes, but, as will soon be discussed, don't set it for much less than three minutes. \n\n**Step 3.** In the root of the app, create a page called `StretchSession.aspx`, being sure to _not_ specify a master page for this page. This page will never be seen by users. In the markup for the `SesssionStretch.aspx` page, add these three lines to its `head` tag:\n\n```\n<head runat=\"server\">\n    <meta http-equiv=\"cache-control\" content=\"no-cache\">\n    <meta http-equiv=\"expires\" content=\"0\"> \n    <meta http-equiv=\"refresh\" content=\"55;url='StretchSession.aspx'\"/> \n</head>\n```    \n\nThese three `meta` tags are the key to this technique, with the `meta http-equiv=\"refresh\"` doing the most interesting thing. This line reloads `StretchSession.aspx` automatically every 55 seconds or so (this meta tag is how this technique avoids JavaScript). When this page refreshes, a postback doesn't occur because the page is loaded within the `iframe` in the master page (or the current page if you aren't using master pages). The reload of this page 55 seconds restarts the session timeout clock. Recall that the session timeout is configured for three minutes. The difference between the 55-second refresh and the three minutes is to ensure that a little network latency doesn't cause problems.\n\nA first pass at this technique had the meta refresh tag load a simple HTML file on the theory that sending _any_ request back to the server would refresh the session timeout. However, a quick bit of testing showed an ASPX page was required to stretch the session (even though the page has no code). I am guessing, but the ASPX page is probably required to ensure the ASP.NET pipeline is invoked when the `StretchSession` page is sent.\n\nOnce you get your app running, fire up your favorite Web browser developer tools. You'll see that the meta tag submits your StretchSession page submitted every 55 seconds or so, with no flicker or other artifacts of the page being submitted—but that page submission causes the session to get stretched (\"refreshed\" might be a better word)."
        }
    },
    {
        "dirent": {
            "name": "the-ai-train.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Don't miss the AI train!",
                "description": "The programming landscape is bright with the promise of AI. Don't wait for the AI train. Migrate your application today to C# with ASNA Monarch and get onboard!",
                "tags": [
                    "ai"
                ],
                "date_published": "2024-12-03T00:00:00.000Z",
                "date_updated": "2024-12-03T00:00:00.000Z",
                "date_created": "2024-12-03T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\nimport Image from \"$components/text-decorators/Image.svelte\";\n</script>\n\n<Image src=\"https://asna-assets.nyc3.digitaloceanspaces.com/assets/articles/ai-train.png\"\nalt=\"The AI training barreling down the tracks\"\nwidth=\"100%\" alignment=\"center\" hide_caption=true\n/>\n\nBusinesses have experienced a great many fundamental and jarring shifts in the way data processing propels their business over many decades. From:\n\n- Paper and pencil to computer processing\n- Punched cards to sophisticated IDEs\n- From assembler to C#\n- From procedural code to object-oriented and function code\n- From twinax-tethered applications to smartphones\n\nWe've seen many changes. However, it's quite likely that the impact of generative AI will have a far greater impact than all of the previous changes put together. Is there hype around AI? You bet. But even today, in the infancy of commodity AI, AI brings about real productivity gains, substantial workflow improvements, and opens the door to many new possibilities.\n\n## AI and RPG\n\nAt ASNA, we're very excited about the promise of AI. Our R&D team has spent the last several months exploring AI to how it can improve our abilities to migrate an IBM i RPG application to .NET. We're pretty proud of the fact that without AI's help we've already got a migration suite that is able to migrate 99% of an RPG application without any manual remediation. However, we're always looking to improve our toolsets and we think AI will ultimately be substantial help. We've done enough work with AI and RPG to be quite excited by the promise, but the deliverable just isn't there yet. AI and RPG still need a little more time in the oven.\n\nWhile AI generally is in its infancy, using generative AI for work with RPG is a virtual newborn. AI's ability to generate reliable and complete RPG is still ahead of us. Before we get there, LLMs need to acquire enough \"knowledge\" of RPG, its well-known patterns and idiomatic uses, to be truly helpful. See Joe Pluta's [recent MC Press article](https://www.mcpressonline.com/programming/rpg/practical-rpg-ai-and-ibm-i) about his experiences with AI and RPG.\n\n## What can AI do for you now?\n\nAll that said, our migration engineers are not only excited about the promise but also about the deliverable using AI with C#. We're using it for a variety of tasks for honing and improving ASNA migrated RPG applications to C# for .NET Core. As you ponder the future of your RPG application, consider what you can do with that application once it's been migrated to C#.\n\nFor example, for C# today generative AI today can help with :\n\n### Code Understanding and Navigation\n- Generate summaries or inline comments for methods, classes, and logic\n- Identify undocumented or outdated comments\n- Answer questions about specific code snippets\n \n### Development and Enhancement\n- Create boilerplate code for new features (e.g., CRUD operations)\n- Propose improvements for readability, maintainability, and performance\n- Check code quality and adherence to best practices\n- Write unit and integration tests\n\n### Database Management\n- Suggest improvements to your database schema for better performance and scalability\n- Suggest indexing strategies or schema changes\n- Generate migration scripts to modify your database schema without data loss\n\n### Security\n- Scan your code for common security vulnerabilities and exposures\n- Enforce best practices for input validation, authentication\n\n### Team Collaboration\n- Analyze pull requests for potential bugs, coding standards, or inefficiencies\n- Suggest structured commit messages\n- Assist with merging conflicts or understanding complex diffs\n\n### UI/UX Improvements\n- Propose, and help implement, improvements to Razor view templates for better accessibility or responsiveness\n- Recommend layout adjustments or styling updates\n\n### DevOps and Automation\n- Create or troubleshoot CI/CD pipelines for deploying the MVC app\n- Help set up application performance monitoring tools\n- Configure alerts for potential issues like high database usage or long page load times\n \nThe programming landscape is bright with the promise of AI. Don't wait for the AI train. Migrate your application today to C# with ASNA Monarch and get onboard!\n"
        }
    },
    {
        "dirent": {
            "name": "take-asp-net-offline.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to easily take an ASP.NET site offline",
                "description": "How to easily take an ASNA Visual RPG ASP.NET site offline.",
                "tags": [
                    "asp-net",
                    "mobile-rpg",
                    "monarch",
                    "visual-rpg",
                    "wings"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T20:03:29.000Z",
                "date_created": "2024-01-09T20:03:29.000Z",
                "pinned": false
            },
            "content": "\nAll Websites or Web servers need maintenance from time to time. This article shows a very simple little ASP.NET tip that can easily keep users from accessing your site during maintenance. This is something to consider doing anytime you need to upgrade your ASNA WebPak or DataGate for IBM i, or redeploy your Web app.\n\nTo keep users from using your ASP.NET site while you’re doing maintenances or upgrades, all you need to is add an HTML file named `app_offline.htm` in the root of the site. The name is very important–it’s not case sensitive but it must be named exactly as shown (`app-offline.html` won’t work.)\n\nWhen this file is present, ASP.NET brings the application domain down and shows the contents of the `app_offline.html` file. You can provide any info necessary in that HTML. You can add any HTML content you want to this HTML file. You might want to use something a little more graceful than a picture of Homer Simpson!dd\n\n![Take an ASP.NET application offline](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/app-offline.jpg)\n\n> If any users are active when you add the file to your sites root, those users’ next requests will fail. If they were in the middle of an add or update operation, that process will fail. Be sure to schedule your downtime ahead of time with your end users.\n\nWhen `app_offline.htm` is shown, the URL shows whatever URL the user requested. When you’re ready to bring the application backup, remove or rename the `app_offline.htm` file. The next user request brings the site back up.\n\n[Read more about taking ASP.NET sites down.](https://learn.microsoft.com/en-us/aspnet/web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy)"
        }
    },
    {
        "dirent": {
            "name": "understanding-datagate-for-ibm-i-service-jobs.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Understanding DataGate for IBM i service jobs",
                "description": "How to identify the IBM i jobs that DataGate for IBM i creates and uses",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2023-11-14T19:43:42.548Z",
                "date_updated": "2023-11-14T19:43:42.548Z",
                "date_created": "2023-11-14T19:43:42.548Z",
                "pinned": false
            },
            "content": "  \nThis article applies to DataGate for IBM i 7.x and up.\n\n## DataGate's service jobs\n\nOnce DataGate for IBM i is installed and running, there will be several DataGate jobs running in an IBM i subsystem. The default subsystem is QINTER but that can be overridden during DataGate installation (see this article [for more information on creating a DataGate-specific IBM i subsystem]()\n\nThe jobs listed in Figure 1 are the default jobs that run when DataGate for IBM i starts. These jobs handle all the necessary requests from DataGate clients. These jobs are defined by the JOBQE (Job Queue Entries) created during DataGate for IBM i installation:\n\n### DataGate 15.x and lower\n\n|Identifier|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |--- |\n|A|DG8SVC|D8SVCPRF|BCH|CMD-DG8SVC|\n|B|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n|C|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n|D|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n\nThe B-D jobs (CMD-DG8\\_START) handle new incoming DataGate connections. Once the request has been fulfilled and the user job has been created (See \"various jobs...\" section below), the CMD-DG8\\_START job will end and a new one will be created in its place. These events will be logged in the job log for the DG8SVC jobs and/or spool file for the DataGate service profile (DG8SVCPRF).\n\n### DataGate 16.x and above\n\n|Identifier|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |--- |\n|A|DG8SVC|D8SVCPRF|BCH|CMD-DG8SVC|\n|X|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n|Y|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n|Z|DG8SVC|D8SVCPRF|BCH|CMD-DG8_START|\n\nIn DataGate 16.x and above, the X-Z Jobs have a similar function to the B-D Jobs of the previous versions but new IBM i system APIs allow us to reuse these X-Z jobs for new connections. So they do not end until DG8SVC ends, for a moderate boost in efficiency. Also their job logs show a message for each new DG8\\_NET job they start.\n\n## D8SVC jobs where function is CMD-DG8SVC**\n\nFor any given instance of DataGate, there is one one DG8SVC job with the function CMD-DG8SVC. This job is always present when its instance of DataGate is running. For shops running a single instance of DataGate, you'll see one of these jobs active when your DataGate instance is running. When multiple instances of DataGate are installed, you'll see one of these jobs for each DataGate instance that is running. This job's job log clearly identifies the DataGate library (and therefore, the DataGate instance) with which it is associated. If you want to know what versions of DataGate are running, a look at the job logs for these jobs\n\n## DataGate DG8\\_START jobs**\n\nEach time DataGate needs to authenticate a user it uses an instance of a DG8\\_START job (shown below). Prior to DataGate 16.x, DG8\\_START were \"transient\" jobs, in that they only lived long enough to authenticate and submit a DataGate end-user job (a DG8\\_NET job). To avoid the need to spin up DG8\\_START jobs on demand, starting with DataGate 16.x there will be a steady three DG8\\_START at the ready. These three jobs use zero CPU as they are hanging out awaiting the need to authenticate a user. There are three of them available to handle \"bursts\" of new authentications (ie, when multiple users need concurrent authentication). \n\n|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |\n|DG8_START|D8SVCPRF|BCI|PGM-DATAGATE|\n|DG8_START|D8SVCPRF|BCI|PGM-DATAGATE|\n|DG8_START|D8SVCPRF|BCI|PGM-DATAGATE|\n\nort of. Before v16 they were \"transient\" jobs, in that they only lived long enough to authenticate and submit the dg8\\_net job. Then dg8\\_ svc would create the new dg8\\_net jobs as needed\n\n## Additional DataGate service jobs for Wings, Mobile RPG and Browser Terminal (BTerm)\n\n|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |\n|DG8SVC|D8SVCPRF|BCH|CMD-DG8SVC|\n\n|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |\n|ASNAREG|DG8SVCPRF|BCH|PGM-REGISTER|\n|DGTNTRLY|DG8SVCPRF|BCI|PGM-DGTNTRLY|\n\nASNAREG is the license manager for Wings, Mobile RPG, and Browser Terminal jobs. DGTNTRLY is a TCP/IP helper job for Wings, Mobile RPG, and Browser Terminal jobs.\n\n## DataGate end-user jobs\n\nAfter a successful user connection is established on the IBM i with DataGate two more jobs appear:\n\n|Subsystem/Job|User|Type|Function|\n|--- |--- |--- |--- |\n|DG8LICNET|DG8SVCPRF|BCH|CMD-DGLICMGR|\n|DG8_NET|[DG user]|BCH|CMD-DATAGATE|\n\nThe first job to be executed will be DG8LICNET, the DataGate for IBM i License Manager. This verifies DataGate licensing. After the DataGate for IBM License Manager Job is established, it remains active until the DataGate/400 Server is shut down. Note, as shown in the DataGate service jobs section, ASNAREG verifies licensing for Wings, Mobile RPG, and Browser Terminal.\n\nWith licensing confirmed a DG8\\_NET user job is created. DG8\\_NET user jobs come and go as user applications connect and disconnect to DataGate. The status and CPU percentage vary per job. The user profile (shown as \\[DG user\\] above) for a user job will be the user name associated with the DataGate Database Name on the DataGate client PC (for fat clients) or server (for Web apps)."
        }
    },
    {
        "dirent": {
            "name": "upload-download-source-ftp.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using FTP to send and receive IBM i source members",
                "description": "This article shows how to use Windows' FTP to upload and download IBM i source members from and to your PC.",
                "tags": [
                    "ibm-i"
                ],
                "date_published": "2024-01-08T23:31:20.000Z",
                "date_updated": "2024-01-09T06:33:07.000Z",
                "date_created": "2024-01-09T06:33:07.000Z",
                "pinned": false
            },
            "content": "\nOccasionally you might need to send or receive a source member from/to your Windows PC and the IBM i. Assuming your IBM i has FTP enabled, it's a snap to perform this task with Windows' built-in FTP client.\n\n> To further explore FTP on Windows, see the [list of Windows FTP commands](http://www.nsftools.com/tips/MSFTP.htm) .\n\nTo start FTP on Windows, open a DOS command line and type `FTP` and press enter. Use the following commands to receive or a send a member from and to the IBM i.\n\nUse these FTP commands to retrieve an IBM i source member to a PC file:\n\n```\nftp\nopen  (Enter user ID and password as prompted)   \nquote site namefmt 0\nascii\nget library/file.member pcfilename      \n```    \n\nThe `quote site namefmt 0` command enables the `library/file.member` naming for the ftp `get` and `put` commands. See MC Press's detailed explanation of `namefmt` for more details (I'm pretty sure it was written by [IBM midrange guru Joe Hertvik](http://joehertvik.com/) ). The `ascii` command ensures you're receiving or sending ASCII data.\n\nUse these FTP commands to send a PC file to an IBM i source member:\n\n```\nftp \nopen  \n(Enter user ID and password as prompted)\nquote site namefmt 0\nascii\nput pcfilename library/file.member\n```    \n\nWhen you use FTP to send a new member to the IBM i, its source type and description won't be set. Use PDM or the CHGPFM command to change those.\n\n## A bonus FTP tip\n\nHere's an interesting FTP tip that is perhaps more revealing than it is useful. Assuming you have the proper authority to the IBM i object, you can use FTP to submit commands to the IBM i. For example, if you wanted to use FTP to also set the source type and description for a member, you could call CHGPFM like this:\n\n```\n    ftp \n    open  (Enter user ID and password as prompted)\n    quote rcmd chgpfm file(rpglesrc/mylib) mbr(mymbr) srctype(RPG) > description('My source member')\n```\nThere are two take-aways here:\n\n1.  **FTP, in the right hands, can be pretty cool.** I've hacked together a nice little workflow for myself that enables me to edit code on my PC, and quickly and easily get it to and from the IBM i with FTP (Some things never change! I've been doing variations of this since 1991!). Enterprising programmers could easily build some handy batch files to automate this kind of FTP work.\n2.  **FTP, in the wrong hands, can wreak untold havoc!** Keep your objects locked down with appropriate authorities and, if you're going to use FTP with Windows and your IBM i, consider adding [an FTP exit program to your IBM i](http://www-01.ibm.com/support/docview.wss?uid=nas8N1018050) for extra protection against FTP gone wild!\n\n"
        }
    },
    {
        "dirent": {
            "name": "uninstall-datagate-for-ibm-i.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to uninstall DataGate for the IBM i",
                "description": "This article explains how to uninstall one or all instances of ASNA DataGate for IBM i. Please read it carefully before starting the uninstall process.",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2024-01-08T21:34:25.000Z",
                "date_updated": "2024-01-09T03:39:28.000Z",
                "date_created": "2024-01-09T03:39:28.000Z",
                "pinned": false
            },
            "content": "\nThis article explains how to uninstall one or all instances of ASNA DataGate for IBM i. Please read it carefully before starting the uninstall process.\n\n## Important considerations\n\n* If you are running multiple instances or versions of DataGate and want to uninstall a single DataGate instance, do not delete or rename the ASNA_DG8 library or the DG8SVCPRF user profile. These are required for all installed instances of DataGate. Deleting these objects will render all installations of DataGate on the machine inoperable .\n\n* If you are running multiple instances or versions of DataGate, we strongly recommend that you ensure that there are no active jobs for any of these instances/versions before removing a DataGate instance. It’s easy to confuse which version of DataGate has active jobs, and by ensuring no DataGate users are active helps avoid uninstall issues.\n\n* Do not attempt to remove a DataGate instance before all of its end-user jobs have ended. This is explained in detail below.\n\n## To uninstall a DataGate instance you will need these four values:\n\n**[DG Subsystem]** – the subsystem into which DataGate is installed . By default, DataGate installs into the QINTER subsystem. If the DataGate instance you want to uninstall is running, you can confirm’s its subsystem by using WRKACTJOB to display the Job Status Attributes on a DataGate end-user DG8_NET job (the subsystem is shown at the bottom of the display). [See this article for finding DataGate end-user jobs.](/en/kb/datagate-for-ibm-i-end-user-jobs) If the DataGate instance you want to uninstall is not running, you’ll need to check with your System Administrator for DataGate’s subsystem name.\n\n**[DG Library]** – the name of the target DataGate library to uninstall . By default this name is DG8_`xxy` where `xx` is the major version and `y` is the minor version of DataGate. For example, the default DataGate library for DataGate 16.0 is DG8_160 . If you don’t know the name of your DataGate instance’s library, see this article .\n\n**[DG Service Table Entry]** – the name of the Service Table Entry for **[DG Library]**. [Use this article to determine DataGate service table entry name](/en/kb/check-datagate-for-ibm-i-ip-port).\n\n**[DG TCP/IP port]** – the TCP/IP port that uses. Use the same article from above to determine what TCP/IP port DataGate uses.\n\n## Remove the DataGate instance\n\nWith the four values from above available, you’re ready to uninstall DataGate.\n\n**Step 1.** End DataGate on the IBM i. Before you start the uninstall, it is very important that you are sure that no user jobs are running and that DataGate is stopped before you attempt to uninstall DataGate. See this article for how to end DataGate on the IBM i.\n\n**Step 2.** Remove DataGate job queue entries. Use RMVJOBQE to remove DataGate and DG8_SVC job queue entries from your **[DG \nLibrary]**.\n\n![Remove DataGate's job queue entries](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_JPge9QCTAK.png)\n\nIn the figures above, the respective job queue entries are removed from the DG8_160 library that was installed in the QINTER subsystem.\n\n**Step 3.** Delete job queues. Use DLTJOBQ to remove DataGate and DG8_SVC job queues from your **[DG Library]**.\n\n![Delete DataGate's job queues](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_LqPSN7TFDt.png)\n\n\n**Step 4. Remove DataGate's service table entry.**\n\nUse the RMVSRVTBLE command to delete DataGate’s service table entry. As explained above, this article shows how to determine DataGate’s service table entry and its TCP/IP port.\n\n![Remove DataGate's service table entry](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_OnWKCy8lBs.png)\n\nBoth the Service and Protocol parameters are case-sensitive. Enter these values carefully.\n\n**Step 5. Delete DataGate's library.**\n\nUse the DLTLIB command to delete DataGate's library.\n\n![Delete DataGate's library](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/tn5250_vX3KPmPwpu.png)\n\nThe DataGate instance is now uninstalled.\n\n**Step 6. If you are removing DataGate to get a clean uninstall for a reinstall.**\n\nAfter being sure that there are no users of any instance of DataGate, remove the DG8SVCPRF user profile.\n\n```\nDLTUSRPRF USRPRF(DG8SVCPRF)\n```\nReinstalling DataGate will add the DG8SVCPRF user profile back (and ensure all of its authorities are correct) for all DataGate instances.\n\n**Step 7. If you were removing DataGate to get a clean uninstall for a reinstall.**\n\nYou can [reinstall DataGate now.](https://docs.asna.com/documentation/Help160/DG400/_HTML/Installation.htm)\n\n## To remove all instances of DataGate entirely\n\nBefore continuing, ensure that there are no DataGate end-users active.\n\n**Step 1. Remove all instances of DataGate using the per-instance instructions above (stopping at Step 5).**\n\n**Step 2. Remove the DG8SVCPRF user profile.**\n\n```\nDLTUSRPRF USRPRF(DG8SVCPRF)\n```\n**Step 3. Delete the ASNA\\_DG8 library.**\n\n```\nDLTLIB ASNA_DG8\n```\nDataGate is now completely removed from your system.\n"
        }
    },
    {
        "dirent": {
            "name": "third-party-com-controls.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "AVR Classic and third-party controls",
                "description": "This article describes issues and conflicts with third-party controls and ASNA Visual RPG Classic.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T04:51:09.000Z",
                "date_created": "2024-01-10T04:51:09.000Z",
                "pinned": false
            },
            "content": "ASNA Visual RPG (AVR) Classic is a COM-based Visual RPG development environment. Version 1.0 was released in 1994. While many retired versions may still be in use, there are currently two versions versions supported by ASNA:\n\n*   **AVR Classic 5.1**, introduced in 2018, used a newer version of the Microsoft C++ compiler to help ensure ongoing interoperability with later versions of Windows 8 and 10.\n*   **AVR Classic 5.2**, introduced in 2023, was released because of the C++ with which AVR 5.1 was compiled reached end-of-life. \n\nAVR 5.1 and 5.2 are direct ports of AVR 4.x and don't introduce any new language features. They exist solely to provide support for Windows and 10/11.\n\n> When it was originally released, AVR 5.0 supported versions of Windows earlier than Windows 10 and 11. Microsoft has since retired those Windows versions. AVR 5.1 and 5.2 are supported on Windows 10 and 11.\n\nAlthough AVR 4.x doesn't support Windows 10/11, we know that some customers do use AVR 4.x on Windows 10/11. Our testing shows AVR 4.0 works only intermittently on these newer Windows platforms. We have seen an AVR 4.x program work fine on one Windows 10 box and fail on another.\n\n#### From godsend to Achilles' Heel\n\nMicrosoft's Visual Basic 1.0 was first released in 1991. While VB was first dismissed as a \"toy\" language by many (and, indeed, that criticism may have been warranted because VB 1.0 didn't natively have any database support!) by the time VB 3.0 was released in 1993 the enterprise was starting to take Visual Basic seriously. One of the major reasons that VB was successful was because of its support for third-party controls. It didn't take long for an entire new cottage industry of control vendors, from big companies to mom and pop shops to appear.\n\n> [Here is a great story](http://www.forestmoon.com/birthofvb/birthofvb.html) about how Bill Gates insisted that VB 1.0 not be released without support for third-party controls.\n\nBy the time AVR 4.0 was released, AVR supported nearly all third-party OCX and ActiveX controls originally intended for VB. Like VB programmers, AVR programmers quickly embraced third-party controls. Tabs, masked input, collapsible treeviews, and a zillion other cool features were implemented with custom controls. These controls added not only important features, but also added a professional polish to the user interface. If you were around back then you'll remember control vendor names such as Bcubed, Crescent, FarPoint, Larcom and Young, Mabry, Sheridan, Vantage Point. These vendors are all gone now.\n\nAlas, while these third-party controls enabled great AVR applications in the 1990s and early 2000s, third-party controls are often the Achilles Heal of these COM applications today. ASNA invested heavily in AVR 5.x to ensure Windows 8/10 64-bit interoperability. However, virtually all third-party COM vendors have disappeared and those old COM control binaries used today are exactly the same binaries used back in the day with 16/32-bit Windows 95 and Windows XP. And while Microsoft certainly hasn't gone out of business, it has for all intents and purposes divested itself of the COM business. Which means that most of Microsoft's old COM controls are as troublesome as any obsolete third-party vendor's controls.\n\n### COM control inconsistencies\n\nThere are some known, consistent trouble-maker COM controls for AVR. For example, we've not heard of anyone successfully using the Larcom and Young resizing control–and for many the FarPoint tab control is troublesome (especially with licensing). However, many controls offer inconsistent behavior. Support for many of them can vary from one Windows 10 PC to the next. What works on one PC may not work on another PC.\n\n> Another issue we see every couple of months is a customer who has lost a third-party control license. In this case, while the control may indeed be working well on Windows 10, it won't work on a new PC without a license. With the vendors all gone, these licenses are virtually impossible to get.\n\nPart of this problem may be that there isn't really such a thing as a standard Windows 10 PC. Since its introduction in 2015, Windows 10 has had [several major updates.](https://en.wikipedia.org/wiki/Windows_10_version_history) By saying that [\"Windows 10 is the last version of Windows,\"](https://www.windowscentral.com/windows-10-may-be-last-version-windows-microsoft-rethinks-operating-system) Microsoft was really saying, \"You'll occasionally get what amounts to new Windows versions until hell freezes over through our recurring update process.\" (Windows 10 v2004, from May 2020, was a major Windows update.) Or maybe,¯\\\\ _(ツ)_ /¯, that isn't part of the problem! All we really know is that some COM controls exhibit inconsistent and unreliable behavior across seemingly similar Windows 10 PCs.\n\nAnother known recurring COM issue is inconsistent registration behavior. From the command line the registration utility may indicate the DLL or OCX was successfully registered, but then the control may not show as registered in ASNA Visual RPG. As with the other issues, we've seen this behavior on one PC and not another. \n\n> To see what Windows 10 version you're using, press \"Windows key\" + R and then type `winver` in the input field shown. A small dialog displays your Windows version.\n\nThese control issues also apply to the graph control that originally shipped with AVR Classic. The vendor who provided this control to us has been out of business for a very long time. The control is no longer supported in AVR Classic — it is known to cause intermittent issues on Windows 10 and 11. [See this page](/en/kb/third-party-com-controls) for more information about COM controls and AVR Classic.\n\nThe underlying issues with all of the old COM controls is that, unlike the AVR 5x family, they were all produced with compilers that substantially predate Windows 10 and 11. The 20+ year binaries those old 32-bit compilers produced have unpredictable fidelity with 64-bit Windows 10 and 11. \n\n#### Our advice to AVR Classic customers\n\n*  The bottom line is that 20+ year-old COM controls are known to be highly unpredictable on Windows 10 and higher. When a third-party control misbehaves, that behavior is beyond our control and there isn't much we can do about it.\n\n*   If you're using any version of AVR Class less than 5.1, start now to chart your course to upgrade to AVR 5.1 or 5.2. Tech support is not available for any version under 5.1. Upgrading involves recompiling your programs and redeploying a new runtime, but it doesn't require any code changes. A planned, methodical upgrade to AVR 5.1 does require effort, but not as much a panic-driven upgrade because AVR 4.x stopped working on a new Windows 10 version.\n        \n*   Take an inventory of every third-party control you use. If there are any you can remove, we suggest that. Also, be sure to keep track of your third-party control licenses. Make sure you understand how they are licensed and if the licenses will move successfully to new PCs.\n    \n*   Don't start using any additional third-party controls. Don't make your hole deeper than it already is.\n    \n*   Test AVR Classic deployments on new PCs and Windows upgrades very carefully.\n    \n*   Take a more active awareness of Windows updates, what versions of Windows 10 you have deployed, and carefully manage upgrades to major new Windows 10 versions. [This is a helpful article about Windows updates.](https://www.zdnet.com/article/faq-how-to-manage-windows-10-updates/)\n\n*   And finally, in the longer term, it's important for AVR Classic customers to acknowledge that AVR Classic won't persist forever— due to external forces beyond our control. How COM's destiny plays out in the upcoming versions of Windows is unknown. Given this unknown, the demise of the ActiveX/OCX eco system, and COM programming talent being hard to find, we think it's prudent that you craft a plan to ultimately upgrade or replace your AVR Classic apps. \n\nThe ASNA Services Team has experience in upgrading and replacing AVR Classic apps. Use the \"Contact Us\" link at the top of this page to ask us about how we can help you craft a long-term plan for your legacy AVR Classic apps. \n\n \n\n    \n"
        }
    },
    {
        "dirent": {
            "name": "test-ip-address-and-port-for-datagate.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to test IP address and port for DataGate on the IBM i",
                "description": "How to use PowerShell's test-netconnection cmdlet to ensure that your IBM i IP address and port are open and available to DataGate for IBM i.",
                "tags": [
                    "datagate-ibm-i",
                    "ibm-i"
                ],
                "date_published": "2023-12-29T10:54:25.000Z",
                "date_updated": "2023-12-29T16:56:58.000Z",
                "date_created": "2023-12-29T16:56:58.000Z",
                "pinned": false
            },
            "content": "\nWhen you have trouble connecting with DataGate for IBM i (especially for new or upgraded installations) the first thing you check is the IP address and the TCP/IP port. This article shows a good way to do that.\n\nDataGate for IBM i needs a TCP/IP port to work. By default, DataGate uses port 5042, but you can change that if you want to.  You can change it during DataGate's installation or you can           [change it after installation with these instructions](/en/kb/change-datagate-for-ibm-i-port)           .\n\nRegardless of the port number that DataGate uses, it's important that the port is open and available to your clients. You can't test port access with the PING utility. You can test it with a Telnet client but that test is a little convoluted.\n\nA better way to ensure that both your IP address and port is working for DataGate is to use PowerShell's           `\n               test-netconnection\n          `           cmdlet.           [PowerShell](https://learn.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.3)           is easily one of the most overlooked Windows tools in the history of Windows. If can do all kinds of cool things and PowerShell scripts are vastly more powerful and less arcane that DOS batch files.\n\n## Testing IP address and ports with PowerShell\n\nTo use this tip, you don't need to write any special PowerShell scripts or even know PowerShell. First, open Windows PowerShell console (the easiest way is by tapping the Windows key and type \"powershell\").\n\n> The DOS command line console cannot execute PowerShell cmdlets. You must use the PowerShell console to run PowerShell cmdlets.\n\nThen, from the PowerShell command line, enter this command:\n\n```\ntest-netconnection -port pppp -computername nnnn\n```\nwhere           `\n               pppp\n          `           is the TCP IP port and           `\n               nnnn\n          `           is the IP address or computer name you want to check.           [Read more about\n               `\n                    test-netconnection\n               `\n               here](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/test-connection?view=powershell-7.3)           .\n\nFor example, this command\n\n```\ntest-netconnection -port 5042 -computername cypress\n```\nchecks that access to the computer named           `\n               cypress\n          `           on the network (an IBM i this case) through port 5042 is available.\n\nIf the           `\n               test-netconnection\n          `           cmdlet succeeds, it reports\n\n```\nComputerName     : cypress\nRemoteAddress    : 10.1.3.207\nRemotePort       : 5042\nInterfaceAlias   : ASNA VPN\nSourceAddress    : 192.168.40.138\nTcpTestSucceeded : True\n```\nIf it fails, it reports:\n\n```\nWARNING: TCP connect to (10.1.3.207 : 5042) failed\n```\nIf the test fails, DataGate won't connect.\n\nTo diagnose things further, first use the           `\n               test-netconnection\n          `           command without the           `\n               -port\n          `           argument to ensure the computer name or IP address is correct.\n\nWhen you're sure the computer name or IP address is correct, when the test fails with the           `\n               -port\n          `           argument provided that almost always means either you are using the wrong port number (           [confirm the port number with these instructions](/en/kb/confirm-datagate-port) or the Windows firewall is blocking access to the port."
        }
    },
    {
        "dirent": {
            "name": "understanding-end-user-jobs.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Understanding DataGate for IBM i end-user jobs",
                "description": "This article explains what DataGate for IBM i end-user jobs are and how to work with them. ",
                "tags": [
                    "datagate-ibm-i"
                ],
                "date_published": "2024-01-05T12:35:56.000Z",
                "date_updated": "2024-01-05T19:26:34.000Z",
                "date_created": "2024-01-05T19:26:34.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Image from '$components/text-decorators/Image.svelte'\n</script>\n\nDataGate for IBM i end-user jobs are the jobs that do end-user work. They are created and used by ASNA product-related end user jobs. [See this article for how to find DataGate for IBM i end-user jobs.](/en/kb/datagate-for-ibm-i-end-user-jobs)\n\nIt is strongly recommended that you not end the DataGate service on the IBM i (ENDDG8SVR) until all end-user jobs are ended-either normally or manually. Ending DataGate with active user jobs leaves object locks and other artifacts danglng that make it challenging to restart DataGate. To end all end-user jobs, you need ot know how to identify end-user jobs. This article explains how to do that.\n\nWhen a user connects to the IBM i, a corresponding job is created on the IBM i. These jobs can be found with WRKACTJOB or WRKSBSJOB and are listed as DG8\\_NET jobs (you can see one at the end of the WRKACTJOB display below).\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/work-fat-web-job-1.png\" alt=\"Using WRKACTJOB to find DataGate end-user jobs\" width=\"600\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nFigure 1. Using WRKACTJOB to find DataGate end-user jobs\n\nDataGate end-user jobs are are the DG8\\_NET jobs. Going back in time, prior to DataGate 7.x, these jobs were named DG8\\_43.\n\nTo see more about the job, enter a \"5\" to work with the job then enter a \"10\" to see its job log. For a fat-Windows client you see the following information:\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/fat-job-log.png\" alt=\"A DataGate fat Windows client job log\" width=\"600\" alignment=\"center\" caption=\"Figure 2a.\"/>\n\nNote that the name of the DataGate library is the first thing shown. In this case, this DataGate instance is in library DG8\\_150.\n\nOther useful information in the job log for a fat client apps are:\n\n**JOBNAME**             - to full job name of the corresponding DataGate service job\n\n**CLUSER**           (client user) - the user signed into Windows\n\n**CLTEXT**            - Information about the associated AVR program's process. This shows the Windows machine name (RP-WIN10GIT, the task manager process number (15200), the Windows user again (roger), and the name of the executable. If the AVR program is a Windows fat client the executable will end in \"EXE.\" In this example, an AVR program named DFU.exe is running. If the AVR program is a Web app, rather than showing an EXE, the program will be listed like this [/LM/W3SVC/xxxxx] which indicates the AVR app is running under IIS (Windows' Web server).           [See this article for more on process identification under IIS.](https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms524308%28v=vs.90%29)\n\nIf you were to look at the Windows Task manager you'd see an entry like this for the executable associated with the job shown in Figure 2a. Note the process ID is 15200, which corresponds to the process ID in Figure 2a.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/fat-task-mgr.png\" alt=\"The corresponding Windows Task list entry for the job shown in Figure 2a.\" width=\"600\" alignment=\"center\" caption=\"Figure 2b.\"/>\n\nSimilar information is shown for Web applications in the IBM i job log. However, the value of CLTEXT is a little different.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/web-job-log-1.png\" alt=\"A DataGate Web application Windows client job log\" width=\"600\" alignment=\"center\" caption=\"Figure 3a.\"/>\n\nFor Web applications, CLTEXT doesn't show the executable name, but rather lists the IIS metabase path for the executable (which is associated with either an IIS Web site or virtual directory.\n\nThe CLTEXT shows that the client is associated with Windows process 13196. If you look at the Task Manager on the Windows PC where the Web app is running, you'd see this corresponding Windows task listed as shown below in Figure 3b.\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/web-task-mgr-1.png\" alt=\"The corresponding Windows Task list entry for the job shown in Figure 3a.\" width=\"600\" alignment=\"center\" caption=\"Figure 3b.\"/>\n\n## Lifetime for a DataGate IBM i job\n\nFor fat-Windows clients, the IBM i job will end when the corresponding Windows executable ends. For fat clients, there is one job per Windows executable instance. That is, if a user opens two instances of a Visual RPG fat client app on her PC, each instance has its own job on the IBM i. All fat client jobs originating from the same Windows client count as one seat against DataGate per-seat-based licensing. That is, any one user can have as many executables running from her PC and they all count as one license.\n\nFor Web applications, which use connection pooling, the job ends when it has been inactive for the time specified by ASP.NET's Session Timeout value.           [Read more about connection pooling and IBM i jobs.](/en/kb/datagate-connection-pooling)            Most Web apps today are against a WebPak site license which allows unlimited jobs. But some customers still have per-seat DataGate licenses for DataGate WebPak. With per-seat WebPak licensing, all activity initiated from a user's browser count as one seat against DataGate per-seat-based licensing. That is, any single browser instance can run multiple instances of an AVR/Wings Web app(s) from different browser tabs and those all count as one license.\n"
        }
    },
    {
        "dirent": {
            "name": "using-the-asna-inspector.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Reveal your PC's inner-most secrets using the ASNA Inspector",
                "description": "This article explains how to use the ASNA Inspector reveal tons of details about your PC. The resulting output of the ASNA Inspector  is often very helpful to tech support to resolve issues with ASNA products.",
                "tags": [
                    "utility"
                ],
                "date_updated": "2024-06-24T00:00:00.000Z",
                "date_published": "2024-06-24T00:00:00.000Z",
                "date_created": "2024-06-24T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n<script>\n    import Image from '$components/text-decorators/Image.svelte';\n</script>\n\nMost of ASNA's PC-based installed a very handy diagnostic tool called the ASNA Inspector. The ASNA Inspector is free-standing EXE that collects and reports a variety of information about your PC. This information is contained, and viewed, in a single HTML file that it produces when you run it. For ASNA tech support often uses this HTML file to help us diagnose tech support issues. \n\nThe ASNA Inspector is located at: \n\n```\nC:\\\\Program Files\\\\Common Files\\\\ASNA Shared\\\\ASNA.Inspector.exe\n```\n\nTo run it, find that EXE with Windows' File Explorer and run it. You will first be presented with a dialog that looks like an install dialog. \n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/images/asna-com/asna-inspector.webp\" alt=\"The ASNA Inspector startup dialog\" width=\"500\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nAfter pressing \"Begin\" you're prompted for a target directory into which the HTML file is written. Then click \"Next\" to start the report collection process. In a minute or so the report and you can click a button to display the HTML in your browser. \n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/images/asna-com/asna-inspector-output.webp\" alt=\"The ASNA Inspector HTML output\" width=\"500\" alignment=\"center\" caption=\"Figure 2.\"/>\n\nThe information that the ASNA Inspector HTML file reports includes: \n\n* System\n  * Shows drive details and provides an overview of the Windows version installed.\n* Programs\n  * Shows detailed about the installed programs (mostly the applications listed in Add and Remove programs). This list omits those programs installed through the Microsoft Store.\n* DotNet\n  * Shows detail about the .NET Framework versions installed\n* Visual Studio\n  * Show Visual Studio versions installed and their respective workloads installed.\n* GAC\n  * Shows the ASNA-related binaries installed into the [.NET Framework Global Assembly Cache (GAC)](https://learn.microsoft.com/en-us/dotnet/framework/app-domains/gac)\n* Licensing\n  * If ASNA.Inspector.exe was run as an admin, this shows detail about the ASNA product licenses installed\n* File System\n  * Shows the places on your local file system where ASNA-related files are located, which are typically: \n    * C:\\Program Files\\ASNA\n    * C:\\Program Files\\Common Files\n    * C:\\Program Files (x86)\\ASNA\n    * C:\\Program Files (x86)\\Common Files\n* Services\n  * Shows the installed ASNA Services (or potentially related services such as MSSQLSERVER) \n    * ASNA Assist\n    * ASNA Registrar\n    * DataGate Server\n\nWhen you report an issue to tech support, we may ask you to run the ASNA Inspector and send us its HTML output. \n"
        }
    },
    {
        "dirent": {
            "name": "using-html-data-picker.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "A simple date picker for AVR for .NET ASP.NET websites",
                "description": "This article shows how to use HTML's intrinsic date picker in an ASP.NET web app.",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-08T23:31:20.000Z",
                "date_updated": "2024-01-09T05:32:37.000Z",
                "date_created": "2024-01-09T05:32:37.000Z",
                "pinned": false
            },
            "content": "\nIn the early days of Web development, we had to scrounge around to find solutions to what seemed like the most basic of things. Date input, for example, was a challenging thing to handle manually. To solve the challenge, we often turned to UI libraries. The jQueryUI library offered a date picker component that many used.\n\nBack in the day, this library solved lots of Web development issues. It also provided tabs, menus, and dialogs. Today, though, most of the reasons that we used jQueryUI and its sibling, jQuery have been resolved by HTML and CSS becoming so much more capable.\n\nFor example, HTML acquired a native date picker many years ago. This date picker is very simple to use and offers nearly all of the functionality that the jQueryUI date picker had. Using the native HTML date picker with AVR for .NET and ASP.NET is very easy, but not immediately obvious.\n\nConsider the following code that provides an ASP.NET TextBox control:\n\n```\n<asp:textbox runat=\"server\"></asp:textbox>\n```\n\nThis produces a text box that accepts string input. This ASP.NET control translates to this HTML at runtime:\n\n```\n<input name=\"txtboxDate\" type=\"text\" id=\"txtboxDate\">\n```\nNote how ASP.NET sneaked in the type=\"text\" attribute.\n\nAll it takes to make the ASP.NET Textbox control gracefully prompt for a date is to add a special-case type attribute of Date to your ASPX markup:\n\n```\n<asp:textbox id=\"txtboxDate\" type=\"date\" runat=\"server\"></asp:textbox>\n```\n\nYou have to add the `type=\"Date\"` attribute by hand in the ASPX page markup. By adding that attribute, at runtime the HTML produced changes slightly to include the Date attribute value:\n\n```\n<input id=\"txtboxDate\" name=\"txtboxDate\" type=\"date\">\n```\n\nASP.NET is smart enough to realize that you’ve specified a value for the text attribute and won’t overwrite it with the default Text value. This produces a date input element that looks like this:\n\n![HTML intrinsic date picker](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/date-picker-collapsed.png)\n\nWhen you click the calendar icon HMTL presents its intrinsic date picker:\n\n![HTML datepicker expanded](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/date-picker-expanded.png)\n\nThe format of the date displayed is based on the locale of the user’s browser however the value sent to the server is always passed in the format YYYY-MM-DD. That value comes into your AVR for .NET WebForm code-behind as a string value.\n\n## Assign a default starting date\n\nAssign a default date value as a string in the format \"YYYY-MM-DD.\" Assign the default value before the Web form is presented.\n\n```\ntxtboxDate.Text = \"1959-06-02\"\n```\n\n## Converting the incoming date\n\nConvert the incoming date to a DateTime field:\n\n```\nDclFld shippingDate Type(DateTime)\nshippingDate = DateTime.ParseExact(textBoxShippingDate.Text, \n               \"yyyy-MM-dd\", \n               System.Globalization.CultureInfo.\n               InvariantCulture)\n```\n\nor, to convert it to a numeric value in the format mm-dd-yyyy\n\n```\nDclFLd dateNumber type(*Packed) Len(8,0)\ndateNumber = ShippingDate.ToString(\"MMddyyyy\")\n```\n\n[See this article for more information on date conversion.](/en/kb/visual-rpg-numeric-dates)\n\n## The one downside\n\nThe one downside to using HTML’s intrinsic date picker is that its display cosmetics are left to browser vendors and each browser displays the date picker differently. There are some \n[CSS tricks](https://www.tutorialspoint.com/Style-options-for-the-HTML5-Date-picker) you can use to try to style HTML’s date picker–but I’ve not found any CSS tricks very useful for the date picker."
        }
    },
    {
        "dirent": {
            "name": "upgrading-avr-for-net.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Charting a course for upgrading AVR for .NET",
                "description": "This article describes a strategy for upgrading ASNA Visual RPG for .NET.",
                "tags": [
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T04:48:48.000Z",
                "date_created": "2024-01-10T04:48:48.000Z",
                "pinned": false
            },
            "content": "Editor’s note: This article originally described version-specific upgrade instructions. It has been updated to reflect a general purpose upgrade strategy.\n\n## Question\n\nMy company uses an older version of ASNA Visual RPG and WebPak. What is the path to upgrade to the latest versions of this software–and what issues should we expect?\n\n## Answer\n\nASNA supports the current version of a given product and one version back. As of April 2023, the current version of AVR for .NET is 17.x and it requires Visual Studio 2022. Anytime you’re using a retired version we strongly recommend upgrading to a supported version. \"Supports\" means that the product is tested on its supported platforms and gets updates and fixes. When an ASNA product is retired it is no longer tested and no longer receives any updates. See the the current [ASNA Product Requirements](/en/support/product-requirements) for product support details.\n\n> This guide applies to any version of AVR for .NET from AVR for .NET 12.x and up. If you have a version of AVR for .NET Microsoft older than 12.x, these instructions will probably apply, but updating products that old often require additional remediation to upgrade. This especially true or AVR for .NET 7.x (which was introduced in 2003!);\n\nDon’t be put off by the amount of text provided here. Upgrading is actually a pretty simple process. Some customers, though, may need more details than others. If you are very familiar with ASNA products, you can skip ahead to the “On with the upgrade” subhead.\n\n> If you have any questions about upgrading any ASNA product, give us a call before you start! We’ll be happy to help you fully understand the process and answer your questions.\n\n## Upgrade costs\n\nIn many cases upgrades for AVR for .NET products are included as a part of your ASNA maintenance plan. Please check with your ASNA sales representative to see if you qualify for a free upgrade.\n\n## Downloading products to install\n\nThe ASNA products you need to perform an AVR for .NET upgrade are all [available for download here](/downloads/en). (Don’t forget to read the release notes, if available, for product downloads.)\n\n## AVR runtime frameworks\n\nAVR for .NET produces binary .NET assemblies (executables). These client executables are supported at runtime by one of two ASNA deployment packages:\n\n*   For AVR for .NET ASP.NET Web applications, ASNA DataGate WebPak provides AVR for .NET Web application runtime support. WebPak must be installed on any Web server on which you want to run AVR for .NET binaries for ASP.NET apps. See this article [for more detail on installing WebPak on your server.](/en/kb/upgrade-asna-datagate-webpak).\n\n*   For Windows fat clients, ASNA AVR for .NET Windows Deployment provides AVR for .NET fat client runtime support. Windows Deployment must be installed on any PC on which you want to run AVR for .NET fat client binaries.\n\n> Do not install the AVR for .NET Windows Deployment on a developer PC. The AVR for .NET install includes the development runtime.\n\nGenerally, you don’t need to recompile and redeploy your AVR-compiled binaries when you upgrade the runtime. Older client binaries can be run under new runtimes. That said, again, the older your binaries, the more likely you are to encounter issues. It’s also true that older clients work with newer DataGate server versions. For example, an AVR for .NET 15.x-produced binary connects successfully to DataGate for IBM i 17.x.\n\nDevelopers can install only one version of AVR for .NET on their PC. f you need to have your older AVR for .NET developer environment available, consider setting up a virtual machine with your older software on it for that purpose.\n\n> We recommend keeping your production executable versions within three versions of your WebPak/Windows Deployment version.\n\n## Before you do anything else, backup all of your older Visual RPG projects!\n\nBefore you attempt any upgrade, make sure you have a good backup of your existing Visual RPG projects. Opening an older version AVR project with a newer version of AVR performs an implicit one-way conversion of the project to the newer version. This conversion can’t be undone. If you need to roll the upgrade back, you’ll want to have this backup available. Remember, too, that source control isn’t backup! It’s very important to have a good, byte-for-byte project backup in the rare case where you might need to roll an upgrade back.\n\n## Read our release notes\n\nMost ASNA product downloads have release notes! Please read these carefully for each product you need before attempting to install anything. Release notes provide product requirements and other helpful details.\n\n## Confirm IBM i and/or SQL Server compatibilities\n\nUse the [ASNA Product Requirements](/en/support/product-requirements) to ensure that your IBM i OS version and DataGate for IBM i version are compatible with your upgrade. For example, the Product Requirements page shows that AVR for .NET 16.x requires DataGate 16.x and that DataGate 16.x requires IBM i V7R3 or higher. If you need to upgrade DataGate for IBM i, we recommend you do that before you do anything else. [DataGate installation instructions are available here.](https://docs.asna.com/documentation/Help160/DG400/_HTML/Installation.htm)\n\n[See this link](/en/kb/get-datagate-library-name) for how to determine what version of DataGate for IBM i you are currently using. If you need to upgrade DataGate for SQL Server, we recommend you do that before you do anything else. [Installation instructions are available here.](https://docs.asna.com/documentation/Help160/DSS/_HTML/dssInstallMain.htm)\n\n[See this link](/en/kb/determine-product-version-numbers) for how to determine what version of DataGate for SQL Server you are currently using. DataGate for IBM i and DataGate for SQL Server are both backwards compatible with WebPak/Windows Deployment versions. For example, DataGate for IBM i 16.x is compatible with WebPak 14.x.\n\n## Testing is very important\n\nThe last item on the upgrade list (presented below) is to test your applications thoroughly after having installed your upgrade. We strongly recommend that before installing any upgrades on a production server, you first install things on a test server or test PC and test all applications thoroughly there before attempting the upgrade on a production box. Nearly all upgrades go quite smoothly, but Murphy lurks!\n\n### On with the upgrade\n\nEnough back story! Let’s get on with the upgrade.\n\n## For developer PCs\n\n*   Acquire the version of Visual Studio your new version of AVR requires ([see the Product Requirements page for this info](/en/support/product-requirements). Microsoft used to offer a free Visual Studio \"shell\" into which AVR could be installed. Microsoft has since discontinued these shells effective with Visual Studio 2019 . It also used to be that AVR could be installed into the Visual Studio Community Edition. That is also no longer the case–Microsoft changed how the Community Edition supports third-party products (perhaps to limit the unlicensed use of the Community Edition in the enterprise). For AVR for .NET 16.0 and higher you need [a commercial version of Visual Studio Professional or Enterprise](https://visualstudio.microsoft.com/vs/compare/).\n\n> Unlike AVR for .NET, you can have multiple versions of Visual Studio on a single PC. However, unless you have a compelling need to keep your old version of Visual Studio, we recommend you uninstall it before installing a newer version of Visual Studio.\n\n*   After installing the new Visual Studio, using “Programs and Features” in the Windows Control Panel, remove your older version AVR for .NET. Then do a full install of the newer version of AVR for .NET.\n*   Watch for .NET Framework version changes. Visual Studio will offer to upgrade a project to a newer version of the .NET Framework. AVR for .NET 16.x requires .NET Framework 4.7 or 4.8.\n\n## For Windows servers (for web applications)\n\n*   Uninstall install the new version of ASNA DataGate WebPak that corresponds to the version of AVR you’ve installed.\n*   To be able to maintain ASNA DataGate database names on the server or end-user PCs, download and install the ASNA DataGate Monitor from our downloads page. [Read move about the DataGate Monitor](/en/kb/datagate-monitor).\n\n## For end-user Windows PCs\n\n*   Uninstall your current version of Windows Deployment and then install the newer ASNA Windows Deployment.\n\n## Product licensing\n\n*   After installation, you will need new product licenses. Please send your license requests to codes@asna.com.\n\n## Test, Test, Test\n\nAs mentioned previously, we strongly recommend performing your upgrade on a test server or PC and testing your apps thoroughly there before installing the upgrade on a production box. After the upgrade is installed on your production machine(s), test your applications in the production environment to ensure that all is well.\n"
        }
    },
    {
        "dirent": {
            "name": "understanding-datagate-protocol.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Understanding the DataGate protocol",
                "description": "This article explains several aspects of the ASNA DataGate protocol.",
                "tags": [
                    "datagate",
                    "datagate-ibm-i"
                ],
                "date_published": "2024-05-03T00:00:00.000Z",
                "date_updated": "2024-05-07T00:00:00.000Z",
                "date_created": "2024-05-03T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n* DG is a proprietary RPC protocol implemented over TCP transport protocol. Each client connection \"session\" is a persistent TCP connection between the server’s configured TCP port (default, 5042) and a port assigned by the client system at connection initiation.  Transport mechanics of DG sessions are very similar to TELNET protocol-based console connections to IBM&nbsp;i and other console platforms.\n* DG servers are \"passive listeners\"; sessions can only be initiated by the client.  When a client successfully opens a DG connection, the connection remains open until the client actively closes the connection, or a server/network exception occurs.\n* DG client software optionally supports the \"connection pooling\" feature.  When enabled, programs can use the DG API to \"close\" the application’s connection \"handle\", but the DG protocol connection persists in the software pool of dormant connections until the connection is potentially \"reused\" in a later DG API \"open\" call.  If no such API call occurs, the connection will be closed when it ages out of the pool (\"pooled connection timeout\"), or its process ends, whichever comes first.  Thus, DG TCP connections may remain open for longer than they are in use by the application when connection pooling is enabled.\n* TCP Keepalive is a configuration option found on both IBM&nbsp;i and Windows OS platforms.  It is commonly deployed in order to maintain TCP connections, including DG connections, in \"intricate\" or unstable networks.\n* DG optionally supports .NET NEGOTIATE authentication and data encryption via Kerberos-AD SSO, including an NTLM SSO authentication-only fallback option where available/necessary.\n* DG Windows-based servers (DSS, DG for Windows) optionally support SChannel-based TLS negotiation and data channel encryption, with multiple certificate verification options.  ASNA recommend this option for connections over unsecured networks. By default a Win32-generated, self-signed, \"session\" certificate, created at server startup, is used to authenticate and secure the data channel.  DG Windows servers may be configured, via Windows interfaces, to use and verify a properly configured certificate installed in the server’s \"local machine\" certificate store.\n* DG IBM&nbsp;i-based servers (DG/400) optionally support GSK-based TLS negotiation and data channel encryption, with some certificate options.  ASNA recommend this option for connections over unsecured networks, but only when a proper certificate is configured, via IBM&nbsp;i interfaces, for use with the DG/400 instance. By default, DG/400 uses a self-signed, \"well-known\" certificate, generated by ASNA Release Engineering, and configured during installation. This is only provided for testing purposes.\n* When not using TLS, authenticated NEGOTIATE-based connections to Windows servers (DSS, DG for Windows) automatically inherit Kerberos data channel encryption.  ASNA recommend this option (when TLS is not configured) for connections over secured AD networks.\n* Unsecured, \"clear text\" connections are available for use in secured networks; this is only recommended in scenarios where all users are fully trusted and/or security resources are minimal.\n* Windows client tools (DG Studio, DG Monitor) are used to configure client connection profiles (a.k.a., \"database names\").  By default, the tools create clear-text connection profiles.  TLS options are available in \"advanced\" connection configuration dialogs, and NEGOTIATE may be enabled by specifying the user credential as \"*DOMAIN\".\n* DG .NET client programs support TLS via .NET SslStream (SChannel-based in Windows .NET Framework).  DG .NET clients support NEGOTIATE via NegotiateStream.\n* DG \"Classic\" programs may use an unsupported, prior-generation of DG protocol, which does not include TLS.  The only Windows SSO option for these programs is NTLM."
        }
    },
    {
        "dirent": {
            "name": "update-acceler8db-for-avr-classic.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Upgrading the ASNA Acceler8 local database for AVR Classic",
                "description": "This article shows how to upgrade the ASNA Acceler8 local database. This task is usually done for AVR Classic prior to upgrading AVR Classic--but it also applies to ASNA Visual RPG for .NET.",
                "tags": [
                    "datagate",
                    "visual-rpg"
                ],
                "date_updated": "2024-06-24T00:00:00.000Z",
                "date_published": "2024-06-24T00:00:00.000Z",
                "date_created": "2024-06-24T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\n    import Image from '$components/text-decorators/Image.svelte';\n</script>\nWhen you want to upgrade your ASNA Visual RPG 4.x or AVR 5.0 environments, when you're using the DataGate Acceler8 local database, it's a good idea to first upgrade that the Acceler8 local DB first--and then test your existing 4.x or 5.0 apps with that database. When you've confirmed all is well, then you can upgrade the dev and production environments. \n\n> Your AVR 4.x and 5.0 applications will work with the upgraded Acceler8 database without change. In this article, we'll focus on upgrading ADB 11x to ADB 17x, but the steps taken apply to any version. \n\nTo upgrade an older version of Acceler8 local database is easy but the product download you need isn't very intuitive. The download you need is the ASNA Visual RPG for .NET Framework Windows Deployment 17.0.30.0 (or whatever build number is currently showing for AVR for .NET 17.) [This file is available at here.](https://www.asna.com/downloads/en)\n\n<Image src=\"https://nyc3.digitaloceanspaces.com/asna-assets/images/asna-com/adb-11-to-adb-17-download.webp\" alt=\"Download AVR for .NET Framework 17.0.30.0 Windows deployment\" width=\"500\" alignment=\"center\" caption=\"Figure 1.\"/>\n\nThis download contains the bits to upgrade ADB to ADB 17. Before you run the download installer EXE file, be sure that no users are currently using your database. This is very important. Any active users could lose data if you attempt to perform this upgrade while they are using the database.\n\nWhen you sure there no database users active, all you need to do is run the installer EXE file. This install will stop and remove the previous instance of ADB and install, and start, ADB 17. When the install finishes, the upgrade is complete. \n\n[Watch a YouTube video that shows this upgrade in action.](https://www.youtube.com/watch?v=Y1qQWED1UUA&t=3s&pp=ygUOYXNuYSAgZGF0YWJhc2U%3D)"
        }
    },
    {
        "dirent": {
            "name": "visual-rpg-numeric-dates.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Working with numeric dates in AVR for .NET",
                "description": "This article shows how to use numeric values and date data types with ASNA Visual RPG",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-08T23:31:20.000Z",
                "date_updated": "2024-01-09T05:32:37.000Z",
                "date_created": "2024-01-09T05:32:37.000Z",
                "pinned": false
            },
            "content": "\nWorking with dates is something many RPG programs do extensively. In the old days of AVR Classic, we used to have to use lots of data structures and other special-case code to format dates, convert dates. It was also quite challenging to do date arithmetic and perform other sophisticated date manipulations. AVR for .NET’s `Date`, `Time`, and `*TimeStamp` help resolve all of these issues. However, many shops still store dates (and times) as numeric values in their database. This seems to preclude using some of .NET’s really great date handling and manipulation. This article changes that and shows how to integrate your numeric date and time values with .NET’s great date and time handling.\n\n## Quick look\nDate and time values stored as numeric values in your database are challenging to format, convert, and perform date and time arithmetic functions against. A way to resolve this issue is to convert your date and time fields to true date and time data types in your datebase. That way .NET’s superb date/time formatting and functionality is always for those fields. Alas, converting your database may be quite painful and time-consuming. \n\nThis article presents an alternative: when you read a date or time value from your database, convert it to a true date/time value in the AVR for .NET program. Having done this, all of .NET Framework’s date/time goodness is now available to you. If you change that value and need to write it back to your database, convert that date/time value back to numeric before performing the database write. This article explains how to do this. \n\n## Date formatting numeric date values\n\nIn may older applications, dates are stored as numeric values, usually in the format `yyyy-mm-dd` or `mm-dd-yyyy` (in the US). To quickly format a numeric date value, use the custom numeric formatting .NET offers with its `ToString(`) method, where ‘#’ is a digit placeholder (which emits a given digit) and ‘0’ is a zero placeholder (which zero-suppresses a given digit).\n\n```\nDclFld MyDate Type(*Zoned) Len(8,0)\nDclFld FormattedDate Type(*String)\n\nMyDate = 6021959\n\nFormattedDate = MyDate('00/00/0000')\n// Results in 06/02/1959\n```\n\nIf you don’t want the leading zero in months and days use (where the # characters suppresses leading zeros) and would rather use dash separators:\n\n```\nFormattedDate = MyDate('#0-#0-0000')\n// Results in '6-2-1959'\n```\n\nThere isn’t anything really date-aware about this formatting, you simply providing a mask used to format the string output. If the numeric stored in month/day/year format custom numeric formatting would do exactly what you ask. For example, the code below:\n\n```\nDclFld MyDate Type(*Zoned) Len(8,0)\nDclFld FormattedDate Type(*String)\n\nMyDate = 6021959\n\nFormattedDate = MyDate('0000/00/00')\n// Results in 0602/19/59\n```\n\noutputs a numeric value with the given format string. Numeric formatting is otherwise not really date-aware. Specifiy your formatting characters ) carefully.\n\nYou can also use custom numeric formatting for other purposes. For example to format a social security number stored as numeric:\n\n```\nDclFld SSN Type(*Zoned) Len(7,0)\nDclFld FormattedSSN Type(*String)\n\nSSN = 987-12-3455\n\nFormattedSSN = MyDate('000-00-0000')\n// Results in '987-12-3455'\n```\n\nWhile this quick formatting trick does work for simple formatting, it falls down quickly for more complex tasks. For example, if you have dates stored as numeric values, you often want to do other date things with them such as date arithmetic or format in a value that isn’t natural to the way they are stored. For example, give the numeric value 06021959, you couldn’t easily format it as an ISO date value (yyyy-mm-dd) with custom numeric format. For better date formatting and functionality,you need to be able to quickly convert numeric values to date data types.\n\n## Convert numeric values to date data types\n\nRather than use custom numeric formatting at all, especially with dates, consider converting the numeric values to a true date data type. This provides infinitely more date formatting options and also makes otherwise complex operations exceedingly simple–such as date arithmetic and date conversion. I am not suggesting that you change the way the numeric date is stored in your database (but that would be nice!), but rather in your program, as soon as a numeric date has been read, convert it to a true date data type (and then, if you need to write a new date value back to your database convert the date data type back to numeric–more on this in a moment).\n\nFirst, though, a quick primer on AVR for .NET date (and time) data types. AVR for .NET has three date/time-related data types:\n\n* \\*Date\n* \\*Time\n* \\*TimeStamp\n\nAll three of these date/time values in AVR for .NET are instanced as .NET’s `System.DateTime` data type . In AVR, the *Date data type uses the date portion of the `System.DateTime` structure and the *Time data type uses the time portion of the `System.DataTime` structure. The `*TimeStamp` data type uses both. The following conversion technique leverages the `System.DateTime's ParseExact()` method. Once a numeric value is converted to a `System.DateTime` value, its other properties and methods are available for you to use.\n\nThe code below in Figure 1 is simple inline code to convert an eight-digit numeric value into a date data type:\n\n```\nDclFld NumericDate Type(*Zoned) Len(8,0)\nDclFld NewDate Type(*Date) \nDclFld Provider Type(CultureInfo) \n\nprovider = CultureInfo.InvariantCulture\nNumericDate = 06021959\nNewDate = DateTime.ParseExact(NumericDate.ToString('00000000'), 'MMddyyyy', Provider)\n```\n<small class=\"html-md-figure-caption\">Figure 1. Convert an eight-digit numeric value to a date.</small>\n\n\nThe instance of the CultureInfo (which needs `Using System.Globalization` at the top of your code) ensures the conversion obeys culture-specific formatting rules.\n\nAn important thing to remember with this technique is that the numeric date must be in the format specified (in this case, that means the first two positions must be the month, the second two must be the day, and the next four must be the year). It’s OK for the leading zero to be absent, the `ToString('00000000')` ensures it’s present when needed.\n\n>The upper-case M‘s in the ‘MMddyyyy’ aren’t as arbitrary as they first seem. .NET date formatting is quite rigorous and also applies to times as well as dates. Upper-case ‘MM’ means two-digit months while lower-case ‘mm’ means two-digit minutes. To help keep this straight think of months being larger than minutes, and the upper-case M being larger than the lower-case m. You’ll see .NET’s date formatting strings in a different and powerful context later in this article.\n\nIf the numeric date has a value that can’t be converted to a date with the format provided, `DateParse` raises a `System.FormatException` error. This includes zero values–which some shops use to indicate a date hasn’t yet been specified in their application (ie, if a product has not yet shipped it might have a zero numeric date). To help a little with these issues, the `ConvertNumericDateToDate` shown in Figure 2 below buttons things up a little.\n\n```\nBegFunc ConvertNumericDateToDate Type(*Date) Access(*Public)\n     DclSrParm NumericDate Type(*Zoned) Len(8,0)\n    DclSrParm DateFormat Type(*String) \n\n    DclFld NewDate Type(*Date) \n    DclFld provider Type(CultureInfo) \n\n    If NumericDate = 0 \n        LeaveSr NewDate\n    EndIf \n\n    provider = CultureInfo.InvariantCulture\n\n    Try \n        NewDate = DateTime.ParseExact(NumericDate.ToString('00000000'), DateFormat, provider)\n    Catch e Type(Exception) \n        // Eat the exception.         \n    EndTry \n\n    LeaveSr NewDate            \nEndFunc\n```\n<small class=\"html-md-figure-caption\">Figure 2. ConvertNumericDateToDate function</small>\n\nThis function returns the default date value, `01-01-0001`, if a zero date value is passed to it or if a conversion exception occurs. This may not be the behavior your app needs when a conversion exception occurs; if that’s the case, change the `ConvertNumericDateToDate` as needed.\n\nRemember, too, to change any logic you have assuming that a zero date numeric value indicates a no- date-available condition to look for the date value `01-01-0001`. It’s easy to check for this `System.DateTime` includes a `MinValue` property for exactly this purpose. For example, assume your converted numeric date is in a date data type field named `ShippedDate`:\n\n```\nIf ShippedDate = DateTime.MinValue \n    // ShippedDate hasn't yet been set.\n    // Do something meaningful.\nEndIf\nWith ConvertNumericDateToDate() available, it’s easy to convert various numeric formats. For example,\n\nDclFld NewDate Type(*Date)\n\n// Convert numeric value in the format MMddyyyy  \nNewDate = ConvertNumericDateToDate(06021959,'MMddyyy')\n\n// Convert numeric value in the format yyyyMMdd\nNewDate = ConvertNumericDateToDate(19590602,'yyyyMMdd')\n```\n\n## Formatting the date data type\n\nThe .NET Framework's ability to formatting a `System.DateTime` is quite comprehensive. Let’s start by first getting a date data type:\n\n```\nDclFld NewDate Type(*Date)\n\n// Convert numeric value in the format MMddyyyy  \nNewDate = ConvertNumericDateToDate(06021959,'MMddyyy')\n```\n\nWith this date data type available (which remember under the covers is an instance of `System.DataTime`) you can use built-in shorthand formatting methods to produce formatted data strings:\n\n```\nNewDate.ToShortDateString() returns 6-2-1959\nNewDate.ToLongDateString() returns Tuesday, June 2, 1959\n```\n\nor you can use custom date formatting strings to produce custom formatted strings. Some examples include:\n\n```\nNewDate.ToString('MM/dd/yyyy') returns '06/02/1959'\nNewDate.ToString('M/d/yyyy') returns '6-2-1959'\nNewDate.ToString('yyyy-MM-dd') returns '1959-06-02'\nNewDate.ToString('yyyy-MMM-dd') returns '1959-Mar-02'\nNewDate.ToString('dddd, MMMM, d, yyyy') returns 'Tuesday, June 2, 1959'\n```\n\nMake a special note of this formatting possibility:\n\n```\nNewDate.ToString('MMddyyyy') returns '06021959'\n```\n\nWe’ll cover in a moment what it is especially good for. Can you guess?\n\nAs you can see, once you have a numeric value converted to a date data type, you can literally format it anyway you want to. Study the custom date formatting options available. There is lots you can do there–and there are similar formatting strings for times as well.\n\n## Using System.DataTime methods\n\nBeyond formatting possibilities, the `System.DataTime` also offers a plethora of methods and properties.\n\n* DayOfWeek\n* DayOfYear\n* AddMinutes()\n* AddMonths()\n* DaysInMonth()\n* IsLeapYear()\n \nIn short, you can do quite nearly anything you want to do to a date or time value when that value is available as a `System.DataTime` object. Frustratingly, though, getting the ISO 8601 week number of given date is disappointingly absent from .NET’s `System.DateTime`. This is perhaps the most significant shortcoming of `System.DateTime`. The ISO 8601 week number, and many other more esoteric features, are available in the free Noda Time open source library. If you have advanced date and time needs, check it out.\n\n## Convert a date data type back to numeric\n\nHaving converted your numeric date (and time) fields into date data type fields to work with them, you’ll need a way to convert that underlying `System.DateTime` value back to numeric for database updates. This is very easy to do with the function shown below in Figure 3:\n\n```\nBegFunc ConvertDateToNumericDate Type(*Integer4) Access(*Public) \n    DclSrParm DateField Type(System.DateTime) \n    DclSrParm DateFormat Type(*String) \n\n    LeaveSr DateField.ToString(DateFormat) \nEndFunc\n```\n<small class=\"html-md-figure-caption\">Figure 3. ConvertDateToNumericDate function</small>\n\nYou can use any valid `System.DateTime` formatting string as the DateFormat value. As you can see, there isn’t much to this function and you can also use the `ToString()` directly inline in your code. Either way, there is an interesting AVR for .NET idiom at play here. Consider the following code:\n\n```\nDclFld NumericDate Type(*Zoned) Len(8,0)\nDclFld ConvertedDate Type(*Date)\n\nNumericDate = 06021959\n\nConvertedDate = ConvertNumericDateToDate(NumericDate, 'MMddyyyy')\n\n// Do whatever you need to ConvertedDate here. \n\n// Update NumericDate so that its value reflects the ConvertedDate value.\n\nNumericDate = ConvertedDate.ToString('MMddyyyy')\n// Now NumericDate can be written back to your database.\n```\n\nThe last line is where something unusual to .NET occurs. .NET is usually very type-specific. Generally, if you try to assign one type to a different type, you get an error. Here, though, AVR for .NET successfully assigns a string (the result of the `ToString()` operation) directly to a numeric field (which could be any of Zoned, Packed, or *Integer4). In VB.NET and C#, assigning a string to a numeric won’t even compile; you’re told the compiler can’t implicitly convert type `string` to `int.`\n\nWhy doesn’t AVR for .NET throw an error with this assignment? Unlike AVR for .NET will, when it can, implicitly coerce a source data type into its target data type (effectively adopting the behavior of RPG’s MOVE operation code). AVR’s implicit type coercion really bugs some C# coders. They will often write this:\n\n```\nNumericDate = ConvertedDate.ToString('MMddyyyy')\n```\n\nas\n\n```\nNumericDate = Convert.ToInt32(ConvertedDate.ToString('MMddyyyy'))\n```\n\nThat explicit conversion of a string to an numeric works just fine–it just isn’t necessary with AVR.\n\n## Summary\n\nIt’s easy, and quite useful, to convert numeric date values into true date data types in your AVR for .NET applications. And, it’s easy to convert those date data types back to numeric values if you need to. Don’t blindly stop at using custom numeric formatting to display your numeric dates. Push yourself a little with the techniques in this article. They will help directly as you work with dates and the general .NET Framework concepts applied will help round out your general .NET knowledge."
        }
    },
    {
        "dirent": {
            "name": "windows-native-pdf-driver.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Windows native PDF drivers ease Web printing pain",
                "description": "This article shows how to use Windows' native PDF print driver as an alternative to commercial PDF drivers with ASP.NET Web apps.",
                "tags": [
                    "ibm-i"
                ],
                "date_published": "2017-11-15T00:00:00.000Z",
                "date_updated": "2017-11-15T00:00:00.000Z",
                "date_created": "2017-11-15T00:00:00.000Z",
                "pinned": false
            },
            "content": "\n<script>\nimport Image from \"$components/text-decorators/Image.svelte\";\nimport Callout from \"$components/text-decorators/Callout.svelte\"\n\nimport { page } from '$app/stores';\n\nconst locale = ($page.url.pathname.startsWith('/downloads')) ? \n     $page.pathname.url.slice(-2) : \n     $page.url.pathname.slice(1,3);\n\n</script>\n\n\n[Download](https://github.com/ASNA/PrintFromWebWithMSPDFDriver/archive/master.zip)\n\n[View Source](https://github.com/ASNA/PrintFromWebWithMSPDFDriver)\n\nPrinting to PDF with AVR Web apps has always been a royal hassle. Doing so required expensive, and challenging to configure, third-party print drivers; low-end print drivers don't work either because they are single-threaded or require registry access to assign a PDF file name at runtime. In the early days of Windows, registry access for such ad hoc tasks was easy but in these security-conscious times it's not an acceptable best practice (if, given your security policies, it can even be done at all).\n\nBack in AVR's early days this issue was usually solved with the [Active PDF Server](https://apryse.com/brands/activepdf). As Active PDF licensing because less flexible (ie, more expensive!), some customers turned to the more competively-priced [Amyuni PDF converter](https://www.amyuni.com/en/desktop-editions/amyuni-pdf-converter/learn-more).\n\nSeveral years ago Microsoft has finally come to the rescue by adding native PDF print drives to both Windows 10 and Windows Server 2016. The driver is also present in Windows 11 and the latest Windows Server products. This intrinsic Windows print driver eliminates the need for third-party drivers such as those available from ActivePDF and Amyuni commercial drivers.\n\n<Callout\n    icon=\"fa-sharp fa-solid fa-circle-exclamation\"\n    font_size=\"1.2rem\"\n    font_style=\"italic\"\n>\n    See this article <a href=\"https://www.asna.com/{locale}/kb/print-to-pdf-windows\">for using the Microsoft PDF driver</a> with a Windows application. This article also discusses how to enable the Microsoft PDF driver.\n</Callout>\n\n\n### On with the code\n\nThe class below in Figure 1a provides an example class to print a report to either a PDF file or a printer. If you compare this code to [other code we've provided to print with PDF](/en/kb/print-to-pdf?pdf), you'll appreciate how little friction is encountered printing to PDF with the Microsoft PDF driver.\n\nDepending on how the `CustomerReport` class is instanced, printer output is directed to either a printer or a PDF file. Printing to a printer is usually not a good idea in a Web app. The printing would occur on a printer on the network, which is probably not where the user is--that's the appeal of printing to PDF. It allows the user to print the PDF local or save it for later use. The class allows printing to a printer primarily to show how a single class can easily do double, but related, duty.\n\nSee the embedded comments for details on this class. The code is pretty simple but if the regular expressions in the `CheckFileAndPathSeparators` subroutine causes your eyebrows to furrow, take at look [this article on regular expressions](/en/kb/regex-part1?regex).\n\nFigure 1a. An example class to print simple report with AVR to PDF for a Web app.\n\n```\nUsing System\nUsing System.Text.RegularExpressions\nUsing System.IO \n\n/*\n    | This class shows how to print to Microsoft's native PDF\n    | print driver (which produces a PDF file) or to a real printer.\n    |\n    | When printing to the MS native PDF driver, the printer name\n    | must be:\n    |      \"Microsoft Print to PDF\"\n    |\n    | Use MS Word to save a sample document with this driver to ensure\n    | it is available. It should be present for Windows 10 or Windows \n    | Server 2016. It is not present, not is it available, for previous\n    | Windows or Windows Server versions.\n    */\n\nBegClass CustomerReport Access(*Public)\n\n    DclDB Name(pgmDB) DBName(\"*Public/DG NET Local\")\n\n    DclDiskFile Cust +\n        Type(*Input) +\n        Org(*Indexed) +\n        Prefix(Cust_) +\n        File(\"Examples/CMastNewL2\") +\n        DB(pgmDB) +\n        ImpOpen(*No) \n\n    DclPrintFile MyPrint +\n        DB (pgmDB) + \n        File (\"Examples/CustList\") + \n        ImpOpen (*No) \n    \n    DclProp DocumentName Type (*String) \n    DclProp IsPdf Type (*Boolean) \n    DclProp OutputDirectory Type (*String) \n    DclProp OutputFileFullName Type(*String) Access(*Public) \n    DclProp PrinterName Type (*String) \n    DclProp VirtualPathToPdf Type(*String) Access(*Public) \n\n    BegSr OpenData Access (*Private) \n        Connect PgmDB\n        Open Cust\n\n        MyPrint.Printer = *This.PrinterName\n        If (IsPdf) \n            MyPrint.PrintToFileName = *This.OutputFileFullName\n        EndIf             \n        Open MyPrint\n    EndSr\n\n    BegSr CloseData Access (*Private) \n        Close Cust\n        Close MyPrint\n        Disconnect PgmDB\n    EndSr\n\n    BegSr Print Access(*Public) \n        OpenData()\n        WriteReportFormats()\n        CloseData()\n        // If printing to PDF, pause just a bit\n        // to ensure the PDF file is closed before\n        // returning.\n        If (*This.IsPdf) \n            Sleep(5000)\n        EndIf \n    EndSr\n\n    BegSr WriteReportformats Access (*Private) \n        DclFld StartingfooterSize Type (*Integer4) \n        DclFld NeedHeader Type (*Boolean) \n\n        // There are 254 print units in an inch. \n        DclConst ONE_INCH Value(254)\n\n        StartingfooterSize = MyPrint.FooterSize\n        NeedHeader = *True\n\n        DclFld Counter Type(*Integer4) \n\n        Read Cust\n        DoWhile (NOT Cust.IsEof)\n            Counter += 1\n            CustomerName = Cust_CMName\n\n            If (NeedHeader) \n                Write Heading\n                NeedHeader = *False\n            EndIf\n\n            Write Detail\n            \n            // This results in a 1.25 inch footer. \n            If (MyPrint.FooterSize <= ONE_INCH * 1.25)\n                Write Footer\n                NeedHeader = *True\n                StartingFooterSize = MyPrint.FooterSize\n            Endif \n\n            // An arbitrary value to limit pages printed\n            // for testing.\n            If Counter = 75 \n                Leave \n            EndIf\n\n            Read Cust\n        EndDo\n\n        If (StartingfooterSize <> MyPrint.FooterSize) \n            Write Footer\n        EndIf\n    EndSr\n\n    BegConstructor Access(*Public) \n        //\n        // Constructor for printing to printer.\n        //\n        DclSrParm PrinterName Type(*String) \n\n        *This.PrinterName =\tPrinterName\n        *This.IsPdf = *False\n    EndConstructor\n\n    BegConstructor Access(*Public) \n        //\n        // Constructor for printing to PDF.\n        //\n        DclSrParm WebRoot Type(*String) \n        DclSrParm OutputDirectory Type(*String) \n        DclSrParm DocumentName Type(*String)\n        DclSrParm PrinterName Type(*String)\n        \n        DclConst ERROR_MESSAGE Value('There isn''t a [{0}] directory in the app root.') \n\n        *This.PrinterName = PrinterName\n        \n        CheckFileAndPathSeparators(OutputDirectory, DocumentName)\n\n        // Throw exception if output directory provided doesn't exist.             \n        If NOT Directory.Exists(WebRoot + *This.OutputDirectory )\n            Throw *New System.ArgumentException(String.Format(ERROR_MESSAGE, +\n                                                *This.OutputDirectory))\n        EndIf\n\n        // Create PDF file name. \n        *This.OutputFileFullName = String.Format('{0}{1}\\{2}', +              \n                                        WebRoot, +\n                                        *This.OutputDirectory, +\n                                        *This.DocumentName)\n        \n        // Create relative output file name for response.redirect.\n        *This.VirtualPathToPdf = String.Format('/{0}/{1}', + \n                                        *This.OutputDirectory, +\n                                        *This.DocumentName)\n        *This.IsPdf = *True\n    EndConstructor\n\n    BegSr CheckFileAndPathSeparators\n        DclSrParm OutputDirectory Type(*String) \n        DclSrParm DocumentName Type(*String) \n\n        DclConst BACK_SLASH Value('\\') \n        DclConst FORWARD_SLASH Value('/')\n        DclConst LEADING_BACK_SLASH Value('^\\\\')\n        DclConst TRAILING_BACK_SLASH Value('\\\\$')\n\n        // Don't assume the slashes or backslashes provided \n        // are correct! \n        // Remove leading backslash if present.\n        *This.OutputDirectory = RegEx.Replace(OutputDirectory, + \n                                    LEADING_BACK_SLASH, String.Empty)\n        // Remove trailing backslash if present.\n        *This.OutputDirectory = RegEx.Replace(OutputDirectory, + \n                                    TRAILING_BACK_SLASH, String.Empty) \n        // Swap / slashes for \\ slashes if present.\n        *This.OutputDirectory = RegEx.Replace(OutputDirectory, + \n                                    FORWARD_SLASH, BACK_SLASH)\n        // Remove leading backslash if present.\n        *This.DocumentName = RegEx.Replace(DocumentName, +\n                                LEADING_BACK_SLASH, String.Empty)\n        // Remove trailing backslash if present.\n        *This.DocumentName = RegEx.Replace(DocumentName, +\n                                TRAILING_BACK_SLASH, String.Empty)\n    EndSr\n    \nEndClass\n```    \n\nFigure 1a. An example class to print a report with AVR\n\nIts code-behind is shown below in Figure 1b.\n\n```\nBegClass PrintFromWeb Partial(*Yes) Access(*Public) Extends(System.Web.UI.Page)\n    //\n    // Print to PDF.\n    //\n    BegSr Button1_Click Access(*Private) Event(*This.Button1.Click)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        DclFld report Type(CustomerReport) \n\n        DclFld WebRoot Type(*String) \n        DclFld PDFFolder Type(*String) \n        DclFld PDFFileName Type(*String) \n        DclFld PrinterName Type(*String) \n\n        /*\n            | When printing to the MS native PDF driver, the printer name\n            | must be:\n            |      \"Microsoft Print to PDF\"\n            | Use MS Word to save a sample document with this driver to ensure\n            | it is available. It should be present for Windows 10 or Windows \n            | Server 2016. It is not present, not is it available, for previous\n            | Windows or Windows Server versions.\n            */\n        DclConst MS_PDF_DRIVER Value('Microsoft Print to PDF')\n\n        WebRoot = Server.MapPath('\\')\n        // The PDFFolder is relative to the root.\n        PDFFolder = 'pdf/files'\n        PDFFileName = textboxPDFFileName.Text.Trim()\n        PrinterName =  MS_PDF_DRIVER\n        report = *New CustomerReport(WebRoot, PDFFolder, PDFFileName, PrinterName) \n        report.Print()                         \n\n        Response.Redirect(report.VirtualPathToPDF)\t\t\n    EndSr\t\n\n    //\n    // Print to printer.\n    //\n    BegSr Button2_Click Access(*Private) Event(*This.Button2.Click)\n        DclSrParm sender Type(*Object)\n        DclSrParm e Type(System.EventArgs)\n\n        DclFld report Type(CustomerReport) \n        DclFld PrinterName Type(*String) \n\n        PrinterName = textboxPrinterName.Text.Trim() \n        report = *New CustomerReport(PrinterName)\n        \n        report.Print()                                \t\t\n    EndSr\nEndClass\n```    \n\nFigure 1b. AVR code-behind using Figure 1a's class.\n"
        }
    },
    {
        "dirent": {
            "name": "use-sql-to-find-asp-net-orphan-jobs.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Using SQL to help identify ASP.NET orphan IBM i jobs",
                "description": "This article provides a potential way to identify orphan IBM i jobs as a result of Database connection leaks in ASP.NET Web applications.",
                "tags": [
                    "asp-net",
                    "visual-rpg"
                ],
                "date_published": "2024-01-09T13:28:43.000Z",
                "date_updated": "2024-01-09T20:19:23.000Z",
                "date_created": "2024-01-09T20:19:23.000Z",
                "pinned": false
            },
            "content": "\nThis article provides a potential way to identify orphan IBM i jobs as a result of Database connection leaks in ASP.NET Web applications. We’ve written before about the perils of orphan IBM i jobs before. [This article](/en/kb/singleton-db-pattern) also discusses techniques for avoiding orphan jobs. [This article](/en/kb/use-sql-to-find-asp-net-orphan-jobs) provides some diagnostic help locating the cause of orphan jobs.\n\nOrphan jobs are challenging to identify. In a large system with many users, it’s possible that you have some orphan jobs and don’t know it–and don’t care. However, it’s also possible that the occasional orphan job could cause intermittent, hard-to-find problems.\n\n## The short story\n\nIf you are familiar with the challenge of finding ASP.NET job leaks that result in orphan jobs, scroll down to the \"SQL to the rescue\" subheading. Otherwise, put your tray tables in their upright and locked positions, fasten your seat belt, and lean in.\n\n## The long story\n\nSimon Hutchinson is an exceedingly clever RPG/SQL programmer and writes a great [RPG-related blog at RPGPGM.com](https://www.rpgpgm.com). One of Simon’s many specialties is SQL on the IBM i. While reading some of his work the other day I learned that SQL on the IBM i may help find orphan DataGate jobs on the IBM i.\n\nBefore we get to that SQL, let’s review a few points first.\n\n*   You should understand DataGate connection pooling before continuing. If you need a connection pooling refresher course, [read this article](/en/kb/datagate-connection-pooling) before continuing with this article.\n    \n*   IBM i end-user jobs are always named DG8\\_NET. Anytime you see an IBM i job named \"DG8\\_NET\" you can be sure it’s an end-user job.\n    \n*   Assuming you’re using DataGate connection pooling correctly with your AVR for .NET ASP.NET Web application, you shouldn’t ever see very many DG8\\_NET jobs associated with your Web app. Connection pooling lets a single IBM i job service _many_ users. The word \"many\" is this paragraph is a little nebulous because several conditions contribute to the scale of \"many.\"Depending on how hard users are pounding on the Web app, it wouldn’t be surprising to see five IBM i jobs easily service 25-50 Web users on the low end, and maybe as many as 100 or more users.\n    \n*   You should _never_ see more active IBM i jobs than you have Web users on a production box. If you do, you can almost be sure your app is leaving behind orphan jobs.\n    \n*   Let’s consider a Web site with four users that’s used lightly for simple queries. It’s a little silly, but let’s assume that these four users never use the site concurrently. Under this scenario, and assuming all four users are using the same database name with the same user ID and password, there should only be one IBM i job running for these four users–and for any one request, that job is usually only running a couple of seconds, at most, to fulfill a user’s request. The usual life of an active DG job for a Web app is very, very short (often measured in milliseconds, not seconds). A request can last many seconds (minutes?) if the back end is doing highly intensive IO work, but that should happen only in very rare cases.\n    \n*   Another way to prove that your app isn’t causing orphan jobs is to stop every user from using your app and get your IBM i to a stage where there are no DG8\\_NET jobs showing, you should be able to use every part of the app with only one IBM i job present on the IBM i. Anything more than a single IBM i job indicates a job leak. Beware, though, that if even one user sneaks in on your test, the results are worthless. For the best testing, consider using a dedicated DataGate Database Name with a unique testing user id. \n    \n*   When you do WRKACTJOB to look at your DG8\\_NET jobs, the jobs you see are almost always sitting dormant, waiting patiently for the chance to wake up and serve up a new response for a user. Note that to the IBM i, these dormant DataGate jobs are indeed active jobs, but they consuming zero CPU cycles and, if you closed files before the code-behind goes out of scope, don’t have any open files.\n    \n*   WRKACTJOB shows all DG8\\_NET jobs, both dormant and active. Through the WRKACJOB lens, you can’t tell by looking if a DataGate jobs for Web apps are busy doing work or sitting dormant awaiting work. You could look for those jobs with more that zero CPU usage, but since the active job duration is so short, it’s very hard to capture an active DataGate job to investigate it.\n\n#### SQL to the rescue\n\nGiven all that, the challenge to finding potentially orphan jobs is to be able to capture DG8\\_NET jobs that are active _with_ open files. This is nearly impossible to do with WRKACTJOB. This is where [one of Simon’s SQL tricks](https://www.rpgpgm.com/2015/11/getting-active-jobs-data-using-sql.html) comes into play.\n\nWith your Web application active, and users pounding on it, open a 5250 emulator and enter the `STRSQL` command. Type in the SQL below and press enter:\n\n```\nSELECT JOB_NAME,OPEN_FILES,JOB_TYPE,JOB_STATUS, SUBSYSTEM\nFROM TABLE(ACTIVE_JOB_INFO(DETAILED_INFO => 'ALL'))         \nWHERE OPEN_FILES > 0 AND JOB_NAME_SHORT = 'DG8_NET'         \nORDER BY JOB_NAME\n```\n> This SQL includes only jobs that have opened files--assuming that a `Close *ALL` was used to close all files before a page goes out of scope. `Close *ALL` closes only files, it does not disconnect the DB connection. Change the the SQL to `OPEN_FILES = 0` to see active jobs with no open files (which could be argued is a better way to search for orphan jobs.)\n\nThis SQL lists all of IBM i jobs named DG8\\_NET that have opened files. The SQL takes about 10 seconds or so to run. When it’s done it shows DG8\\_NET jobs with open files:\n\n![SQL results showing jobs with open files](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/sql-open-files.png)\n\n>  [More info from IBM on ActiveJobInfo](https://www.ibm.com/docs/en/i/7.5?topic=services-active-job-info-table-function)\n\nThe body of the list is empty if there are no DG8\\_NET jobs with open files. If you do catch an open job with the SQL, run the SQL again to see if you happened onto a job that hasn’t yet closed its files. In the ten seconds or so it takes the SQL to show potentially offending jobs, if a job is shown more than once, it’s probably an orphan job.\n\n> The jobs listed aren’t necessarily ASP.NET-related jobs. If you have Visual RPG fat clients, those jobs will be shown, too.\n\nThe general rule is, if you’re using DataGate on the IBM i exclusively for ASP.NET Web apps, and the SQL above consistently shows the same job(s) in the list, you ASP.NET Web is probably leaking database connections and causing orphan jobs. If that’s the case, take note of the files opened as a clue as to where to start looking for the leak.\n\nA IBM i job that is active doing work for a Web app (between form load and form unload) is only active for just a few seconds—maybe even milliseconds–before it is returned to the job pool. If the app is coded correctly, (ie closing all files and disconnecting from the DB before any page goes out of scope)  it’s unlikely that running the SQL provided would ever show any jobs with open files. It could be that it will catch one occasionally at just the right time to show it; but if things are running as expected you won’t see very many and if you do they should do away quickly. However, if you run this SQL say once every 10 seconds, and if you continually see jobs with open files listed (and especially if this list is growing) there is a place in your Web app where it isn’t closing files and disconnecting from the DB before a page goes out of scope.\n\nRemember, too, that using DB connections in secondary classes in an AVR Web app is also likely culprit in creating orphan jobs with open files. [See this article for more information.](/en/kb/singleton-db-pattern)\n\n## Conclusion\n\nWhile this SQL may be helpful, it isn't definitive. It's just another tool to help you try to find orphan job leaks. "
        }
    },
    {
        "dirent": {
            "name": "windows-10-end-of-support.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Windows 10 support ends on October 14, 2025!",
                "description": "As of October 14, Microsoft will no longer provide free software updates, technical assistance, or security fixes for Windows 10. As of that date ASNA will also no longer support Windows 10 as a platform for its products.",
                "tags": [
                    "windows-10",
                    "microsoft"
                ],
                "date_published": "2025-09-26T00:00:00.000Z",
                "date_updated": "2025-09-26T00:00:00.000Z",
                "date_created": "2025-09-26T00:00:00.000Z",
                "pinned": false
            },
            "content": "<script>\nimport Callout from '$components/text-decorators/Callout.svelte'\n</script>\n\n\nAs of October 14, Microsoft will no longer provide free software updates, technical assistance, or security fixes for Windows 10. As of that date ASNA will also no longer support Windows 10 as a platform for its products.\n\n## Windows 10 end-of-support FAQ\n\nAn event as big as Windows 10 going to the big software house in the sky begs lots of questions. Let's ponder a few of them.\n\n\n### Why is ASNA discontinuing support for Windows 10?\n\nAfter October 14th, security updates are not available for Windows. Without those updates, we can't risk having Windows 10 on our networks. We've been very clear with our customers on our Windows 10 plans and first announced them in our 2025Q1 ASNA Newsletter.  \n\n### What does \"ASNA will no longer support Windows 10?\" mean? \n\nOur products will quite likely continue to run properly on Windows 10 for a long time. Windows 10 is categorized as not supported because we will no longer test new product builds on Windows nor will we be able to recreate technical support issues on Windows 10. \n\nWe haven't had a Windows version-specific issue with our products since back in the Windows XP/Windows Vista era. If you're a rogue and going to continue to use Windows 10 and need to report an issue to tech support, don't hesitate to do so. We'll do our best to recreate your issue on Windows 11. Should we find an issue, it's highly likely that the fix that works on Windows 11 will also work on Windows 10.  \n\n<Callout icon=\"fa-solid fa-circle-exclamation\">\nASNA no longer supports Windows 10 after October 14, 2025. However, if you experience a tech support issue with any of our products and Windows 10 (and if you have a current maintenance agreement), we will do our best to recreate your issue on Windows 11. If we find an issue, chances are the solution that works on Windows 11 will also work on Windows 10.\n</Callout>\n\n\n### Will my Windows 10 PC quit working on October 14th? \n\nNo, on October 15th your PC will boot and and continue to run everything it did the day before, including ASNA software. The difference is that after October 14th you'll be computing with a higher level of threat and risk than before. How much higher is up for debate&mdash; but the threat is definitely higher.\n\n### Is the Microsoft Extended Security Update program for consumers any help for me?\n\nMicrosoft recently announced, for the first time ever, an Extended Security Update program for consumers (ie, using Windows for non-business purposes). That program is $30 in the US and free in Europe. It is for one year and does indeed offer a some relief for consumers. [Details on Microsoft's Windows 10 ESU program](https://learn.microsoft.com/en-us/windows/whats-new/extended-security-updates). \n\nMicrosoft's Windows 10 ESU program is for consumers and doesn't affect ASNA discontinuing Windows 10 support on October 14th, 2025. \n\n### I'm a rogue and refuse to bow down to Microsoft and intend to use Windows 10 forever. Am I doomed? \n\nLet's be very clear: We think it's very important for our customers to upgrade to Windows 11 as soon as possible. While Windows 10 served us well, its time is up. \n\nHaving said that, while Microsoft is indeed pulling the plug on Windows 10, it promises to deliver Windows Defender (Windows 10's intrinsic antivirus/malware solution) updates through 2028. ([Search this page for \"defender\"](https://blogs.windows.com/windowsexperience/2024/10/31/how-to-prepare-for-windows-10-end-of-support-by-moving-to-windows-11-today/) and [see this page](https://learn.microsoft.com/en-us/microsoft-365-apps/end-of-support/windows-10-support)).\n\nA diligent Windows 10 rogue who is: \n\n* exceedingly mindful to ignore untrusted links\n* doesn't download untrusted downloads\n* careful about ignoring enticing emails from cousins of recently-deceased foreign gazillionaire overlords promising to bequeath you a fortune\n* open to risk and heartache\n\nis probably not doomed in the short-term staying on Windows 10. But sooner or later, the need to upgrade will strike. You might as well do it now. After all, do you know anyone still using Windows XP? \n\n## Helpful links\n\n * [Microsoft Windows 10 end-of-support announcement](https://www.microsoft.com/en-gb/windows/end-of-support?r=1#:~:text=After%2014%20October%202025%2C%20Microsoft,technical%20support%20for%20Windows%2010.)\n* [Windows 10 Extended Security Updates for consumer users](https://learn.microsoft.com/en-us/windows/whats-new/extended-security-updates)\n* [Windows 11 requirements](https://support.microsoft.com/en-us/windows/windows-11-system-requirements-86c11283-ea52-4782-9efd-7674389a7ba3)\n* [How to check Windows 11 compatibility](https://support.microsoft.com/en-us/windows/how-to-check-if-your-device-meets-windows-11-system-requirements-after-changing-device-hardware-f3bc0aeb-6884-41a1-ab57-88258df6812b)"
        }
    },
    {
        "dirent": {
            "name": "wings-mr-licensing.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Monitoring Wings and Mobile RPG end-user licensing",
                "description": "This article shows how to determine how many Wings/Mobile RPG licenses you currently have and how many licenses are currently active.",
                "tags": [
                    "licensing",
                    "mobile-rpg",
                    "wings"
                ],
                "date_published": "2023-12-28T22:09:39.000Z",
                "date_updated": "2023-12-28T22:09:39.000Z",
                "date_created": "2023-12-28T22:09:39.000Z",
                "pinned": false
            },
            "content": "\nASNA Wings and ASNA Mobile are licensed per end-user on your IBM i server. Your license can be either an unlimited site license or licensed to a specific number of users (sold in blocks of 5, 10, 15, 20, 50, 100, 200 users, etc). This article is primarily for those customers licensed with a fixed number of users. It shows how to determine how many licenses you currently have and how many licenses are currently active.\n\nTo see your Wings or Mobile RPG license information, use the           `\n               DSPRRR\n          `           (Display Registrar) command. This command is in your DataGate library. For example, if you're using the default DataGate library for DataGate 16.x on the IBM i, use:\n\n```\nDG8_160/DSPRRR\n```\nThis displays the initial DSPRRR screen as shown below in Figure 1a.\n\n![downloads/images/DSPRRR-01.png](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/DSPRRR-01.png)\n\nFigure 1a. DSPRRR's initial screen.\n\nThere are four license types you can check:\n\n- WINGS (\\*WINGS) - for Wings only\n\n- Mobile RPG (\\*MOBILERPG) - for Mobile RPG\n\n- Wings Extended (\\*WINGSEXT) - for Wings and Mobile RPG\n\n- BTerm (\\*BTERM) - for Browser Terminal\n\nAfter selecting a license type, press enter to see your current license status (this screen shows Wings licenses) as shown below in Figure 1b.\n\n![downloads/images/DSPRRR-01.png](https://nyc3.digitaloceanspaces.com/asna-assets/asna-com/kb/DSPRRR-02.png)\n\nFigure 1b. Wings licensing info.\n\nThe output includes a header with the product name, the seat count with the applied license, the currently used seats and the total number of jobs. For each seat, the corresponding jobs are listed with the following information per job listed:\n\n- Job Id (Job name/User/Number)\n- Timestamp when license was granted\n- Handler license version\n- Web Server information\n\n    - Server computer name\n    - Application path\n    - ASP.NET Session ID\n- User browser information\n\n    - Computer IP address\n    - Computer name (if known by IIS)\n    - User Agent string\n\n## Calculating user seats\n\n**Wings Seats**\n\nFor Wings users with either \\*WINGS or \\*WINGSEXT licenses, one or more Wings browser sessions from the same IBM i user from a single desktop browser type (ie, Chrome, Edge, or FF) counts as one Wings user license.\n\n**Mobile RPG Seats**\n\nFor Mobile RPG users with a \\*MOBILERPG license, each Mobile RPG browser session from the same mobile device (phone or table) from a single browser type (ie, Chrome, Edge, or FF) counts as one \\*MOBILERPG user license.\n\nFor Mobile RPG users with a \\*WINGSEXT license, multiple Mobile RPG browser sessions from the same mobile device (phone or table) from a single browser type (ie, ASNA Go, Chrome, Edge, or FF) counts as one \\*MOBILERPG user license.\n\n**Browser Terminal seats**\n\nBrowser Terminal user licenses are counted just like Wings seats.\n\n## Licensing note for developers\n\nWhile developing Wings or Mobile RPG applications, it's possible to leave an orphan IIS Express session dangling when you end a debugging session. For that reason, we recommend you end debugging sessions with Visual Studio's \"Terminate all\" command instead of ending the debugging session. Ending a debugging session with \"Terminate all\" ensures no dangling IIS sessions.           [See this article for more information on \"Terminate all.\"]\n\nIf you mysteriously run out of licenses during a Wings or Mobile RPG development session, using           `\n               DSPRRR\n          `           as described above can confirm you're leaving orphan jobs on the IBM i during debuggging."
        }
    },
    {
        "dirent": {
            "name": "upgrade-info-and-advice.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "ASNA product update info/advice",
                "description": "This article provides advice and considerations for planning an ASNA product update ",
                "tags": [
                    "licensing",
                    "upgrade"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T05:24:31.000Z",
                "date_created": "2024-01-10T05:24:31.000Z",
                "pinned": false
            },
            "content": "\n*   ASNA products are available for download from our [downloads page](/downloads/en). An account is no longer needed to download our products.\n*   _Always_ read the release notes before applying a new version of an ASNA product. Release notes are available next to the product on the download page. \n*   Before installing any updates, please make sure the target PC has had all updates installed (search for “Windows updates” in the Task bar’s search panel. Then click “check for updates.”). \n*   Our general version policy is to support the current version and one version back. We strongly recommend that you do not get more than one version back from the currently supported version. For example, with ASNA Visual RPG 17.x and ASNA Visual RPG 16.x being currently supported, using anything older than AVR 15.x is likely to make your upgrade path more challenging. The farther behind you get the more challenging the upgrade may be.   \n     \n*   ASNA Windows products upgrades, even if source code doesn’t need to be changed, should be done by someone on your staff familiar with both your application and our products. Our technical support team assumes that you have a domain expert who is able to troubleshoot and perform your upgrade. If you don’t have someone with those skills available, tech support may need to refer you to our services department for our hands-on help to perform your upgrade.\n*   Please remember that any third-party controls your application uses are beyond ASNA’s purview. As your application’s reliance on third-party controls increases, so does the likelihood that you’ll bump into issues upgrading your applications. This is especially true for AVR Classic applications.\n*   Our products are fully regression tested before being released for general availability. However, we strongly recommend you fully test any major version upgrade in a staging/test environment before deploying that upgrade to production. (Some of you may say, “I don’t have a staging/test environment!” To that we say, “Yes, yes you do. What you don’t have is a production environment.”)\n*   Please keep license costs in mind as you plan your upgrade. If your maintenance isn’t current, or for some version upgrades, license fees may be required. Contact your local ASNA sales rep if you have questions about your account or email us at info@asna.com.\n"
        }
    },
    {
        "dirent": {
            "name": "upgrade-asna-datagate-webpak.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "How to upgrade ASNA DataGate WebPak",
                "description": "ASNA DataGate WebPak is the DataGate client for ASP.NET Web apps. This article explains how to upgrade ASNA DataGate WebPak on Microsoft IIS Servers. ",
                "tags": [
                    "asp-net",
                    "datagate-ibm-i"
                ],
                "date_published": "2023-12-28T18:10:35.000Z",
                "date_updated": "2023-12-28T18:10:35.000Z",
                "date_created": "2023-12-28T18:10:35.000Z",
                "pinned": false
            },
            "content": "\nThe ASNA WebPak is the DataGate client for Windows Servers. It is to Windows servers what the Client Deployment binary is to Windows clients. The WebPak should be installed on any Web server on which you've deployed an AVR ASP.NET Website/Web services or Monarch migrations.\n\nInstalling WebPak is very simple; you just run the WebPak's executable to install it. Previously-created database names continue to work with a new WebPak install.\n\nA Web server does not need, nor does it use, multiple versions of WebPak. Windows policies ensures that the highest installed version is always used at runtime-and installing a newer WebPak deletes the previously installed version.\n\n## Be sure to install the correct WebPak version\n\nThe WebPak version must always the same, or lower, version than DataGate. However, a higher WebPak version doesn't work with a lower DataGate version. For example, WebPak 17 works with DataGate 17 and lower-but a WebPak 16 would not work with DataGate 17.\n\n## End DataGate IBM i end user jobs first\n\nProbably the hardest part about installing the WebPak is ensuring that no DataGate end-user jobs are active during the install. We strongly recommend that you ensure that all end-user jobs are ended before doing a WebPak install. DataGate IBM i end-user jobs are always named `DG8_NET`. [Read more here](/en/kb/understanding-end-user-jobs) about DataGate end user jobs. Do not end DG8\\_NET jobs manually-rather have your users bring there applications down normally. Because of DataGate connection pooling, ASP.NET-related IBM i jobs don't end until the duration of your ASP.NET application's Session Timeout value. For example, let's say your session timeout value is 20 minutes (the default). The last ASP.NET-related DG8\\_NET job ends 20 minutes after the last user ends their active app.\n\n> Some ASNA DataGate customers use both ASP.NET Web apps and fat Windows clients. Both of these application types create DG8\\_NET jobs. Make sure all  DG8\\_NET jobs are gone before continuing with the install.\n\nTo keep ASP.NET end-users from sneaking a job in on you after you thought all the DG8\\_NET jobs were ended, Consider using  [the technique discussed in this article](/en/kb/take-asp-net-offline)           to take your ASP.NET application offline while you're installing a new version of the WebPak.\n\nWhen WRKACTJOB shows no DG8\\_NET jobs, you're ready to install the WebPak.\n\n## Installing a WebPak upgrade\n\nSteps to install the WebPak:\n\n1. Ensure that no DG8\\_NET jobs are runnning.\n2. Download the WebPack from\n               [/en/support/downloads](/downloads/en/)\n3. Installing the new WebPak on your Windows server as an administrator. (Right-click the WebPak executable you downloaded and click \"Run as Administrator\".)\n4. Test your application with the fresh WebPak."
        }
    },
    {
        "dirent": {
            "name": "visual-studio-terminate-all.en.md",
            "path": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb",
            "parentPath": "C:\\Users\\thumb\\Documents\\projects\\svelte\\mdsvex\\src\\lib\\markdown\\kb"
        },
        "markdownObject": {
            "frontMatter": {
                "title": "Customize Visual Studio to end all processes when debug ends",
                "description": "How to customize Visual Studio to end all processes when debug ends.",
                "tags": [
                    "visual-studio"
                ],
                "date_published": "2024-01-09T20:59:40.000Z",
                "date_updated": "2024-01-10T03:54:37.000Z",
                "date_created": "2024-01-10T03:54:37.000Z",
                "pinned": false
            },
            "content": "\nVisual Studio’s default ending of a debug session is to leave all associated processes running. But, in most cases, it’s better to also end those associated processes when you end debugging. This is especially true with ASNA Wings and Mobile RPG, but even a traditional ASP.NET app can get tripped up by a dangling IIS Express process.\n\nThe good news is that this is an easy problem to resolve–using the Debug menu’s Terminate All not only ends Visual Studio’s debugging session but it also ends all associated processes. Once I learned about Terminate All, I never looked back. I always use it to end a debugging session.\n\n![ALT NEEDED](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/devenv_ls77Sjw7DT_70.webp)\n\nQuick access to \"Terminal All\" isn’t directly available from Visual Studio’s debug tool bar at the top of Visual Studio. However but this GIF shows how to to add \"Terminate All\" to your debugging toolbar. \n\n![ALT NEEDED](https://nyc3.digitaloceanspaces.com/asna-assets/images/articles/terminate-all.gif)\n"
        }
    }
]