---
title: Send a calendar event ICS file from a SvelteKit
description: Send a calendar event ICS file from a SvelteKit
date_created: '2025-06-02T00:00:00.000Z'
date_updated: '2025-11-03T00:00:00.000Z'
date_published: null
pinned: false
tags:
  - sveltekit
  - ics-file
---
## A SvelteKit endpoint from which to send an ICS file

Okay, let's create a SvelteKit `GET` API endpoint that generates an `.ics` file dynamically, similar to the PHP example.

**1. Create the API Route File**

In your SvelteKit project, create the following file structure if it doesn't exist:

```
src/
└── routes/
    └── api/
        └── generate-event/
            └── +server.js  // Or +server.ts if using TypeScript
```

**2. Implement the `+server.js` (or `+server.ts`)**

```javascript
// src/routes/api/generate-event/+server.js

// Helper function to format dates for ICS (YYYYMMDDTHHMMSSZ)
function formatICSDate(date) {
  // Ensure date is a Date object
  if (!(date instanceof Date)) {
    date = new Date(date);
  }
  // Convert to UTC and format
  // Pad single digits with leading zero
  const pad = (num) => (num < 10 ? '0' : '') + num;

  return (
    date.getUTCFullYear() +
    pad(date.getUTCMonth() + 1) + // Months are 0-indexed
    pad(date.getUTCDate()) +
    'T' +
    pad(date.getUTCHours()) +
    pad(date.getUTCMinutes()) +
    pad(date.getUTCSeconds()) +
    'Z'
  );
}

// Helper to escape text for ICS
function escapeICStext(text = '') {
  return text
    .replace(/\\/g, '\\\\') // Escape backslashes first
    .replace(/;/g, '\\;')
    .replace(/,/g, '\\,')
    .replace(/\n/g, '\\n');
}

/** @type {import('./$types').RequestHandler} */
export async function GET({ url }) {
  // --- Event Data ---
  // You would typically fetch this from a database or use query parameters
  // For this example, we'll use some defaults, but allow overrides via query params

  const query = url.searchParams;

  const eventName = query.get('eventName') || "My Awesome SvelteKit Event";
  const description = query.get('description') || "Details about the event generated by SvelteKit. \nIt will be fun!";
  const location = query.get('location') || "123 Svelte Lane, Webville";

  // Dates: Expect ISO string format (e.g., 2023-11-15T10:00:00Z) or parse them robustly
  // For simplicity, using Date.now() and adding an hour for the end time if not provided
  const startTimeParam = query.get('startTime');
  const endTimeParam = query.get('endTime');

  let startTime, endTime;

  if (startTimeParam) {
    startTime = new Date(startTimeParam);
  } else {
    startTime = new Date(); // Default to now
    startTime.setHours(startTime.getHours() + 1); // Start in an hour
    startTime.setMinutes(0);
    startTime.setSeconds(0);
    startTime.setMilliseconds(0);
  }

  if (endTimeParam) {
    endTime = new Date(endTimeParam);
  } else {
    endTime = new Date(startTime.getTime() + 60 * 60 * 1000); // Default to 1 hour duration
  }

  if (isNaN(startTime.getTime()) || isNaN(endTime.getTime())) {
    return new Response("Invalid date format provided in query parameters.", { status: 400 });
  }


  // --- ICS File Content ---
  const uid = `event-${Date.now()}-${Math.random().toString(36).substring(2, 15)}@yourdomain.com`;
  const dtstamp = formatICSDate(new Date()); // Timestamp of when the ICS was created
  const dtstart = formatICSDate(startTime);
  const dtend = formatICSDate(endTime);

  const icsContent = [
    'BEGIN:VCALENDAR',
    'VERSION:2.0',
    'PRODID:-//Your Company//Your SvelteKit App//EN',
    'BEGIN:VEVENT',
    `UID:${uid}`,
    `DTSTAMP:${dtstamp}`,
    `DTSTART:${dtstart}`,
    `DTEND:${dtend}`,
    `SUMMARY:${escapeICStext(eventName)}`,
    `DESCRIPTION:${escapeICStext(description)}`,
    `LOCATION:${escapeICStext(location)}`,
    // Optional: Organizer
    // 'ORGANIZER;CN="Your Name":MAILTO:your.email@example.com',
    // Optional: Alarm
    // 'BEGIN:VALARM',
    // 'TRIGGER:-PT15M', // 15 minutes before
    // 'ACTION:DISPLAY',
    // 'DESCRIPTION:Reminder',
    // 'END:VALARM',
    'END:VEVENT',
    'END:VCALENDAR',
  ].join('\r\n'); // Use CRLF line endings as per RFC 5545

  // --- Response ---
  return new Response(icsContent, {
    status: 200,
    headers: {
      'Content-Type': 'text/calendar; charset=utf-8',
      'Content-Disposition': `attachment; filename="event.ics"`,
    },
  });
}
```

**3. How to Use it in a Svelte Component (`.svelte` file)**

Let's say you have a page or component where you want to place the "Add to Calendar" link:

```svelte
<!-- src/routes/my-event-page/+page.svelte (or any other .svelte file) -->
<script>
  // You can make these dynamic based on your event data
  const eventDetails = {
    eventName: "Team Meeting",
    description: "Discuss project milestones. \nBring your notes!",
    location: "Conference Room B",
    // Use ISO 8601 format with 'Z' for UTC or include timezone offset
    startTime: "2023-12-01T14:00:00Z", // December 1st, 2023 at 2 PM UTC
    endTime: "2023-12-01T15:30:00Z"    // December 1st, 2023 at 3:30 PM UTC
  };

  let calendarLink = "/api/generate-event"; // Default link

  // Construct link with query parameters
  const params = new URLSearchParams();
  if (eventDetails.eventName) params.append('eventName', eventDetails.eventName);
  if (eventDetails.description) params.append('description', eventDetails.description);
  if (eventDetails.location) params.append('location', eventDetails.location);
  if (eventDetails.startTime) params.append('startTime', eventDetails.startTime);
  if (eventDetails.endTime) params.append('endTime', eventDetails.endTime);

  if (params.toString()) {
    calendarLink += `?${params.toString()}`;
  }

</script>

<h1>My Event</h1>
<p>Details about the event...</p>

<a href={calendarLink} download="event.ics">
  Add to Calendar (ICS)
</a>

<style>
  a {
    display: inline-block;
    padding: 10px 15px;
    background-color: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 5px;
  }
  a:hover {
    background-color: #0056b3;
  }
</style>
```

**Explanation:**

1.  **`+server.js`:**
    *   **`formatICSDate(date)`:** This helper function is crucial. It takes a JavaScript `Date` object and converts it into the `YYYYMMDDTHHMMSSZ` format required by ICS for UTC date-times.
    *   **`escapeICStext(text)`:** This helper escapes special characters (`\`, `;`, `,`, `\n`) in your text fields as per the iCalendar specification.
    *   **`GET({ url })`:** This is the SvelteKit API handler for GET requests.
        *   `url.searchParams`: We use this to potentially read event details passed as query parameters (e.g., `/api/generate-event?eventName=MyCustomEvent`).
        *   **Event Data:** The example provides default values but allows overrides from query parameters. In a real app, you'd likely fetch this from a database based on an event ID or other criteria.
        *   **Date Handling:** It attempts to parse `startTime` and `endTime` from query parameters. If not provided, it defaults `startTime` to one hour from now and `endTime` to one hour after `startTime`. **Crucially, ensure any dates you work with are correctly handled in terms of UTC conversion before passing to `formatICSDate`.** The example assumes input query params like `2023-12-01T14:00:00Z` are already in UTC.
        *   **`UID`:** A unique identifier for the event. Important for updates if you were to send updated ICS files.
        *   **`DTSTAMP`:** Timestamp of when the iCalendar object was created.
        *   **`icsContent`:** The string containing the iCalendar data. Note the `\r\n` line endings, which are standard.
        *   **`Response`:** A standard Web `Response` object is returned.
            *   `'Content-Type': 'text/calendar; charset=utf-8'` tells the browser it's a calendar file.
            *   `'Content-Disposition': 'attachment; filename="event.ics"'` suggests to the browser that the file should be downloaded with the name "event.ics".

2.  **Svelte Component (`.svelte` file):**
    *   An `<a>` tag links directly to your API endpoint (`/api/generate-event`).
    *   The `download="event.ics"` attribute on the `<a>` tag is an additional hint for browsers, though the `Content-Disposition` header from the server is more authoritative.
    *   The example shows how to dynamically build the `calendarLink` with query parameters to pass custom event details to your API endpoint.

**To Run:**

1.  Save the files.
2.  Run your SvelteKit development server: `npm run dev` (or `yarn dev`, `pnpm dev`).
3.  Navigate to the page where you placed the link (e.g., `/my-event-page`).
4.  Click the "Add to Calendar (ICS)" link. Your browser should download an `event.ics` file, which you can then import into your calendar application (Outlook, Google Calendar, Apple Calendar, etc.).

This SvelteKit API endpoint provides a clean and server-side way to generate calendar event files.








## ICS file generic info

You can't *directly* add an event to a user's native calendar (like Outlook Desktop, Apple Calendar app) with a simple HTML `<a>` tag without some intermediary step. The browser's security model prevents direct access to local applications like that.

However, you have a few excellent options:

1.  **Using .ics Files (Most Universal)**:
    *   This is the most common and widely supported method.
    *   You generate an `.ics` (iCalendar) file on your server or even client-side (though server-side is more robust for complex events).
    *   The `<a>` tag links to this `.ics` file. When clicked, the browser downloads it, and the user's operating system will typically offer to open it with their default calendar application.

    **HTML:**
    ```html
    <a href="path/to/your/event.ics" download="event.ics">Add to Calendar (ICS)</a>
    ```
    *   The `download` attribute is a good hint to the browser, but the server should also send the correct `Content-Type: text/calendar` and `Content-Disposition: attachment; filename="event.ics"` headers.

    **Example `event.ics` file content:**
    ```ics
    BEGIN:VCALENDAR
    VERSION:2.0
    PRODID:-//Your Company//Your Product//EN
    BEGIN:VEVENT
    UID:event-12345@yourdomain.com
    DTSTAMP:20231027T080000Z
    DTSTART:20231115T100000Z
    DTEND:20231115T110000Z
    SUMMARY:My Awesome Event
    DESCRIPTION:Details about the awesome event. \nIt will be fun!
    LOCATION:123 Main St, Anytown
    END:VEVENT
    END:VCALENDAR
    ```
    *   **`UID`**: Unique identifier for the event.
    *   **`DTSTAMP`**: Timestamp when the event object was created (UTC).
    *   **`DTSTART` / `DTEND`**: Start and end date/time of the event (UTC, format `YYYYMMDDTHHMMSSZ`).
    *   **`SUMMARY`**: Event title.
    *   **`DESCRIPTION`**: Event details (use `\n` for newlines).
    *   **`LOCATION`**: Event location.

    **Server-side generation (e.g., PHP):**
    ```php
    <?php
    // event-generator.php
    // Fetch event details from database or define them
    $eventName = "My Awesome Event";
    $startTime = new DateTime('2023-11-15 10:00:00', new DateTimeZone('UTC'));
    $endTime = new DateTime('2023-11-15 11:00:00', new DateTimeZone('UTC'));
    $description = "Details about the awesome event. \\nIt will be fun!";
    $location = "123 Main St, Anytown";
    $uid = "event-" . uniqid() . "@yourdomain.com";
    $dtstamp = gmdate('Ymd\THis\Z');

    header('Content-Type: text/calendar; charset=utf-8');
    header('Content-Disposition: attachment; filename="event.ics"');

    echo "BEGIN:VCALENDAR\n";
    echo "VERSION:2.0\n";
    echo "PRODID:-//Your Company//Your Product//EN\n";
    echo "BEGIN:VEVENT\n";
    echo "UID:" . $uid . "\n";
    echo "DTSTAMP:" . $dtstamp . "\n";
    echo "DTSTART:" . $startTime->format('Ymd\THis\Z') . "\n";
    echo "DTEND:" . $endTime->format('Ymd\THis\Z') . "\n";
    echo "SUMMARY:" . addcslashes($eventName, ",;") . "\n"; // Escape commas and semicolons
    echo "DESCRIPTION:" . addcslashes($description, ",;") . "\n";
    echo "LOCATION:" . addcslashes($location, ",;") . "\n";
    echo "END:VEVENT\n";
    echo "END:VCALENDAR\n";
    exit;
    ?>
    ```
    Your HTML link would then be: `<a href="event-generator.php">Add to Calendar (ICS)</a>`

2.  **Direct Links to Web-Based Calendars (Google, Outlook.com, Yahoo)**:
    *   These services provide URL parameters to pre-fill an event creation form.

    **a. Google Calendar:**
    ```html
    <a id="google-calendar-link" href="#" target="_blank">Add to Google Calendar</a>

    <script>
    function generateGoogleCalendarLink() {
        const title = encodeURIComponent("My Awesome Event");
        // Dates need to be in YYYYMMDDTHHMMSSZ format (UTC)
        // Or YYYYMMDD for all-day events
        const startDate = "20231115T100000Z"; // 2023-11-15 10:00:00 UTC
        const endDate = "20231115T110000Z";   // 2023-11-15 11:00:00 UTC
        const details = encodeURIComponent("Details about the awesome event.\nIt will be fun!");
        const location = encodeURIComponent("123 Main St, Anytown");

        const googleUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${startDate}/${endDate}&details=${details}&location=${location}`;
        document.getElementById('google-calendar-link').href = googleUrl;
    }
    generateGoogleCalendarLink(); // Call this when your event data is ready
    </script>
    ```

    **b. Outlook.com / Office 365 Calendar:**
    ```html
    <a id="outlook-calendar-link" href="#" target="_blank">Add to Outlook Calendar</a>

    <script>
    function generateOutlookCalendarLink() {
        const subject = encodeURIComponent("My Awesome Event");
        // Dates need to be ISO 8601 format: YYYY-MM-DDTHH:mm:ssZ (UTC)
        // Or YYYY-MM-DD for all-day events
        const startDateTime = "2023-11-15T10:00:00Z";
        const endDateTime = "2023-11-15T11:00:00Z";
        const body = encodeURIComponent("Details about the awesome event.\nIt will be fun!");
        const location = encodeURIComponent("123 Main St, Anytown");

        const outlookUrl = `https://outlook.live.com/calendar/0/deeplink/compose?path=/calendar/action/compose&rru=addevent&subject=${subject}&startdt=${startDateTime}&enddt=${endDateTime}&body=${body}&location=${location}`;
        // For Office 365, the base URL might be: https://outlook.office.com/calendar/0/deeplink/compose?...
        document.getElementById('outlook-calendar-link').href = outlookUrl;
    }
    generateOutlookCalendarLink();
    </script>
    ```

    **c. Yahoo Calendar:**
    ```html
    <a id="yahoo-calendar-link" href="#" target="_blank">Add to Yahoo Calendar</a>
    <script>
    function generateYahooCalendarLink() {
        const title = encodeURIComponent("My Awesome Event");
        // Dates are YYYYMMDDTHHMMSS (seems to assume user's local timezone if Z is not appended, UTC is safer)
        const startTime = "20231115T100000Z"; //  Best to provide UTC
        const endTime = "20231115T110000Z";
        const description = encodeURIComponent("Details about the awesome event.\nIt will be fun!");
        const eventLocation = encodeURIComponent("123 Main St, Anytown");

        // Yahoo's duration (dur) is also an option instead of et (endTime)
        // For one hour: 0100 (HHMM)
        // const duration = "0100";

        const yahooUrl = `http://calendar.yahoo.com/?v=60&view=d&type=20&title=${title}&st=${startTime}&et=${endTime}&desc=${description}&in_loc=${eventLocation}`;
        document.getElementById('yahoo-calendar-link').href = yahooUrl;
    }
    generateYahooCalendarLink();
    </script>
    ```

3.  **Using a JavaScript Library (Simplifies Things):**
    *   Libraries like `add-to-calendar-button` (a web component) can handle the generation of ICS files client-side or links for multiple services.

    **Example with `add-to-calendar-button`:**
    (See: https://add-to-calendar-button.com/)

    First, include the library:
    ```html
    <script src="https://cdn.jsdelivr.net/npm/add-to-calendar-button@2" async defer></script>
    ```

    Then, use the custom element:
    ```html
    <add-to-calendar-button
        name="My Awesome Event"
        description="Details about the awesome event. It will be fun!"
        startDate="2023-11-15"
        endDate="2023-11-15"
        startTime="10:00"
        endTime="11:00"
        timeZone="America/New_York" <!-- Or use UTC and specify accordingly -->
        location="123 Main St, Anytown"
        options="'Apple','Google','Outlook.com','Yahoo','iCal'"
        buttonStyle="round"
        lightMode="system"
    ></add-to-calendar-button>
    ```
    This component provides a dropdown with various calendar options.

**Key Considerations:**

*   **Time Zones:** This is CRITICAL. Always be explicit about time zones.
    *   For `.ics` files and Google Calendar links, `YYYYMMDDTHHMMSSZ` (Z indicates UTC) is the safest.
    *   For Outlook.com, ISO 8601 with timezone offset (e.g., `2023-11-15T10:00:00-05:00`) or UTC (`Z`) is best.
    *   If you provide local times, ensure the calendar service or ICS file correctly interprets them.
*   **URL Encoding:** All parameters in URLs (like event titles, descriptions) MUST be URL encoded (e.g., using `encodeURIComponent()` in JavaScript).
*   **User Experience:** It's good practice to offer multiple links (e.g., "Add to Google Calendar", "Add to Outlook", "Download ICS") or use a library that provides a dropdown.
*   **Dynamic Data:** You'll typically generate these links or ICS files dynamically based on event data from your database or application logic.

The **.ics file method (Option 1)** is the most universal, as it works with desktop and mobile calendar apps. The direct web calendar links (Option 2) are convenient for users who primarily use those web services. A JavaScript library (Option 3) can offer the best of both worlds with less manual effort.